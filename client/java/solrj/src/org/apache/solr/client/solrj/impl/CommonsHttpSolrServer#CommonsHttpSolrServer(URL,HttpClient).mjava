  private CommonsHttpSolrServer(URL baseURL, HttpClient client) {
    this._baseURL = baseURL.toExternalForm();
    if( this._baseURL.endsWith( "/" ) ) {
      this._baseURL = this._baseURL.substring( 0, this._baseURL.length()-1 );
    }

    _httpClient = (client == null) ? new HttpClient(new MultiThreadedHttpConnectionManager()) : client;

    if (client == null) {
      // set some better defaults if we created a new connection manager and client
      
      // increase the default connections
      this.setDefaultMaxConnectionsPerHost( 32 );  // 2
      this.setMaxTotalConnections( 128 ); // 20
    }

    // by default use the XML one
    _processor = new XMLResponseParser();

    // TODO -- expose these so that people can add things like 'u' & 'p'
    _invariantParams = new ModifiableSolrParams();
    _invariantParams.set( CommonParams.WT, _processor.getWriterType() );
    _invariantParams.set( CommonParams.VERSION, "2.2" );
  }

