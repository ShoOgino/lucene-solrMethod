  /** Merges all RAM-resident segments, then may merge segments. */
  private final void flushRamSegments() throws IOException {
    if (ramSegmentInfos.size() > 0) {
      if (mergeSegments(ramSegmentInfos, 0, ramSegmentInfos.size()) > 0) {
        maybeMergeSegments();
      }
    }
  }

