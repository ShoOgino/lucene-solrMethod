  /** Merges all RAM-resident segments, then may merge segments. */
  private final void flushRamSegments() throws IOException {
    if (ramSegmentInfos.size() > 0) {
      mergeSegments(ramSegmentInfos, 0, ramSegmentInfos.size());
      maybeMergeSegments(minMergeDocs);
    }
  }

