  protected final void maybeFlushRamSegments() throws IOException {
    if (timeToFlushRam()) {
      flushRamSegments();
    }
  }

