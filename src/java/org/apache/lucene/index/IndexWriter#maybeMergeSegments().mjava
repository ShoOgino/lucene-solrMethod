  /** Incremental segment merger.  */
  private final void maybeMergeSegments() throws IOException {
    /**
     *  do not bother checking the segment details to determine
     *  if we should merge, but instead honour the maxBufferedDocs(minMergeDocs)
     *  property to ensure we do not spend time checking for merge conditions
     *  
     */
    if(bufferedDocCount<minMergeDocs) {
        return;
    }
    long targetMergeDocs = minMergeDocs;
    while (targetMergeDocs <= maxMergeDocs) {
      // find segments smaller than current target size
      int minSegment = segmentInfos.size();
      int mergeDocs = 0;
      while (--minSegment >= 0) {
        SegmentInfo si = segmentInfos.info(minSegment);
        if (si.docCount >= targetMergeDocs)
          break;
        mergeDocs += si.docCount;
      }

      if (mergeDocs >= targetMergeDocs)		  // found a merge to do
        mergeSegments(minSegment+1);
      else
        break;

      targetMergeDocs *= mergeFactor;		  // increase target size
    }
  }

