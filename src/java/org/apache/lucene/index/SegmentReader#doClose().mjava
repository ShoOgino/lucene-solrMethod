  protected void doClose() throws IOException {
    termVectorsLocal.close();
    fieldsReaderLocal.close();
    
    if (deletedDocs != null) {
      deletedDocsRef.decRef();
      // null so if an app hangs on to us we still free most ram
      deletedDocs = null;
    }

    Iterator it = norms.values().iterator();
    while (it.hasNext()) {
      ((Norm) it.next()).decRef();
    }

    if (coreRef.decRef() == 0) {

      // close everything, nothing is shared anymore with other readers
      if (tis != null) {
        tis.close();
        // null so if an app hangs on to us we still free most ram
        tis = null;
      }
      
      if (freqStream != null)
        freqStream.close();
      if (proxStream != null)
        proxStream.close();
  
      if (termVectorsReaderOrig != null)
        termVectorsReaderOrig.close();
  
      if (fieldsReaderOrig != null)
        fieldsReaderOrig.close();
  
      if (cfsReader != null)
        cfsReader.close();
  
      if (storeCFSReader != null)
        storeCFSReader.close();
    }
  }

