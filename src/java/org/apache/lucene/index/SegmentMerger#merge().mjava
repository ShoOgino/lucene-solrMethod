  final int merge() throws IOException {
    int value;
    try {
      value = mergeFields();
      mergeTerms();
      mergeNorms();
    } finally {
      for (int i = 0; i < readers.size(); i++) {  // close readers
	IndexReader reader = (IndexReader)readers.elementAt(i);
	reader.close();
      }
    }
    
    if (useCompoundFile)
        createCompoundFile();

    return value;
  }

