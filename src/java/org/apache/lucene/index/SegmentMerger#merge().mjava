  final void merge() throws IOException {
    try {
      mergeFields();
      mergeTerms();
      mergeNorms();
      
    } finally {
      for (int i = 0; i < readers.size(); i++) {  // close readers
        SegmentReader reader = (SegmentReader)readers.elementAt(i);
        reader.close();
      }
    }
    
    if (useCompoundFile)
        createCompoundFile();
  }

