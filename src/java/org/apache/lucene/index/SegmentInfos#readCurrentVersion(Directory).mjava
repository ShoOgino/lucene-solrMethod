  /**
   * Current version number from segments file.
   */
  public static long readCurrentVersion(Directory directory)
    throws IOException {

    // We cannot be sure whether the segments file is in the old format or the new one.
    // Therefore we have to read the whole file and cannot simple seek to the version entry.

    SegmentInfos sis = new SegmentInfos();
    sis.read(directory);
    return sis.getVersion();
  }

