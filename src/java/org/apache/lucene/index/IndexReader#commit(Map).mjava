  /**
   * Commit changes resulting from delete, undeleteAll, or
   * setNorm operations
   *
   * If an exception is hit, then either no changes or all
   * changes will have been committed to the index
   * (transactional semantics).
   * @throws IOException if there is a low-level IO error
   */
  protected final synchronized void commit(Map commitUserData) throws IOException {
    if (hasChanges) {
      doCommit(commitUserData);
    }
    hasChanges = false;
  }

