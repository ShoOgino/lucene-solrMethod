  private final void writeNorms(Document doc, String segment)
       throws IOException {
    Enumeration fields  = doc.fields();
    while (fields.hasMoreElements()) {
      Field field = (Field)fields.nextElement();
      if (field.isIndexed()) {
	int fieldNumber = fieldInfos.fieldNumber(field.name());
	OutputStream norm = directory.createFile(segment + ".f" + fieldNumber);
	try {
	  norm.writeByte(Similarity.norm(fieldLengths[fieldNumber]));
	} finally {
	  norm.close();
	}
      }
    }
  }

