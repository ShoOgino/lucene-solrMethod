  /**
   * Setting to turn on usage of a compound file. When on, multiple files
   * for each segment are merged into a single file once the segment creation
   * is finished. This is done regardless of what directory is in use.
   * @see IndexWriter#setUseCompoundFile(boolean)
   * @throws IllegalStateException if the index is closed
   */
  public void setUseCompoundFile(boolean useCompoundFile) throws IOException {
    synchronized(directory) {
      assureOpen();
      createIndexWriter();
      indexWriter.setUseCompoundFile(useCompoundFile);
      this.useCompoundFile = useCompoundFile;
    }
  }

