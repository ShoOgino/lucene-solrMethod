  private synchronized void doWait() {
    // NOTE: the callers of this method should in theory
    // be able to do simply wait(), but, as a defense
    // against thread timing hazards where notifyAll()
    // falls to be called, we wait for at most 1 second
    // and then return so caller can check if wait
    // conditions are satisified:
    try {
      wait(1000);
    } catch (InterruptedException ie) {
      // In 3.0 we will change this to throw
      // InterruptedException instead
      Thread.currentThread().interrupt();
      throw new RuntimeException(ie);
    }
  }

