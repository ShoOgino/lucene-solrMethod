  /*
    Record that the files for these segments should be
    deleted, once the pending deletes are committed.
   */
  final void addPendingSegments(Vector segments) throws IOException {
    for (int i = 0; i < segments.size(); i++) {
      SegmentReader reader = (SegmentReader)segments.elementAt(i);
      if (reader.directory() == this.directory) {
        addPendingFiles(reader.files());
      }
    }
  }

