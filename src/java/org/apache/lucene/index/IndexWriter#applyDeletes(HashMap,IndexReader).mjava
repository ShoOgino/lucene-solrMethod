  // Apply buffered delete terms to this reader.
  private final int applyDeletes(HashMap deleteTerms, IndexReader reader)
      throws CorruptIndexException, IOException {
    Iterator iter = deleteTerms.entrySet().iterator();
    int delCount = 0;
    while (iter.hasNext()) {
      Entry entry = (Entry) iter.next();
      delCount += reader.deleteDocuments((Term) entry.getKey());
    }
    return delCount;
  }

