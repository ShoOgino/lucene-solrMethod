    /**
     * Creates a hit queue sorted by the given field.
     * @param reader  IndexReader to use.
     * @param integer_field  Field to sort by.
     * @param size    Number of hits to return - see {@link PriorityQueue#initialize(int) initialize}
     * @throws IOException  If the internal term enumerator fails.
     */
    public FieldSortedHitQueue (IndexReader reader, String integer_field, int size)
    throws IOException {

        int hash = reader.hashCode();
        if (hash != lastReaderHash) {
            lastReaderHash = hash;
            if (fieldCache != null) {
                fieldCache.clear();
            }
            fieldCache = new HashMap();
        }

        initialize (size);
        initializeSort (reader, integer_field);
    }

