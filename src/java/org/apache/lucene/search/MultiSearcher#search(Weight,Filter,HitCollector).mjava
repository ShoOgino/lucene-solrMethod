  // inherit javadoc
  public void search(Weight weight, Filter filter, final HitCollector results)
    throws IOException {
    for (int i = 0; i < searchables.length; i++) {

      final int start = starts[i];

      final MultiReaderHitCollector hc;
      if (results instanceof MultiReaderHitCollector) {
        // results can shift
        final MultiReaderHitCollector resultsMulti = (MultiReaderHitCollector) results;
        hc = new MultiReaderHitCollector() {
            public void collect(int doc, float score) {
              resultsMulti.collect(doc, score);
            }

            public void setNextReader(IndexReader reader, int docBase) throws IOException {
              resultsMulti.setNextReader(reader, start+docBase);
            }
          };
      } else {
        // We must shift the docIDs
        hc = new MultiReaderHitCollector() {
            private int docBase;
            public void collect(int doc, float score) {
              results.collect(doc + docBase + start, score);
            }

            public void setNextReader(IndexReader reader, int docBase) {
              this.docBase = docBase;
            }
          };
      }
      
      searchables[i].search(weight, filter, hc);
    }
  }

