  public Spans getSpans(final IndexReader reader) throws IOException {
    if (clauses.size() == 0)                      // optimize 0-clause case
      return new SpanOrQuery(getClauses()).getPayloadSpans(reader);

    if (clauses.size() == 1)                      // optimize 1-clause case
      return ((SpanQuery)clauses.get(0)).getPayloadSpans(reader);

    return inOrder
            ? (PayloadSpans) new NearSpansOrdered(this, reader, collectPayloads)
            : (PayloadSpans) new NearSpansUnordered(this, reader);
  }

