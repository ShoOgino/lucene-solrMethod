    public ConstantScorer(Similarity similarity, IndexReader reader, QueryWeight w) throws IOException {
      super(similarity);
      theScore = w.getValue();
      DocIdSet docIdSet = filter.getDocIdSet(reader);
      if (docIdSet == null) {
        docIdSetIterator = EmptyDocIdSetIterator.getInstance();
      } else {
        DocIdSetIterator iter = docIdSet.iterator();
        if (iter == null) {
          docIdSetIterator = EmptyDocIdSetIterator.getInstance();
        } else {
          docIdSetIterator = iter;
        }
      }
    }

