  private FSDirectory(File path, boolean create) throws IOException {
    directory = path;
    if (!directory.exists() && create)
      directory.mkdir();
    if (!directory.isDirectory())
      throw new IOException(path + " not a directory");

    if (create) {				  // clear old files
      String[] files = directory.list();
      for (int i = 0; i < files.length; i++) {
	File file = new File(directory, files[i]);
	if (!file.delete())
	  throw new IOException("couldn't delete " + files[i]);
      }
    }

  }

