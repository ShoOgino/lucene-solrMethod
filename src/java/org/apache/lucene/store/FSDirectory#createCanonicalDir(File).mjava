  // returns the canonical version of the directory, creating it if it doesn't exist.
  private static File createCanonicalDir(File file) throws IOException {
    file = new File(file.getCanonicalPath());

    if (file.exists() && !file.isDirectory())
      throw new IOException(file + " not a directory");

    if (!file.exists())
      if (!file.mkdirs())
        throw new IOException("Cannot create directory: " + file);

    return file;
  }

