  public void writeResponse() throws IOException {
    NamedList nl = new NamedList();
    nl.addAll(rsp.getValues());
    // give the main response a name it it doesn't have one
    if(wrapperFunction!=null) {
        writer.write(wrapperFunction + "(");
    }
    writeNamedList(null, nl);
    if(wrapperFunction!=null) {
        writer.write(")");
    }
  }

