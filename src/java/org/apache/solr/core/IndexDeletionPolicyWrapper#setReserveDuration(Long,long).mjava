  /**
   * Set the duration for which commit point is to be reserved by the deletion policy.
   *
   * @param indexVersion version of the commit point to be reserved
   * @param reserveTime  time in milliseconds for which the commit point is to be reserved
   */
  public void setReserveDuration(Long indexVersion, long reserveTime) {
    synchronized (reserves) {
      reserves.put(indexVersion, System.currentTimeMillis() + reserveTime);
      List<Long> removeThese = new ArrayList<Long>();
      for (Map.Entry<Long, Long> entry : reserves.entrySet()) {
        if (entry.getValue() < System.currentTimeMillis()) removeThese.add(entry.getKey());
      }
      for (Long l : removeThese) reserves.remove(l);
    }
  }

