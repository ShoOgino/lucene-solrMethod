  // overwrite both pending and committed
  protected synchronized int overwriteBoth(AddUpdateCommand cmd) throws IOException {
    if (cmd.id==null) {
      cmd.id=getId(cmd.doc);
    }
    synchronized (this) {
      pset.put(cmd.id, ONE);
      doAdd(cmd.doc);
    }
    return 1;
  }

