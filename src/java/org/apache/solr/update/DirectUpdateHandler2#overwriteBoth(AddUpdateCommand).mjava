  // overwrite both pending and committed
  protected synchronized int overwriteBoth(AddUpdateCommand cmd) throws IOException {
    if (cmd.indexedId ==null) {
      cmd.indexedId =getIndexedId(cmd.doc);
    }
    synchronized (this) {
      pset.put(cmd.indexedId, ONE);
      doAdd(cmd.doc);
    }
    return 1;
  }

