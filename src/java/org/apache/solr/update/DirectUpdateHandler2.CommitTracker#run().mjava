    /** This is the worker part for the ScheduledFuture **/
    public synchronized void run() {
      long started = System.currentTimeMillis();
      try {
        CommitUpdateCommand command = new CommitUpdateCommand( false );
        command.waitFlush = true;
        command.waitSearcher = true; 
        commit( command );
        autoCommitCount++;
      } 
      catch (Exception e) {
        log.severe( "auto commit error..." );
        e.printStackTrace();
      }
      finally {
        pending = null;
      }

      // check if docs have been submitted since the commit started
      if( lastAddedTime > started ) {
        if( docsSinceCommit > docsUpperBound ) {
          pending = scheduler.schedule( this, 100, TimeUnit.MILLISECONDS );
        }
        else if( timeUpperBound > 0 ) {
          pending = scheduler.schedule( this, timeUpperBound, TimeUnit.MILLISECONDS );
        }
      }
    }

