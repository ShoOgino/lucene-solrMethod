    private void _scheduleCommitWithin(long commitMaxTime) 
    {
      // Check if there is a commit already scheduled for longer then this time
      if( pending != null && 
          pending.getDelay(TimeUnit.MILLISECONDS) >= commitMaxTime ) 
      {
        pending.cancel(false);
        pending = null;
      }
      
      // schedule a new commit
      if( pending == null ) {
        pending = scheduler.schedule( this, commitMaxTime, TimeUnit.MILLISECONDS );
      }
    }

