  protected int addConditionally(AddUpdateCommand cmd) throws IOException {
    if (cmd.indexedId ==null) {
      cmd.indexedId =getIndexedId(cmd.doc);
    }
    Integer saveCount = pset.get(cmd.indexedId);
    if (saveCount!=null && saveCount!=0) {
      // a doc with this id already exists in the pending set
      return 0;
    }
    pset.put(cmd.indexedId, ONE);
    return 1;
  }

