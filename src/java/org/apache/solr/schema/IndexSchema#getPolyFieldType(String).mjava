  /**
   *
   * @param fieldName The name of the field
   * @return the {@link FieldType} or a {@link org.apache.solr.common.SolrException} if the field is not a poly field.
   */
  public FieldType getPolyFieldType(String fieldName){
    SchemaField f = fields.get(fieldName);
    if (f != null && f.isPolyField()) return f.getType();
    throw new SolrException( SolrException.ErrorCode.BAD_REQUEST,"undefined field or not a poly field "+fieldName);
  }

