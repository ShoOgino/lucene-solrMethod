  @Override
  public Query getRangeQuery(QParser parser, SchemaField sf, Date min, Date max, boolean minInclusive, boolean maxInclusive) {
    int ps = precisionStep;
    Query query = NumericRangeQuery.newLongRange(sf.getName(), ps,
              min == null ? null : min.getTime(),
              max == null ? null : max.getTime(),
              minInclusive, maxInclusive);

    // NumericRangeQuery extends MultiTermQuery but returns null for getTerm() which currently breaks
    // the span based highlighter in Lucene 2.9.0.  Wrapping the query prevents the highlighter
    // from calling getTerm()
    return new SolrQueryWrapper(query);
  }

