  /** return true if this query has no positive components */
  static boolean isNegative(Query q) {
    if (!(q instanceof BooleanQuery)) return false;
    BooleanQuery bq = (BooleanQuery)q;
    // TODO: use after next lucene update
    //for (BooleanClause clause: (List <BooleanClause>)bq.clauses()) {
    // if (bq.getClauses().size()==0) return false;
    BooleanClause[] clauses = bq.getClauses();
    if (clauses.length==0) return false;
    for (BooleanClause clause: clauses) {
      if (!clause.isProhibited()) return false;
    }
    return true;
  }

