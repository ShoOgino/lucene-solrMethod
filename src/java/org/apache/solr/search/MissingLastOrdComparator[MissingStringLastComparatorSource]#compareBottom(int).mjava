    public int compareBottom(int doc) {
      assert bottomSlot != -1;
      int order = this.order[doc];
      final int cmp = bottomOrd - order;
      if (bottomOrd==0 || order==0) {
        if (cmp==0) return 0;
        return bottomOrd==0 ? nullCmp : -nullCmp;        
      }

      if (cmp != 0) {
        return cmp;
      }

      final String val2 = lookup[order];
      if (bottomValue == null) {
        if (val2 == null) {
          return 0;
        }
        // bottom wins
        return nullCmp;
      } else if (val2 == null) {
        // doc wins
        return -nullCmp;
      }
      return bottomValue.compareTo(val2);
    }

