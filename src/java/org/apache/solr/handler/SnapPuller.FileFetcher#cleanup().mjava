    /**
     * cleanup everything
     */
    private void cleanup() {
      try {
        //close the file
        fileChannel.close();
      } catch (Exception e) {/* noop */
      }
      try {
        post.releaseConnection();
      } catch (Exception e) {}
      if (bytesDownloaded != size) {
        //if the download is not complete then
        //delete the file being downloaded
        try {
          file.delete();
        } catch (Exception e) {
          LOG.error("Error deleting file in cleanup" + e.getMessage());
        }
        //if the failure is due to a user abort it is returned nomally else an exception is thrown
        if (!aborted)
          throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,
                  "Unable to download " + fileName + " completely. Downloaded "
                          + bytesDownloaded + "!=" + size);
      }
    }

