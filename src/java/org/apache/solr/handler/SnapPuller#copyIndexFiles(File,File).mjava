  private boolean copyIndexFiles(File snapDir, File indexDir) {
    String segmentsFile = null;
    List<String> copiedfiles = new ArrayList<String>();
    for (Map<String, Object> f : filesDownloaded) {
      String fname = (String) f.get(NAME);
      if (fname.startsWith("segments_")) {
        //The segments file must be copied in the end
        //Otherwise , if the copy fails index ends up corrupted
        segmentsFile = fname;
        continue;
      }
      if (!copyAFile(snapDir, indexDir, fname, copiedfiles)) return false;
      copiedfiles.add(fname);
    }
    if (segmentsFile != null) {
      if (!copyAFile(snapDir, indexDir, segmentsFile, copiedfiles)) return false;
    }
    return true;
  }

