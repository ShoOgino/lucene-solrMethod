  /** download the index files. if snap needed download all the files .
   * @param snapNeeded is it a fresh index copy
   * @param snapDir the directory to which files need to be downloadeed to
   * @param client the httpclient instance
   * @param latestVersion the version number
   */
  private void downloadIndexFiles(boolean snapNeeded, File snapDir,
                                  HttpClient client, long latestVersion) throws Exception {
    for (Map<String, Object> file : filesToDownload) {
      File localIndexFile = new File(solrCore.getIndexDir(), (String) file.get(NAME));
      if (!localIndexFile.exists() || snapNeeded) {
        fileFetcher = new FileFetcher(snapDir, file, (String) file.get(NAME),
                client, false, latestVersion);
        currentFile = file;
        fileFetcher.fetchFile();
        filesDownloaded.add(new HashMap<String, Object>(file));
      } else {
        LOG.info("Skipping download for " + localIndexFile);
      }
    }
  }

