  @Override
  public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) throws Exception 
  {
    Iterable<ContentStream> streams = req.getContentStreams();
    if( streams == null ) {
      throw new SolrException( 400, "missing content stream" );
    }

    
    // Cycle through each stream
    for( ContentStream stream : req.getContentStreams() ) {
      String charset = getCharsetFromContentType( stream.getContentType() );
      Reader reader = null;
      if( charset == null ) {
        reader = new InputStreamReader( stream.getStream() );
      }
      else {
        reader = new InputStreamReader( stream.getStream(), charset );
      }
      rsp.add( "update", this.update( reader ) );
      
      // Make sure its closed
      try { reader.close(); } catch( Exception ex ){}
    }
  }

