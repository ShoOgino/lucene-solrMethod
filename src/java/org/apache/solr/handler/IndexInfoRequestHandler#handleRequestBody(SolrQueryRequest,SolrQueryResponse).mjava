  public void handleRequestBody(SolrQueryRequest req, SolrQueryResponse rsp) {

    try {
      SolrIndexSearcher searcher = req.getSearcher();
      IndexReader reader = searcher.getReader();
      Collection<String> fieldNames = reader.getFieldNames(IndexReader.FieldOption.ALL);
      Map<String,Object> fields = new HashMap<String,Object>();
      IndexSchema schema = req.getSchema();
      for (String fieldName : fieldNames) {
        Map<String,String> fieldInfo = new HashMap<String,String>();

        FieldType fieldType = schema.getFieldTypeNoEx(fieldName);
        if( fieldType != null ) {
          fieldInfo.put("type", fieldType.getTypeName());
        }
        else {
          // This can happen if you change the schema
          fieldInfo.put("type", null ); // "[unknown]"? nothing?
        }

        fields.put(fieldName, fieldInfo);
      }
      rsp.add("fields", fields);

      Map<String,Number> indexInfo = new HashMap<String,Number>();
      indexInfo.put("numDocs", reader.numDocs());
      indexInfo.put("maxDoc", reader.maxDoc());
      indexInfo.put("version", reader.getVersion());
      // indexInfo.put("age", );  // computed from SolrIndexSearcher.openedAt?

      rsp.add("index", indexInfo);
      
    } catch (SolrException e) {
      rsp.setException(e);
      return;
    } catch (Exception e) {
      SolrException.log(SolrCore.log, e);
      rsp.setException(e);
      return;
    }
  }

