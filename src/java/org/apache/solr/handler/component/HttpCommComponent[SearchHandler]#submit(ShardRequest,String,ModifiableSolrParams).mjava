  void submit(final ShardRequest sreq, final String shard, final ModifiableSolrParams params) {
    Callable<ShardResponse> task = new Callable<ShardResponse>() {
      public ShardResponse call() throws Exception {

        ShardResponse srsp = new ShardResponse();
        srsp.req = sreq;
        srsp.shard = shard;

        try {
          // String url = "http://" + shard + "/select";
          String url = "http://" + shard;

          params.remove("wt"); // use default (or should we explicitly set it?)
          params.remove("version");

          SolrServer server = new CommonsHttpSolrServer(url, client);
          // SolrRequest req = new SolrRequest(SolrRequest.METHOD.GET, "/select");
          // use generic request to avoid extra processing of queries
          // QueryRequest req = new QueryRequest(sreq.params);
          // srsp.rsp = server.request(req);
          srsp.rsp = server.query(sreq.params);
        } catch (Throwable th) {
          srsp.exception = th;
          if (th instanceof SolrException) {
            srsp.rspCode = ((SolrException)th).code();
          } else {
            srsp.rspCode = -1;
          }
        }

        return srsp;
      }
    };

    pending.add( completionService.submit(task) );
  }

