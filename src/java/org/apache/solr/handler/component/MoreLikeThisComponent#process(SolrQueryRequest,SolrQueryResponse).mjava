  @Override
  public void process(SolrQueryRequest req, SolrQueryResponse rsp) throws IOException 
  {
    SolrParams p = req.getParams();
    if( p.getBool( MoreLikeThisParams.MLT, false ) ) {
      ResponseBuilder builder = SearchHandler.getResponseBuilder( req );
      SolrIndexSearcher searcher = req.getSearcher();
      
      MoreLikeThisHandler.MoreLikeThisHelper mlt 
        = new MoreLikeThisHandler.MoreLikeThisHelper( p, searcher );
      
      int mltcount = p.getInt( MoreLikeThisParams.DOC_COUNT, 5 );
      NamedList<DocList> sim = mlt.getMoreLikeThese(
          builder.getResults().docList, mltcount, builder.getFieldFlags() );

      // TODO ???? add this directly to the response?
      rsp.add( "moreLikeThis", sim );
    }
  }

