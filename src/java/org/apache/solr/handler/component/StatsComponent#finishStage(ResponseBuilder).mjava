  @Override
  public void finishStage(ResponseBuilder rb) {
    if (!rb.doStats || rb.stage != ResponseBuilder.STAGE_GET_FIELDS) return;
    // wait until STAGE_GET_FIELDS
    // so that "result" is already stored in the response (for aesthetics)
    
    StatsInfo si = rb._statsInfo;
    
    NamedList stats = new SimpleOrderedMap();
    NamedList stats_fields = new SimpleOrderedMap();
    stats.add("stats_fields",stats_fields);
    for(String field : si.statsFields.keySet()){
      stats_fields.add(field, si.statsFields.get(field).getStatsValues());
    }

    rb.rsp.add("stats", stats);

    rb._statsInfo = null;
  }

