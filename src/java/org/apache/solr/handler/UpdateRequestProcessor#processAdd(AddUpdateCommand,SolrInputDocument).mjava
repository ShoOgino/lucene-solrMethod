  public void processAdd( AddUpdateCommand cmd, SolrInputDocument doc ) throws IOException
  {
    // Add a list of added id's to the response
    if( addedIds == null ) {
      addedIds = new ArrayList<Object>();
      response.add( "added", addedIds );
    }
    
    IndexSchema schema = req.getSchema();
    SchemaField uniqueKeyField = schema.getUniqueKeyField();
    Object id = null;
    if (uniqueKeyField != null) {
      SolrInputField f = doc.getField( uniqueKeyField.getName() );
      if( f != null ) {
        id = f.getFirstValue();
      }
    }
    addedIds.add( id );
    
    cmd.doc = DocumentBuilder.toDocument( doc, schema );
    updateHandler.addDoc(cmd);
  }

