   private void merge(String seg1, String seg2, String merged, boolean useCompoundFile)
   throws Exception {
      Directory directory = FSDirectory.getDirectory(indexDir, false);

      SegmentReader r1 = new SegmentReader(new SegmentInfo(seg1, 1, directory));
      SegmentReader r2 = new SegmentReader(new SegmentInfo(seg2, 1, directory));

      SegmentMerger merger = 
        new SegmentMerger(directory, merged, useCompoundFile);
        
      merger.add(r1);
      merger.add(r2);
      merger.merge();

      directory.close();
   }

