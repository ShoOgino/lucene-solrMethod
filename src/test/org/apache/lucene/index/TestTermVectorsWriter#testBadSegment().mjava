  /**
   * Test that no NullPointerException will be raised,
   * when adding one document with a single, empty field
   * and term vectors enabled.
   *
   */
  public void testBadSegment() {
    try {
      dir = new RAMDirectory();
      IndexWriter ir = new IndexWriter(dir, new StandardAnalyzer(), true);
      
      Document document = new Document();
      document.add(new Field("tvtest", "", Field.Store.NO, Field.Index.TOKENIZED,
          Field.TermVector.YES));
      ir.addDocument(document);
      ir.close();
      dir.close();
    } catch (Exception e) {
      e.printStackTrace();
      assertTrue(false);
    }
  }

