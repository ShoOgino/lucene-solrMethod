  private IndexWriter newWriter(Directory dir, boolean create)
      throws IOException {
    final IndexWriter writer = new IndexWriter(dir, new WhitespaceAnalyzer(), create, IndexWriter.MaxFieldLength.LIMITED);
    writer.setMergePolicy(new LogDocMergePolicy());
    return writer;
  }

