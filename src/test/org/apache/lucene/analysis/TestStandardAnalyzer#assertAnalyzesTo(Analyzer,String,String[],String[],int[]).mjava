  public void assertAnalyzesTo(Analyzer a, String input, String[] expectedImages, String[] expectedTypes, int[] expectedPosIncrs) throws Exception {
    TokenStream ts = a.tokenStream("dummy", new StringReader(input));
    // TODO Java 1.5
    //final TypeAttribute typeAtt = reusableToken.getAttribute(TypeAttribute.class);
    //final PositionIncrementAttribute posIncrAtt = reusableToken.getAttribute(PositionIncrementAttribute.class);

    final TermAttribute termAtt = (TermAttribute) ts.getAttribute(TermAttribute.class);
    final TypeAttribute typeAtt = (TypeAttribute) ts.getAttribute(TypeAttribute.class);
    final PositionIncrementAttribute posIncrAtt = (PositionIncrementAttribute) ts.getAttribute(PositionIncrementAttribute.class);
    
    for (int i = 0; i < expectedImages.length; i++) {
      assertTrue(ts.incrementToken());
      assertEquals(expectedImages[i], new String(termAtt.termBuffer(), 0, termAtt.termLength()));
      if (expectedTypes != null) {
        assertEquals(expectedTypes[i], typeAtt.type());
      }
      if (expectedPosIncrs != null) {
        assertEquals(expectedPosIncrs[i], posIncrAtt.getPositionIncrement());
      }
    }
    assertFalse(ts.incrementToken());
    ts.close();
  }

