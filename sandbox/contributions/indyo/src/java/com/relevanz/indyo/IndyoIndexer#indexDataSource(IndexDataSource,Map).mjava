    private void indexDataSource(IndexDataSource source, Map customFields)
            throws Exception
    {
        Map[] data = source.getData();
        // here's a good place to spawn a couple of threads for indexing
        for (int i = 0; i < data.length; i++)
        {
            DocumentHandler docHandler =
                    new DocumentHandler(data[i], customFields, fsWriter);
            docHandler.process();
        }
    }

