    /**
     * Indexes documents.
     */
    public synchronized void index(IndexDataSource ds) throws IOException, Exception
    {
        log.debug("Initiating search engine indexing...");
        long start = System.currentTimeMillis();
        // temporarily use an empty map whilst custom fields get implemented
        indexDataSource(ds, Collections.EMPTY_MAP);
        fsWriter.optimize();
        fsWriter.close();
        long stop = System.currentTimeMillis();
        log.debug("Indexing took " + (stop - start) + " milliseconds");
    }

