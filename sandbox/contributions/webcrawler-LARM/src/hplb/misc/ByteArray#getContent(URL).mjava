  /**
   * Return contents of a WWW resource identified by a URL.
   * @param url the resource to retrieve
   * @return    the resource contents as a byte array
   */
  public static byte[] getContent(URL url) throws IOException {
    URLConnection conn = url.openConnection();
    InputStream in = conn.getInputStream();
    int length;

    /*
     * N.B. URLConnection.getContentLength() is buggy for "http" resources
     * (at least in JDK1.0.2) and won't work for "file" URLs either.
     */
    length = length = conn.getContentLength();
    if (length == -1)
      length = conn.getHeaderFieldInt("Content-Length", -1);
    if (length == -1)
      return readAll(in);
    return readn(in, length);
  }

