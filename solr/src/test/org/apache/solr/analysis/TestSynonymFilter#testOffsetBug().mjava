  public void testOffsetBug() throws IOException {
    // With the following rules:
    // a a=>b
    // x=>y
    // analysing "a x" causes "y" to have a bad offset (end less than start)
    // SOLR-167
    SynonymMap map = new SynonymMap();

    boolean orig = false;
    boolean merge = true;

    map.add(strings("a a"), tokens("b"), orig, merge);
    map.add(strings("x"), tokens("y"), orig, merge);

    // "a a x" => "b y"
    assertTokenizesTo(map, tokens("a,1,0,1 a,1,2,3 x,1,4,5"),
        new String[] { "b", "y" },
        new int[] { 0, 4 },
        new int[] { 3, 5 },
        new int[] { 1, 1 });
  }

