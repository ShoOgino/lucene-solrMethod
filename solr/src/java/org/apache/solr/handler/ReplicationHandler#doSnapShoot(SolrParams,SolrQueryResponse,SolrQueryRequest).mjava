  private void doSnapShoot(SolrParams params, SolrQueryResponse rsp, SolrQueryRequest req) {
    try {
      IndexDeletionPolicyWrapper delPolicy = core.getDeletionPolicy();
      IndexCommit indexCommit = delPolicy.getLatestCommit();

      if(indexCommit == null) {
        indexCommit = req.getSearcher().getReader().getIndexCommit();
        // race?
        delPolicy.setReserveDuration(indexCommit.getVersion(), reserveCommitDuration);
      }
 
      new SnapShooter(core, params.get("location")).createSnapAsync(indexCommit, this);

    } catch (Exception e) {
      LOG.warn("Exception during creating a snapshot", e);
      rsp.add("exception", e);
    }
  }

