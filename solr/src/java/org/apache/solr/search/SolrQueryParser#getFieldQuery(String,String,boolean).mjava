  protected Query getFieldQuery(String field, String queryText, boolean quoted) throws ParseException {
    checkNullField(field);
    // intercept magic field name of "_" to use as a hook for our
    // own functions.
    if (field.charAt(0) == '_') {
      if ("_val_".equals(field)) {
        if (parser==null) {
          return QueryParsing.parseFunction(queryText, schema);
        } else {
          QParser nested = parser.subQuery(queryText, "func");
          return nested.getQuery();
        }
      } else if ("_query_".equals(field) && parser != null) {
        return parser.subQuery(queryText, null).getQuery();
      }
    }
    //Intercept poly fields, as they get expanded by default to an OR clause of
    SchemaField sf = schema.getField(field);
    //TODO: is there anyway to avoid this instance of check?
    if (sf != null&& !(sf.getType() instanceof TextField)){//we have a poly field, deal with it specially by delegating to the FieldType
      return sf.getType().getFieldQuery(parser, sf, queryText); 
    }

    // default to a normal field query
    return super.getFieldQuery(field, queryText, quoted);
  }

