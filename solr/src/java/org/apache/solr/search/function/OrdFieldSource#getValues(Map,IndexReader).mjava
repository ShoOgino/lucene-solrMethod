  public DocValues getValues(Map context, IndexReader reader) throws IOException {
    return new StringIndexDocValues(this, reader, field) {
      protected String toTerm(String readableValue) {
        return readableValue;
      }
      
      public float floatVal(int doc) {
        return (float)termsIndex.getOrd(doc);
      }

      public int intVal(int doc) {
        return termsIndex.getOrd(doc);
      }

      public long longVal(int doc) {
        return (long)termsIndex.getOrd(doc);
      }

      public double doubleVal(int doc) {
        return (double)termsIndex.getOrd(doc);
      }

      public String strVal(int doc) {
        // the string value of the ordinal, not the string itself
        return Integer.toString(termsIndex.getOrd(doc));
      }

      public String toString(int doc) {
        return description() + '=' + intVal(doc);
      }
    };
  }

