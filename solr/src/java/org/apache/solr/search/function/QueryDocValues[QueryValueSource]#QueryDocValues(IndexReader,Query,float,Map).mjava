  public QueryDocValues(IndexReader reader, Query q, float defVal, Map fcontext) throws IOException {
    this.reader = reader;
    this.q = q;
    this.defVal = defVal;
    this.fcontext = fcontext;

    Weight w = fcontext==null ? null : (Weight)fcontext.get(q);
    if (w == null) {
       IndexSearcher weightSearcher = fcontext == null ? new IndexSearcher(reader) : (IndexSearcher)fcontext.get("searcher");

       // TODO: sort by function doesn't weight (SOLR-1297 is open because of this bug)... so weightSearcher will currently be null
       if (weightSearcher == null) weightSearcher = new IndexSearcher(reader);

       w = q.weight(weightSearcher);
    }
    weight = w;
  }

