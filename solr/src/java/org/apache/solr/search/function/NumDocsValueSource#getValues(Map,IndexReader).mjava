  @Override
  public DocValues getValues(Map context, IndexReader reader) throws IOException {
    // Searcher has no numdocs so we must use the reader instead
    SolrIndexReader topReader = (SolrIndexReader)reader;
    while (topReader.getParent() != null) topReader = topReader.getParent();
    return new ConstIntDocValues(topReader.numDocs(), this);
  }

