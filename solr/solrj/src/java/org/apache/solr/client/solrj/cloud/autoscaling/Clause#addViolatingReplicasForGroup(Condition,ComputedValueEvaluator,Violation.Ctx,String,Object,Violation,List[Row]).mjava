  void addViolatingReplicasForGroup(Condition tag,
                                    ComputedValueEvaluator eval,
                                    Violation.Ctx ctx, String tagName, Object tagVal,
                                    Violation violation,
                                    List<Row> nodes) {
    if (tag.varType.addViolatingReplicas(ctx)) return;
    for (Row row : nodes) {
      boolean isPass;
      if (tagVal instanceof Condition) {
        Condition condition = (Condition) tagVal;
        if(condition.computedType != null){
          eval.node = row.node;
          Object val = eval.apply(condition);
          condition = new Condition(condition.name, val,condition.op, null, condition.clause);
        }
        isPass = condition.isPass(row);
      }
      else isPass = tagVal.equals(row.getVal(tagName));
      if (isPass) {
        row.forEachReplica(eval.collName, ri -> {
          if (Policy.ANY.equals(eval.shardName)
              || eval.shardName.equals(ri.getShard()))
            violation.addReplica(new Violation.ReplicaInfoAndErr(ri).withDelta(tag.delta(row.getVal(tag.name))));
        });
      }
    }

  }

