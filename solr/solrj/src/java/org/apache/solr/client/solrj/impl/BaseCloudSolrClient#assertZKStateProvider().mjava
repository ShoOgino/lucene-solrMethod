  private ZkClientClusterStateProvider assertZKStateProvider() {
    if (getClusterStateProvider() instanceof ZkClientClusterStateProvider) {
      return (ZkClientClusterStateProvider) getClusterStateProvider();
    }
    throw new IllegalArgumentException("This client does not use ZK");

  }

