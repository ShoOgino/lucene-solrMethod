  public DatePartEvaluator(StreamExpression expression, StreamFactory factory) throws IOException {
    super(expression, factory);

    String functionName = expression.getFunctionName();

    try {
      this.function = FUNCTION.valueOf(functionName);
    } catch (IllegalArgumentException e) {
      throw new IOException(String.format(Locale.ROOT, "Invalid date expression %s - expecting one of %s", functionName, Arrays.toString(FUNCTION.values())));
    }

    if (1 != subEvaluators.size()) {
      throw new IOException(String.format(Locale.ROOT, "Invalid expression %s - expecting one value but found %d", expression, subEvaluators.size()));
    }
  }

