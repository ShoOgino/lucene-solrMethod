    @Override
    public void writeMap(EntryWriter ew) throws IOException {
      ew.put("type", type.name());
      if(violation!= null) ew.put("violation",
          new ConditionalMapWriter(violation,
              (k, v) -> !"violatingReplicas".equals(k)));
      ew.put("operation", operation);
    }

