  @Override
  public Number evaluate(Tuple tuple) throws IOException {

    try {
      String dateStr = (String) tuple.get(fieldName);
      if (dateStr != null && !dateStr.isEmpty()) {
        Instant instant = Instant.parse(dateStr);
        if (function.equals(FUNCTION.epoch)) return instant.toEpochMilli();

        LocalDateTime date = LocalDateTime.ofInstant(instant, ZoneOffset.UTC);
        return evaluate(date);
      }
    } catch (ClassCastException | DateTimeParseException e) {
      throw new IOException(String.format(Locale.ROOT,"Invalid field %s - The field must be a string formatted in the ISO_INSTANT date format.",fieldName));
    }

    return null;
  }

