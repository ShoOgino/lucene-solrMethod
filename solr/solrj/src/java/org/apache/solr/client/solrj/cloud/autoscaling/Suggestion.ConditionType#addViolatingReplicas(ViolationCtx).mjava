    @Override
    public void addViolatingReplicas(ViolationCtx ctx) {
      if (impl != null) {
        impl.addViolatingReplicas(ctx);
        return;
      }
      for (Row row : ctx.allRows) {
        if (ctx.clause.tag.varType.meta.isNodeSpecificVal() && !row.node.equals(ctx.tagKey)) continue;
        collectViolatingReplicas(ctx, row);
      }
    }

