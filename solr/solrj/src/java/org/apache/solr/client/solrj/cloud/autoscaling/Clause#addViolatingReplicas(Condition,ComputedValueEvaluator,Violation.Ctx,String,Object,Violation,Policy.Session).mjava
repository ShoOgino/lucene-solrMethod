  void addViolatingReplicas(Condition tag,
                            ComputedValueEvaluator eval,
                            Violation.Ctx ctx, String tagName, Object tagVal,
                            Violation violation,
                            Policy.Session session) {
    if (tag.varType.addViolatingReplicas(ctx)) return;
    for (Row row : session.matrix) {
      if (tagVal.equals(row.getVal(tagName))) {
        row.forEachReplica(eval.collName, ri -> {
          if (Policy.ANY.equals(eval.shardName)
              || eval.shardName.equals(ri.getShard()))
            violation.addReplica(new Violation.ReplicaInfoAndErr(ri).withDelta(tag.delta(row.getVal(tag.name))));
        });
      }
    }

  }

