  List<Violation> testChangedMatrix(boolean strict, Policy.Session session, double[] deviation) {
    Policy.setApproxValuesAndSortNodes(session.getPolicy().clusterPreferences, session.matrix);
    List<Violation> errors = new ArrayList<>();
    for (Clause clause : session.expandedClauses) {
      if (strict || clause.strict) {
        List<Violation> errs = clause.test(session, deviation);
        if (!errs.isEmpty()) {
          errors.addAll(errs);
        }
      }
    }
    return errors;
  }

