  public Double delta(Object val) {
    if (val instanceof ReplicaCount) val = ((ReplicaCount) val).getVal(getClause().type);
    if (this.val instanceof String) {
      if (op == LESS_THAN || op == GREATER_THAN) {
        return op
            .opposite(getClause().isReplicaZero() && this == getClause().tag)
            .delta(Clause.parseDouble(name, this.val), Clause.parseDouble(name, val));
      } else {
        return 0d;
      }
    } else {
      if (this == getClause().getReplica()) {
        Double delta = op.delta(this.val, val);
        return getClause().isReplicaZero() ? -1 * delta : delta;
      } else {
        return op
            .opposite(getClause().isReplicaZero() && this == getClause().getTag())
            .delta(this.val, val);
      }

    }
  }

