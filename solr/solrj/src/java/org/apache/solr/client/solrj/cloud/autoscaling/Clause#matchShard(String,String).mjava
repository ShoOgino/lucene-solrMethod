  boolean matchShard(String replicaShard, String shardInContext) {
    if (shard == null || shard.val.equals(ANY)) return true;
    if (shard.val.equals(Policy.EACH) && replicaShard.equals(shardInContext)) return true;
    if (shard.val.equals(replicaShard)) return true;
    return false;
  }

