  @Override
  public Object computeValue(Policy.Session session, Clause.Condition condition, String collection, String shard, String node) {
    if (condition.computedType == Clause.ComputedType.EQUAL) {
      int[] coresCount = new int[1];
      int[] liveNodes = new int[1];
      for (Row row : session.matrix) {
        if (!row.isLive) continue;
        liveNodes[0]++;
        row.forEachReplica(replicaInfo -> coresCount[0]++);
      }
      return liveNodes[0] == 0 || coresCount[0] == 0 ? 0d : (double) coresCount[0] / (double) liveNodes[0];
    } else {
      throw new IllegalArgumentException("Invalid computed type in " + condition);
    }
  }

