  @Override
  public Object doWork(Object... values) throws IOException {

    if(values.length < 2) {
      throw new IOException("kmeans expects atleast two parameters a Matrix of observations and k");
    }

    Matrix matrix = null;
    int k = 0;
    int maxIterations = 1000;

    if(values[0] instanceof Matrix) {
      matrix = (Matrix)values[0];
    } else {
      throw new IOException("The first parameter for kmeans should be the observation matrix.");
    }

    if(values[1] instanceof Number) {
      k = ((Number)values[1]).intValue();
    } else {
      throw new IOException("The second parameter for kmeans should be k.");
    }

    if(values.length == 3) {
      maxIterations = ((Number)values[2]).intValue();
    }

    KMeansPlusPlusClusterer<ClusterPoint> kmeans = new KMeansPlusPlusClusterer(k, maxIterations);
    List<ClusterPoint> points = new ArrayList();
    double[][] data = matrix.getData();

    List<String> ids = matrix.getRowLabels();

    for(int i=0; i<data.length; i++) {
      double[] vec = data[i];
      points.add(new ClusterPoint(ids.get(i), vec));
    }

    Map fields = new HashMap();

    fields.put("k", k);
    fields.put("distance", "euclidean");
    fields.put("maxIterations", maxIterations);

    return new ClusterTuple(fields, kmeans.cluster(points), matrix.getColumnLabels());
  }

