  @Override
  public Number evaluate(Tuple tuple) throws IOException {

    Instant instant = null;
    TemporalAccessor date = null;

    //First evaluate the parameter
    StreamEvaluator streamEvaluator = subEvaluators.get(0);
    Object tupleValue = streamEvaluator.evaluate(tuple);

    if (tupleValue == null) return null;

    if (tupleValue instanceof String) {
      instant = getInstant((String) tupleValue);
    } else if (tupleValue instanceof Instant) {
      instant = (Instant) tupleValue;
    } else if (tupleValue instanceof Date) {
      instant = ((Date) tupleValue).toInstant();
    } else if (tupleValue instanceof TemporalAccessor) {
      date = ((TemporalAccessor) tupleValue);
    }

    if (instant != null) {
      if (function.equals(FUNCTION.epoch)) return instant.toEpochMilli();
      date = LocalDateTime.ofInstant(instant, ZoneOffset.UTC);
    }

    if (date != null) {
      return evaluate(date);
    }

    throw new IOException(String.format(Locale.ROOT, "Invalid parameter %s - The parameter must be a string formatted ISO_INSTANT or of type Instant,Date or LocalDateTime.", String.valueOf(tupleValue)));
  }

