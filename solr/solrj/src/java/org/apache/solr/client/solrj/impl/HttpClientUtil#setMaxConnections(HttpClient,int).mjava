  /**
   * Set max total connections allowed. This call will only work when
   * {@link ThreadSafeClientConnManager} is used.
   */
  public static void setMaxConnections(final HttpClient httpClient,
      int max) {
    if(httpClient.getConnectionManager() instanceof ThreadSafeClientConnManager) {
      ThreadSafeClientConnManager mgr = (ThreadSafeClientConnManager)httpClient.getConnectionManager();
      mgr.setMaxTotal(max);
    }
  }

