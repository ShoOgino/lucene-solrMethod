    List<Pair<ReplicaInfo, Row>> getValidReplicas(boolean sortDesc, boolean isSource, int until) {
      List<Pair<Policy.ReplicaInfo, Row>> allPossibleReplicas = new ArrayList<>();

      if (sortDesc) {
        if (until == -1) until = getMatrix().size();
        for (int i = 0; i < until; i++) addReplicaToList(getMatrix().get(i), isSource, allPossibleReplicas);
      } else {
        if (until == -1) until = 0;
        for (int i = getMatrix().size() - 1; i >= until; i--)
          addReplicaToList(getMatrix().get(i), isSource, allPossibleReplicas);
      }
      return allPossibleReplicas;
    }

