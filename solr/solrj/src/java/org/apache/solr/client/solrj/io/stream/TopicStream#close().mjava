  public void close() throws IOException {
    try {
      persistCheckpoints();
    } finally {

      if(solrStreams != null) {
        for (TupleStream solrStream : solrStreams) {
          solrStream.close();
        }
      }

      if (cache == null) {
        cloudSolrClient.close();
      }
    }
  }

