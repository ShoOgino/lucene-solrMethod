  public Tuple read() throws IOException {

    if(finished) {
      Map<String,Object> m = new HashMap<>();
      m.put("EOF", true);
      return new Tuple(m);
    } else {
      finished = true;
      Map<String, Object> values = new HashMap<>();

      String plot= stringParams.get("type");
      StreamEvaluator xvalues = evaluatorParams.get("x");
      StreamEvaluator yvalues = evaluatorParams.get("y");

      List<Number> y = (List<Number>)yvalues.evaluateOverContext();
      List<Number> x = null;

      if(xvalues == null) {
        //x is null so add a sequence
        x = new ArrayList();
        for(int i=0; i<y.size(); i++) {
          x.add(i+1);
        }
      } else {
        x = (List<Number>) xvalues.evaluateOverContext();
      }

      List<List<Number>> xy = new ArrayList();
      for(int i=0; i<x.size(); i++) {
        List<Number> pair = new ArrayList();
        pair.add(x.get(i));
        pair.add(y.get(i));
        xy.add(pair);
      }

      values.put("plot", plot);
      values.put("data", xy);

      Tuple tup = new Tuple(values);
      tup.fieldLabels = fieldLabels;
      tup.fieldNames = fieldNames;
      return tup;
    }
  }

