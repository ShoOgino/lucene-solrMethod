  private String extractSortOrder(StreamExpression expression, StreamFactory factory) throws IOException{
    StreamExpressionNamedParameter sortParam = factory.getNamedOperand(expression, "sort");
    if(null == sortParam){
      return null; // this is ok
    }
    
    if(sortParam.getParameter() instanceof StreamExpressionValue){
      String sortOrder = ((StreamExpressionValue)sortParam.getParameter()).getValue().trim().toLowerCase(Locale.ROOT);
      if("asc".equals(sortOrder) || "desc".equals(sortOrder)){
        return sortOrder;
      }
    }
    
    throw new IOException(String.format(Locale.ROOT,"Invalid expression %s - invalid 'sort' parameter - expecting either 'asc' or 'desc'", expression));
  }

