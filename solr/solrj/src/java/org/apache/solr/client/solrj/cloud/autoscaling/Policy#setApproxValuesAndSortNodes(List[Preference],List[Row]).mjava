  static void setApproxValuesAndSortNodes(List<Preference> clusterPreferences, List<Row> matrix) {
    if (!clusterPreferences.isEmpty()) {
      //this is to set the approximate value according to the precision
      ArrayList<Row> tmpMatrix = new ArrayList<>(matrix);
      for (Preference p : clusterPreferences) {
        try {
          tmpMatrix.sort((r1, r2) -> p.compare(r1, r2, false));
        } catch (Exception e) {
          LOG.error("Exception! prefs = {}, matrix = {}", clusterPreferences, matrix);
          throw e;
        }
        p.setApproxVal(tmpMatrix);
      }
      // the tmpMatrix was needed only to set the approximate values, now we sort the real matrix
      // recursing through each preference
      matrix.sort((Row r1, Row r2) -> {
        int result = clusterPreferences.get(0).compare(r1, r2, true);
        if (result == 0) result = clusterPreferences.get(0).compare(r1, r2, false);
        return result;
      });
    }
  }

