  private void init(String collectionName, String zkHost, Map params) throws IOException {
    this.zkHost = zkHost;
    this.collection = collectionName;
    this.params = params;

    // If the comparator is null then it was not explicitly set so we will create one using the sort parameter
    // of the query. While doing this we will also take into account any aliases such that if we are sorting on
    // fieldA but fieldA is aliased to alias.fieldA then the comparater will be against alias.fieldA.
    if(!params.containsKey("fl")){
      throw new IOException("fl param expected for a stream");
    }
    if(!params.containsKey("sort")){
      throw new IOException("sort param expected for a stream");
    }
    this.comp = parseComp((String)params.get("sort"), (String)params.get("fl")); 
  }

