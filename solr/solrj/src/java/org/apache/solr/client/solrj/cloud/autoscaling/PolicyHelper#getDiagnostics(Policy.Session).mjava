  public static MapWriter getDiagnostics(Policy.Session session) {
    List<Row> sorted = session.getSortedNodes();
    return ew -> {
      writeNodes(ew, sorted);
      ew.put("liveNodes", session.cloudManager.getClusterStateProvider().getLiveNodes())
          .put("violations", session.getViolations())
          .put("config", session.getPolicy());
    };
  }

