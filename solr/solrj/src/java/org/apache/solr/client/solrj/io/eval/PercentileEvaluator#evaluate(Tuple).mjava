  public Number evaluate(Tuple tuple) throws IOException {
    if(subEvaluators.size() != 2) {
      throw new IOException("Percentile expects 2 parameters: an array and a number");
    }

    StreamEvaluator colEval = subEvaluators.get(0);
    List<Number> column = (List<Number>)colEval.evaluate(tuple);

    double[] data = new double[column.size()];
    for(int i=0; i<data.length; i++) {
      data[i] = column.get(i).doubleValue();
    }

    Percentile percentile = new Percentile();
    percentile.setData(data);
    StreamEvaluator numEval = subEvaluators.get(1);
    Number num  = (Number)numEval.evaluate(tuple);
    return percentile.evaluate(num.doubleValue());
  }

