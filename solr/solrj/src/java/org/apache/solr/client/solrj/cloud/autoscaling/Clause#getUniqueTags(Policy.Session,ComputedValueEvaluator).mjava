  private Set getUniqueTags(Policy.Session session, ComputedValueEvaluator eval) {
    Set tags =  new HashSet();

    if(nodeSetPresent) {
      if (tag.val instanceof List && ((List) tag.val).get(0) instanceof Condition) {
        tags.addAll((List) tag.val);
      } else {
        tags.add(tag);
      }
      return tags;
    }
    if(tag.op == WILDCARD){
      for (Row row : session.matrix) {
        eval.node = row.node;
        Condition tag = this.tag;
        if (tag.computedType != null) tag = evaluateValue(tag, eval);
        Object val = row.getVal(tag.name);
        if (val != null) {
          if (tag.op == LESS_THAN || tag.op == GREATER_THAN) {
            tags.add(this.tag);
          } else if (tag.isPass(val)) {
            tags.add(val);
          }
        }
      }

    } else {

      if (tag.op == LESS_THAN || tag.op == GREATER_THAN || tag.op == RANGE_EQUAL || tag.op == NOT_EQUAL) {
        tags.add(tag); // eg: freedisk > 100
      } else if (tag.val instanceof Collection) {
        tags.add(tag); //e: sysprop.zone:[east,west]
      } else {
        tags.add(tag.val);//
      }
    }
    return tags;
  }

