  public Tuple read() throws IOException {
    if (out.hasNext()) {
      return out.next();
    } else {
      Map fields = new HashMap();
      fields.put("rows", tuples.size());

      fields.put("EOF", true);
      Tuple tuple = new Tuple(fields);
      return tuple;
    }

  }

