  public boolean isMatch(Replica r, String collection, String shard) {
    if (type != null && r.getType() != type) return false;
    if (r.getCollection().equals(collection)) {
      if (this.shard == null || this.shard.val.equals(Policy.ANY)) return true;
      else if (this.shard.val.equals(Policy.EACH) && r.getShard().equals(shard)) return true;
      else return this.shard.val.equals(r.getShard()) && r.getShard().equals(shard);
    }
    return false;
  }

