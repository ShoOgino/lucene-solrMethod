  @Override
  public ContentWriter getContentWriter(SolrRequest req) {
    if (req instanceof UpdateRequest) {
      UpdateRequest updateRequest = (UpdateRequest) req;
      if (isNull(updateRequest.getDocuments()) &&
          isNull(updateRequest.getDeleteByIdMap()) &&
          isNull(updateRequest.getDeleteQuery())
          && (updateRequest.getDocIterator() == null)) {
        return null;
      }
      return new ContentWriter() {
        @Override
        public void write(OutputStream os) throws IOException {
          new JavaBinUpdateRequestCodec().marshal(updateRequest, os);
        }

        @Override
        public String getContentType() {
          return "application/javabin";
        }
      };
    } else {
      return super.getContentWriter(req);
    }
  }

