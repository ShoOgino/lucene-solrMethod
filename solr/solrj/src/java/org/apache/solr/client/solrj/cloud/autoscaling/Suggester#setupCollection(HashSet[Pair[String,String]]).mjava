  private void setupCollection(HashSet<Pair<String, String>> collectionShardPairs) {
    ClusterStateProvider stateProvider = session.cloudManager.getClusterStateProvider();
    for (Pair<String, String> shard : collectionShardPairs) {
      // if this is not a known collection from the existing clusterstate,
      // then add it
      if (session.matrix.stream().noneMatch(row -> row.collectionVsShardVsReplicas.containsKey(shard.first()))) {
        session.addClausesForCollection(stateProvider, shard.first());
      }
      for (Row row : session.matrix) {
        Map<String, List<ReplicaInfo>> shardInfo = row.collectionVsShardVsReplicas.computeIfAbsent(shard.first(), it -> new HashMap<>());
        if (shard.second() != null) shardInfo.computeIfAbsent(shard.second(), it -> new ArrayList<>());
      }
    }
  }

