  @Override
  public Object evaluate(Tuple tuple) throws IOException {
    
    List<Object> results = evaluateAll(tuple);
    
    if(3 != results.size()){
      String message = String.format(Locale.ROOT,"%s(...) only works with 3 values but %s were provided", constructingFactory.getFunctionName(getClass()), results.size());
      throw new IOException(message);
    }
    
    if(!(results.get(0) instanceof Boolean)){
      throw new IOException(String.format(Locale.ROOT,"$s(...) only works with a boolean as the first parameter but found %s",results.get(0).getClass().getSimpleName()));
    }
  
    return (boolean)results.get(0) ? results.get(1) : results.get(2);
  }

