  @Override
  public Set<String> getLiveNodes() {
    if (isClosed) throw new AlreadyClosedException();
    ClusterState clusterState = zkStateReader.getClusterState();
    if (clusterState != null) {
      return clusterState.getLiveNodes();
    } else {
      return Collections.emptySet();
    }
  }

