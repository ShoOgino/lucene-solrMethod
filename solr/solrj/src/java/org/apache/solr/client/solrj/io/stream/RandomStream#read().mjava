  public Tuple read() throws IOException {
    if(documentIterator.hasNext()) {
      Map map = new HashMap();
      SolrDocument doc = documentIterator.next();

      // Put the generated x-axis first. If there really is an x field it will overwrite it.
      if(outputX) {
        map.put("x", x++);
      }

      for(Entry<String, Object> entry : doc.entrySet()) {
        map.put(entry.getKey(), entry.getValue());
      }


      return new Tuple(map);
    } else {
      Map fields = new HashMap();
      fields.put("EOF", true);
      Tuple tuple = new Tuple(fields);
      return tuple;
    }
  }

