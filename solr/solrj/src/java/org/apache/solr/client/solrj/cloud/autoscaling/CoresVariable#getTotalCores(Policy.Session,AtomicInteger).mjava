  private int getTotalCores(Policy.Session session, AtomicInteger liveNodes) {
    int[] coresCount = new int[1];
    for (Row row : session.matrix) {
      if (!row.isLive) continue;
      liveNodes.incrementAndGet();
      row.forEachReplica(replicaInfo -> coresCount[0]++);
    }
    return coresCount[0];
  }

