  public FacetStream(String zkHost,
                     String collection,
                     Map<String, String> props,
                     Bucket[] buckets,
                     Metric[] metrics,
                     FieldComparator[] sorts,
                     int limit) throws IOException {
    this.zkHost  = zkHost;
    this.props   = props;
    this.buckets = buckets;
    this.metrics = metrics;
    this.limit   = limit;
    this.collection = collection;
    this.sorts = sorts;
    
    // In a facet world it only makes sense to have the same field name in all of the sorters
    // Because FieldComparator allows for left and right field names we will need to validate
    // that they are the same
    for(FieldComparator sort : sorts){
      if(sort.hasDifferentFieldNames()){
        throw new IOException("Invalid FacetStream - all sorts must be constructed with a single field name.");
      }
    }
  }

