  public Tuple read() throws IOException {
    Tuple original = stream.read();
    
    if(original.EOF){
      return original;
    }

    // create a copy with the limited set of fields
    Tuple workingToReturn = new Tuple(new HashMap<>());
    Tuple workingForEvaluators = new Tuple(new HashMap<>());
    for(Object fieldName : original.fields.keySet()){
      workingForEvaluators.put(fieldName, original.get(fieldName));
      if(selectedFields.containsKey(fieldName)){
        workingToReturn.put(selectedFields.get(fieldName), original.get(fieldName));
      }
    }
    
    // apply all operations
    for(StreamOperation operation : operations){
      operation.operate(workingToReturn);
      operation.operate(workingForEvaluators);
    }
    
    // Apply all evaluators
    for(Map.Entry<StreamEvaluator, String> selectedEvaluator : selectedEvaluators.entrySet()) {
      workingToReturn.put(selectedEvaluator.getValue(), selectedEvaluator.getKey().evaluate(workingForEvaluators));
    }
    
    return workingToReturn;
  }

