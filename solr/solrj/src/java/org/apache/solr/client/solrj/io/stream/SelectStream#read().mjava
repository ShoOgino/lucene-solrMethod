  public Tuple read() throws IOException {
    Tuple original = stream.read();
    
    if(original.EOF){
      return original;
    }

    // create a copy with the limited set of fields
    Tuple working = new Tuple(new HashMap<>());
    for(Object fieldName : original.fields.keySet()){
      if(selectedFields.containsKey(fieldName)){
        working.put(selectedFields.get(fieldName), original.get(fieldName));
      }
    }
    
    // apply all operations
    for(StreamOperation operation : operations){
      operation.operate(working);
    }
    
    return working;
  }

