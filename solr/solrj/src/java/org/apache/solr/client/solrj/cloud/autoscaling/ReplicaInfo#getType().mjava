  public Replica.Type getType() {
    Object o = variables.get(ZkStateReader.REPLICA_TYPE);
    if (o == null) {
      variables.put(ZkStateReader.REPLICA_TYPE, Replica.Type.NRT);
      return Replica.Type.NRT;
    } else if (o instanceof Replica.Type) {
      return (Replica.Type)o;
    } else {
      Replica.Type type = Replica.Type.get(String.valueOf(o).toUpperCase(Locale.ROOT));
      variables.put(ZkStateReader.REPLICA_TYPE, type);
      return type;
    }
  }

