  private static int getRelevantReplicasCount(Policy.Session session, Clause.Condition cv, String collection, String shard) {
    AtomicInteger totalReplicasOfInterest = new AtomicInteger(0);
    Clause clause = cv.getClause();
    for (Row row : session.matrix) {
      row.forEachReplica(replicaInfo -> {
        if (replicaInfo.getCollection().equals(collection)) {
          if (clause.getShard() ==null || clause.getShard().op == Operand.WILDCARD || replicaInfo.getShard().equals(shard)) {
            if (cv.getClause().type == null || replicaInfo.getType() == cv.getClause().type)
              totalReplicasOfInterest.incrementAndGet();
          }
        }
      });
    }
    return totalReplicasOfInterest.get();
  }

