  public TupStream(StreamExpression expression, StreamFactory factory) throws IOException {

    List<StreamExpressionNamedParameter> namedParams = factory.getNamedOperands(expression);
    //Get all the named params
    for(StreamExpressionParameter np : namedParams) {
      String name = ((StreamExpressionNamedParameter)np).getName();
      StreamExpressionParameter param = ((StreamExpressionNamedParameter)np).getParameter();

      if(param instanceof StreamExpressionValue) {
        tupleParams.put(name, ((StreamExpressionValue)param).getValue());
      } else {
        if (factory.isEvaluator((StreamExpression) param)) {
          StreamEvaluator evaluator = factory.constructEvaluator((StreamExpression) param);
          tupleParams.put(name, evaluator);
        } else {
          TupleStream tupleStream = factory.constructStream((StreamExpression) param);
          tupleParams.put(name, tupleStream);
        }
      }
    }
  }

