  ResultSetImpl(StatementImpl statement) {
    this.statement = statement;
    this.solrStream = statement.getSolrStream();

    // Read the first tuple so that metadata can be gathered
    try {
      this.metadataTuple = this.solrStream.read();

      Object isMetadata = this.metadataTuple.get("isMetadata");
      if(isMetadata == null || !isMetadata.equals(true)) {
        throw new RuntimeException("First tuple is not a metadata tuple");
      }
    } catch (IOException e) {
      throw new RuntimeException("Couldn't get metadata tuple");
    }

    this.resultSetMetaData = new ResultSetMetaDataImpl(this);
  }

