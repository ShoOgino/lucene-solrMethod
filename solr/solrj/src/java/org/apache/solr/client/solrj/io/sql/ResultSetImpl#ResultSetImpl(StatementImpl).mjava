  ResultSetImpl(StatementImpl statement) {
    this.statement = statement;
    this.solrStream = new PushBackStream(statement.getSolrStream());

    // Read the first tuple so that metadata can be gathered
    try {
      this.metadataTuple = this.solrStream.read();

      Object isMetadata = this.metadataTuple.get("isMetadata");
      if(isMetadata == null || !isMetadata.equals(true)) {
        throw new RuntimeException("First tuple is not a metadata tuple");
      }

      this.firstTuple = this.solrStream.read();
      this.solrStream.pushBack(firstTuple);
    } catch (IOException e) {
      throw new RuntimeException("Couldn't read first tuple", e);
    }

    this.resultSetMetaData = new ResultSetMetaDataImpl(this);
  }

