  private void addReplicaCountsForNode(ComputedValueEvaluator computedValueEvaluator, ReplicaCount replicaCount, Row node) {
    addReplicaCountsForNode++;

    ReplicaCount rc = node.computeCacheIfAbsent(computedValueEvaluator.collName, computedValueEvaluator.shardName, PERSHARD_REPLICAS,
        this, o -> {
          addReplicaCountsForNodeCacheMiss++;
          ReplicaCount result = new ReplicaCount();
          node.forEachReplica((String) collection.getValue(), ri -> {
            if (Policy.ANY.equals(computedValueEvaluator.shardName)
                || computedValueEvaluator.shardName.equals(ri.getShard()))
              result.increment(ri);
          });
          return result;
        });
    if (rc != null)
      replicaCount.increment(rc);


  }

