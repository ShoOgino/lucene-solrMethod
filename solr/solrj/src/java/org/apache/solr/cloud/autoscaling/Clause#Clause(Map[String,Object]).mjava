  Clause(Map<String, Object> m) {
    this.original = m;
    collection = parse(COLLECTION, m);
    shard = parse(SHARD, m);
    this.replica = parse(REPLICA, m);
    strict = Boolean.parseBoolean(String.valueOf(m.getOrDefault("strict", "true")));
    m.forEach((s, o) -> parseCondition(s, o));
    if (tag == null)
      throw new RuntimeException("Invalid op, must have one and only one tag other than collection, shard,replica " + Utils.toJSONString(m));
  }

