    void addReplicaToList(Row r, boolean isSource, List<Pair<Policy.ReplicaInfo, Row>> replicaList) {
      if (!isAllowed(r.node, isSource ? Hint.SRC_NODE : Hint.TARGET_NODE)) return;
      for (Map.Entry<String, Map<String, List<Policy.ReplicaInfo>>> e : r.collectionVsShardVsReplicas.entrySet()) {
        if (!isAllowed(e.getKey(), Hint.COLL)) continue;
        for (Map.Entry<String, List<Policy.ReplicaInfo>> shard : e.getValue().entrySet()) {
          if (!isAllowed(e.getKey(), Hint.SHARD)) continue;
          replicaList.add(new Pair<>(shard.getValue().get(0), r));
        }
      }
    }

