  Pair<Row, ReplicaInfo> removeReplica(String coll, String shard, Replica.Type type) {
    Row row = copy();
    Map<String, List<ReplicaInfo>> c = row.collectionVsShardVsReplicas.get(coll);
    if (c == null) return null;
    List<ReplicaInfo> r = c.get(shard);
    if (r == null) return null;
    int idx = -1;
    for (int i = 0; i < r.size(); i++) {
      ReplicaInfo info = r.get(i);
      if (type == null || info.type == type) {
        idx = i;
        break;
      }
    }
    if(idx == -1) return null;

    for (Cell cell : row.cells) {
      if (cell.name.equals("cores")) {
        cell.val = cell.val == null ? 0 : ((Number) cell.val).longValue() - 1;
      }
    }
    return new Pair(row, r.remove(idx));

  }

