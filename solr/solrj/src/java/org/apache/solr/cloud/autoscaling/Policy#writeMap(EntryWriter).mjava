  @Override
  public void writeMap(EntryWriter ew) throws IOException {
    if (!clauses.isEmpty()) {
      ew.put("conditions", (IteratorWriter) iw -> {
        for (Clause clause : clauses) iw.add(clause);
      });
    }
    if (!preferences.isEmpty()) {
      ew.put("preferences", (IteratorWriter) iw -> {
        for (Preference p : preferences) iw.add(p);
      });
    }

  }

