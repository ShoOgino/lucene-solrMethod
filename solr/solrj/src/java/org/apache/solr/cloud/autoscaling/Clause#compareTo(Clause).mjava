  @Override
  public int compareTo(Clause that) {
    try {
      int v = Integer.compare(this.tag.op.priority, that.tag.op.priority);
      if (v != 0) return v;
      if (this.isPerCollectiontag() && that.isPerCollectiontag()) {
        v = Integer.compare(this.replica.op.priority, that.replica.op.priority);
        if (v == 0) {
          v = Long.compare((Long) this.replica.val, (Long) that.replica.val);
          v = this.replica.op == LESS_THAN ? v : v * -1;
        }
        return v;
      } else {
        return 0;
      }
    } catch (NullPointerException e) {
      throw e;
    }
  }

