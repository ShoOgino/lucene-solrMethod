  @Override
  public int compareTo(Clause that) {
    try {
      int v = Integer.compare(this.tag.op.priority, that.tag.op.priority);
      if (v != 0) return v;
      return this.isPerCollectiontag() && that.isPerCollectiontag() ?
          Integer.compare(this.replica.op.priority, that.replica.op.priority) :
          0;
    } catch (NullPointerException e) {
      System.out.println("this: " + Utils.toJSONString(this));
      System.out.println("thAt: " + Utils.toJSONString(that));
      throw e;
    }
  }

