  public void write(byte b) throws IOException {
    if (pos >= buf.length) {
      flush(buf, 0, buf.length);
      written += pos;
      pos=0;
    }
    buf[pos++] = b;
  }

