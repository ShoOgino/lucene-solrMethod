  /**
   * works up to 65537 before requested num of ranges is one short
   * 
   * @param partitions
   * @return
   */
  public List<Range> partitionRange(int partitions) {
    // some hokey code to partition the int space
    long range = Integer.MAX_VALUE + (Math.abs((long) Integer.MIN_VALUE));
    long srange = range / partitions;
    
    List<Range> ranges = new ArrayList<Range>(partitions);
    
    long end = 0;
    long start = Integer.MIN_VALUE;
    
    while (end < Integer.MAX_VALUE) {
      end = start + srange;
      ranges.add(new Range(start, end));
      start = end + 1L;
    }
    
    return ranges;
  }

