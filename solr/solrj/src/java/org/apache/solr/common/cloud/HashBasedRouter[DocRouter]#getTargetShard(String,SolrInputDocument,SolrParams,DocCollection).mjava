  @Override
  public Slice getTargetShard(String id, SolrInputDocument sdoc, SolrParams params, DocCollection collection) {
    if (id == null) id = getId(sdoc, params);
    int hash = shardHash(id, sdoc, params);
    return hashToSlice(hash, collection);
  }

