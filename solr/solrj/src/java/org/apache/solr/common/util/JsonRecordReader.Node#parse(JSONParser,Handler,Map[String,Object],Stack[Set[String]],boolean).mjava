    private void parse(JSONParser parser,
                       Handler handler,
                       Map<String, Object> values,
                       Stack<Set<String>> stack, // lists of values to purge
                       boolean recordStarted) throws IOException {

      int event = -1;
      for (; ; ) {
        event = parser.nextEvent();
        if (event == EOF) break;
        if (event == OBJECT_START) {
          handleObjectStart(parser, new HashSet<Node>(), handler, values, stack, recordStarted, null);
        } else if (event == ARRAY_START) {
          for (; ; ) {
            event = parser.nextEvent();
            if (event == ARRAY_END) break;
            if (event == OBJECT_START) {
              handleObjectStart(parser, new HashSet<Node>(), handler, values, stack, recordStarted, null);
            }
          }
        }
      }

    }

