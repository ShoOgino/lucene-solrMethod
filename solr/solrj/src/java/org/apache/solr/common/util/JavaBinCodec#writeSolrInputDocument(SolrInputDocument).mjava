  public void writeSolrInputDocument(SolrInputDocument sdoc) throws IOException {
    writeTag(SOLRINPUTDOC, sdoc.size());
    writeFloat(sdoc.getDocumentBoost());
    for (SolrInputField inputField : sdoc.values()) {
      if (inputField.getBoost() != 1.0f) {
        writeFloat(inputField.getBoost());
      }
      writeExternString(inputField.getName());
      writeVal(inputField.getValue());
    }
  }

