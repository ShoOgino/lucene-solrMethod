    @Override
    public void run() {
      List<CollectionStateWatcher> watchers = new ArrayList<>();
      collectionWatches.compute(collection, (k, v) -> {
        if (v == null)
          return null;
        watchers.addAll(v.stateWatchers);
        v.stateWatchers.clear();
        return v;
      });
      for (CollectionStateWatcher watcher : watchers) {
        watcher.onStateChanged(liveNodes, collectionState);
      }
    }

