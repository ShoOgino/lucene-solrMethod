  /**
   * Check that all shards in a collection have a leader
   */
  public static boolean isUpdateable(Set<String> liveNodes, DocCollection collectionState, int expectedShards) {
    int updateableShards = 0;
    for (Slice slice : collectionState) {
      Replica leader = slice.getLeader();
      if (leader != null && leader.isActive(liveNodes))
        updateableShards++;
    }
    return updateableShards == expectedShards;
  }

