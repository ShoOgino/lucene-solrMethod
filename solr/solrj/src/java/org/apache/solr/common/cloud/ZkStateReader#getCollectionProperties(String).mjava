  /**
   * Get collection properties for a given collection. If the collection is watched, simply return it from the cache,
   * otherwise fetch it directly from zookeeper.
   */
  public Map<String, String> getCollectionProperties(final String collection) {
    synchronized (watchedCollectionProps) { // making decisions based on the result of a get...
      VersionedCollectionProps vprops = watchedCollectionProps.get(collection);
      Map<String, String> properties = vprops != null ? vprops.props : null;
      if (properties == null) {
        try {
          // todo: maybe we want to store/watch since if someone's calling this it's probably going to get called again?
          // Not storing the value in watchedCollectionProps, because it can gat stale, since we have no watcher set.
          properties = fetchCollectionProperties(collection, null ).props;
        } catch (Exception e) {
          throw new SolrException(ErrorCode.SERVER_ERROR, "Error reading collection properties", SolrZkClient.checkInterrupted(e));
        }
      }
      return properties;
    }
  }

