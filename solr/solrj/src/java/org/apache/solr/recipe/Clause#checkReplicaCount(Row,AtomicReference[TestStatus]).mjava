  TestStatus checkReplicaCount(Row row, AtomicReference<TestStatus> result) {
    row.replicaInfo.forEach((coll, e) -> {
      if (!collection.isMatch(coll)) return;
      AtomicInteger count = new AtomicInteger();
      e.forEach((sh, replicas) -> {
        if (!shard.isMatch(sh)) return;
        count.addAndGet(replicas.size());
      });
      result.set(replica.isMatch(count) ? TestStatus.PASS : TestStatus.FAIL);
      if (RuleSorter.EACH.equals(shard.val)) count.set(0);
    });
    return TestStatus.PASS;
  }

