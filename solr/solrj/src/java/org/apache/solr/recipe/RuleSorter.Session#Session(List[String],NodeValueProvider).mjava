    Session(List<String> nodes, NodeValueProvider snitch) {
      this.nodes = nodes;
      this.snitch = snitch;
      matrix = new ArrayList<>(nodes.size());
      for (String node : nodes) matrix.add(new Row(node, params, snitch));
      for (Row row : matrix) row.replicaInfo.forEach((s, e) -> collections.add(s));
    }

