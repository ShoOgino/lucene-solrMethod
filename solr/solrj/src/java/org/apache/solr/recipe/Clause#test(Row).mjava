  TestStatus test(Row row) {
    AtomicReference<TestStatus> result = new AtomicReference<>(TestStatus.NOT_APPLICABLE);
    Object val = row.getVal(tag.name);
    if (tag.isMatch(val)) {
      checkReplicaCount(row, result);
      if (result.get() == TestStatus.FAIL) row.violations.add(this);
    }
    return result.get();
  }

