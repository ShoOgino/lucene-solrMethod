  Clause(Map<String, Object> m) {
    this.original = m;
    collection = new Condition(COLLECTION, m.containsKey(COLLECTION) ? (String) m.get(COLLECTION) : ANY, EQUAL);
    shard = new Condition(SHARD, m.containsKey(SHARD) ? (String) m.get(SHARD) : ANY, EQUAL);
    String replica = m.containsKey(REPLICA) ? String.valueOf(m.get(REPLICA)) : ANY;
    this.replica = parse(REPLICA, replica);
    strict = Boolean.parseBoolean(String.valueOf(m.getOrDefault("strict", "true")));
    m.forEach(this::parseCondition);
    if (tag == null)
      throw new RuntimeException("Invalid op, must have one and only one tag other than collection, shard,replica " + Utils.toJSONString(m));
  }

