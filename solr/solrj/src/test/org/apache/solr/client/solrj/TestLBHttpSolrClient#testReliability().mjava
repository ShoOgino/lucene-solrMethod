  public void testReliability() throws Exception {
    String[] s = new String[solr.length];
    for (int i = 0; i < solr.length; i++) {
      s[i] = solr[i].getUrl();
    }
    ModifiableSolrParams params = new ModifiableSolrParams();
    params.set(HttpClientUtil.PROP_CONNECTION_TIMEOUT, 250);
    params.set(HttpClientUtil.PROP_SO_TIMEOUT, 250);
    CloseableHttpClient myHttpClient = HttpClientUtil.createClient(params);
    try {
      LBHttpSolrClient client = new LBHttpSolrClient(myHttpClient, s);
      client.setAliveCheckInterval(500);
  
      // Kill a server and test again
      solr[1].jetty.stop();
      solr[1].jetty = null;
  
      // query the servers
      for (String value : s)
        client.query(new SolrQuery("*:*"));
  
      // Start the killed server once again
      solr[1].startJetty();
      // Wait for the alive check to complete
      waitForServer(30000, client, 3, "solr1");
    } finally {
      myHttpClient.close();
    }
  }

