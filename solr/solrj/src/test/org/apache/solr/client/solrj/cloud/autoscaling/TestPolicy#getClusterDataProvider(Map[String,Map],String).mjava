  private ClusterDataProvider getClusterDataProvider(final Map<String, Map> nodeValues, String clusterState) {
    return new DelegatingClusterDataProvider(null) {
      @Override
      public Map<String, Object> getNodeValues(String node, Collection<String> tags) {
        Map<String, Object> result = new LinkedHashMap<>();
        tags.stream().forEach(s -> result.put(s, nodeValues.get(node).get(s)));
        return result;
      }

      @Override
      public Collection<String> getLiveNodes() {
        return nodeValues.keySet();
      }

      @Override
      public String getPolicyNameByCollection(String coll) {
        return null;
      }

      @Override
      public Map<String, Map<String, List<ReplicaInfo>>> getReplicaInfo(String node, Collection<String> keys) {
        return getReplicaDetails(node, clusterState);
      }

    };
  }

