  @SuppressWarnings({"unchecked"})
  public void testAddTooManyPerPolicy() {
    Map<String, Object> m = (Map<String, Object>) loadFromResource("testAddTooManyPerPolicy.json");
    SolrCloudManager cloudManagerFromDiagnostics = createCloudManagerFromDiagnostics(m);
    AutoScalingConfig autoScalingConfig = new AutoScalingConfig((Map<String, Object>) getObjectByPath(m, false, "diagnostics/config"));
    SolrException exp =  expectThrows(SolrException.class, () -> PolicyHelper.getReplicaLocations("TooManyPerPolicy", autoScalingConfig, cloudManagerFromDiagnostics,
            EMPTY_MAP, Collections.singletonList("shard1"), 1, 0, 0, null));
    assertTrue(exp.getMessage().contains("No node can satisfy the rules"));

  }

