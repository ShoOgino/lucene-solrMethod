  @Test
  public void testInvalidValues() throws Exception {
    StreamEvaluator evaluator = factory.constructEvaluator("year(a)");

    try {
      values.clear();
      values.put("a", 12);
      Object result = evaluator.evaluate(new Tuple(values));
      assertTrue(false);
    } catch (Exception e) {
      assertEquals("Invalid field a - The field must be a string formatted in the ISO_INSTANT date format.", e.getMessage());
    }

    try {
      values.clear();
      values.put("a", "1995-12-31");
      Object result = evaluator.evaluate(new Tuple(values));
      assertTrue(false);
    } catch (Exception e) {
      assertEquals("Invalid field a - The field must be a string formatted in the ISO_INSTANT date format.", e.getMessage());
    }

    values.clear();
    values.put("a", null);
    assertNull(evaluator.evaluate(new Tuple(values)));
  }

