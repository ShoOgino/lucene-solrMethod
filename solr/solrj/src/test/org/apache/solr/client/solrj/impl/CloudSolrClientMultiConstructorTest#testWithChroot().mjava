  @Test
  public void testWithChroot() {
    boolean setOrList = random().nextBoolean();
    int numOfZKServers = TestUtil.nextInt(random(), 1, 5);
    boolean withChroot = random().nextBoolean();

    final String chroot = "/mychroot";

    StringBuilder sb = new StringBuilder();
    CloudSolrClient client;

    if(setOrList) {
      /*
        A LinkedHashSet is required here for testing, or we can't guarantee
        the order of entries in the final string.
       */
      hosts = new LinkedHashSet<>();
    } else {
      hosts = new ArrayList<>();
    }

    for(int i=0; i<numOfZKServers; i++) {
      String ZKString = "host" + i + ":2181";
      hosts.add(ZKString);
      sb.append(ZKString);
      if(i<numOfZKServers -1) sb.append(",");
    }

    if(withChroot) {
      sb.append(chroot);
      client = new CloudSolrClient(hosts, "/mychroot");
    } else {
      client = new CloudSolrClient(hosts, null);
    }

    assertEquals(sb.toString(), client.getZkHost());
    client.shutdown();
  }

