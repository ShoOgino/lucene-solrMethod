  /**
   * Returns the total number of tlogs that have been created for the core.
   *
   * The tlogs in a core's tlog directory are named: tlog.0000000000000000000, tlog.0000000000000000001, tlog.0000000000000000002, etc.
   * Because old tlogs are periodically deleted, we can't just count the number of existing files. Instead, we take the
   * highest ordering tlog file name (which would be the newest) and parse the extension.
   *
   * e.g if the most recently created tlog file is tlog.0000000000000000003, we know that this core has had 4 tlogs.
   *
   * @param tlogsInfo TreeMap of (tlog file name, tlog file size (in bytes)) pairs
   * @return total number of tlogs created for this core
   */
  private int parseTotalNumTlogs(TreeMap<String, Long> tlogsInfo) {
    String mostRecentFileName = tlogsInfo.lastKey();
    int extensionDelimiterIndex = mostRecentFileName.lastIndexOf(".");
    if (extensionDelimiterIndex == -1) {
      throw new RuntimeException("Invalid tlog filename: " + mostRecentFileName);
    }
    String extension = mostRecentFileName.substring(extensionDelimiterIndex + 1);
    try {
      return Integer.parseInt(extension) + 1;
    } catch (NumberFormatException e) {
      throw new RuntimeException("Could not parse tlog filename: " + mostRecentFileName, e);
    }
  }

