  // used to verify a core has been deleted (count = 0)
  private void waitCoreCount(String collection, int count) {
    long start = System.nanoTime();
    CoreContainer coreContainer = cluster.getRandomJetty(random()).getCoreContainer();
    int coreFooCount;
    do {
      coreFooCount = 0;
      List<CoreDescriptor> coreDescriptors = coreContainer.getCoreDescriptors();
      for (CoreDescriptor coreDescriptor : coreDescriptors) {
        String collectionName = coreDescriptor.getCollectionName();
        if (collection.equals(collectionName)) {
          coreFooCount ++;
        }
      }
      if (NANOSECONDS.toSeconds(System.nanoTime() - start) > 10) {
        fail("took over 10 seconds after collection creation to update aliases");
      } else {
        try {
          Thread.sleep(500);
        } catch (InterruptedException e) {
          e.printStackTrace();
          fail(e.getMessage());
        }
      }

    } while(coreFooCount != count);
  }

