  /**
   * Executes the given query
   * @param query the query to execute
   * @return the number of documents found
   */
  public int queryCore(SolrQueryRequest query) throws Exception {
    String responseStr = h.query(query);
    try {
      Map<String, Object> root = (Map<String, Object>) objectMapper.readValue(responseStr, Object.class);
      Map<String, Object> rootResponse = (Map<String, Object>) root.get("response");
      return (int) rootResponse.get("numFound");
    } catch (Exception e) {
      throw new RuntimeException("Unable to parse Solr query response", e);
    }
  }

