  /**
   * Goes through the given tlog directory and inspects each tlog. Asserts that each tlog's size is <= the given max size bound.
   * @param tlogDirPath tlog directory path
   * @param maxSizeBound the max tlog size
   * @return a TreeMap of (tlog file name, tlog file size (in bytes)) pairs
   */
  private TreeMap<String, Long> getTlogFileSizes(String tlogDirPath, int maxSizeBound) {
    File tlogDir = new File(tlogDirPath);
    File[] tlogs = tlogDir.listFiles();
    TreeMap<String, Long> tlogInfo = new TreeMap<>();
    if (tlogs != null) {
      for (File tlog : tlogs) {
        String message = String.format(Locale.getDefault(), "Tlog size exceeds the max size bound. Tlog path: %s, tlog size: %d",
            tlog.getPath(), tlog.length());
        Assert.assertTrue(message, tlog.length() <= maxSizeBound);
        tlogInfo.put(tlog.getName(), tlog.length());
      }
    }
    return tlogInfo;
  }

