  private int addDoc(RandomIndexWriter writer, Document doc) throws IOException {
    writer.addDocument(doc);
    return writer.getDocStats().numDocs - 1;
  }

