  @Before
  public void setup() throws Exception {
    objectMapper = new ObjectMapper();
    System.setProperty("solr.autoCommit.maxSize", "5k");
    System.setProperty("solr.ulog", "solr.UpdateLog");
    initCore("solrconfig-tlog.xml", "schema.xml");
    core = h.getCore();
    updateHandler = (DirectUpdateHandler2) core.getUpdateHandler();
    hardCommitTracker = updateHandler.commitTracker;
    // Only testing file-size based auto hard commits - disable other checks
    hardCommitTracker.setTimeUpperBound(-1);
    hardCommitTracker.setDocsUpperBound(-1);
    updateRequestHandler = new UpdateRequestHandler();
    updateRequestHandler.init( null );
    tlogDirPath = core.getDataDir() + "/tlog";
  }

