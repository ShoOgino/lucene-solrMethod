  @Override
  public void run() {
    verbose(String.format(Locale.ROOT, "Starting query thread: " + getId()));
    String core = OCCST.getRandomCore();
    int repeated = 0;
    while (Queries._keepon.get()) {
      core = OCCST.getRandomCore();
      for (int idx = 0; idx < 3; ++idx) {
        ModifiableSolrParams params = new ModifiableSolrParams();
        params.set("qt", "/select");
        params.set("q", "*:*");

        QueryResponse response = new QueryResponse(); // so we can use toString below with impunity
        try {
          // sleep between 250ms and 10000 ms
          Thread.sleep(100L); // Let's not go crazy here.
          server.setBaseURL(baseUrl + core);
          response = server.query(params);
          // Perhaps collect some stats here in future.
          break; // retry loop
        } catch (Exception e) {
          if (e instanceof InterruptedException) return;
          Queries._errors.incrementAndGet();
          if (idx == 2) {
            fail("Could not reach server while indexing for three tries, quitting " + e.getMessage() + " " + response.toString());
          } else {
            verbose("Querying thread: " + Thread.currentThread().getId() + " swallowed exception: " + e.getMessage() + " " + response.toString());
            try {
              Thread.sleep(500L);
            } catch (InterruptedException tex) {
              return;
            }
          }
        }
      }
    }
    verbose(String.format(Locale.ROOT, "Leaving query thread: " + getId()));
  }

