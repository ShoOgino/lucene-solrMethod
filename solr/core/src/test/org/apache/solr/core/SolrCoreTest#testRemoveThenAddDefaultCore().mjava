  @Test
  public void testRemoveThenAddDefaultCore() throws Exception {
    final CoreContainer cores = h.getCoreContainer();
    SolrCore core = cores.getCore("");

    assertEquals(COLLECTION1, cores.getDefaultCoreName());
    
    cores.unload("");
    core.close();

    CoreDescriptor cd = new CoreDescriptor(cores, COLLECTION1, "collection1",
                                            CoreDescriptor.CORE_DATADIR, createTempDir("dataDir2").toFile().getAbsolutePath());
    
    cores.create(cd);
    
    assertEquals(COLLECTION1, cores.getDefaultCoreName());
    
    // so we should be able to get a core with collection1
    core = cores.getCore(COLLECTION1);
    assertNotNull(core);
    core.close();
    
    // and with ""
    core = cores.getCore("");
    assertNotNull(core);
    
    core.close();
  }

