  private Set<Object> getCoreCacheKeys() {
    RefCounted<SolrIndexSearcher> searcher = h.getCore().getSearcher();
    Set<Object> set = Collections.newSetFromMap(new IdentityHashMap<Object,Boolean>());
    try {
      DirectoryReader ir = searcher.get().getRawReader();
      for (LeafReaderContext context : ir.leaves()) {
        set.add(context.reader().getCoreCacheHelper().getKey());
      }
    } finally {
      searcher.decref();
    }
    return set;
  }

