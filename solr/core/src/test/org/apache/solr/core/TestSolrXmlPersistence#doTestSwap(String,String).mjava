  private void doTestSwap(String from, String to) throws Exception {
    CoreContainer cc = init(SOLR_XML_LOTS_SYSVARS, "SystemVars1", "SystemVars2");
    try {
      final CoreAdminHandler admin = new CoreAdminHandler(cc);
      SolrQueryResponse resp = new SolrQueryResponse();
      admin.handleRequestBody
          (req(CoreAdminParams.ACTION,
              CoreAdminParams.CoreAdminAction.SWAP.toString(),
              CoreAdminParams.CORE, from,
              CoreAdminParams.OTHER, to),
              resp);
      assertNull("Exception on swap", resp.getException());

      String[] persistList = getAllNodes();
      String[] expressions = new String[persistList.length];

      // Now manually change the names back and it should match exactly to the original XML.
      for (int idx = 0; idx < persistList.length; ++idx) {
        String fromName = "@name='" + from + "'";
        String toName = "@name='" + to + "'";
        if (persistList[idx].contains(fromName)) {
          expressions[idx] = persistList[idx].replace(fromName, toName);
        } else {
          expressions[idx] = persistList[idx].replace(toName, fromName);
        }
      }

      //assertXmlFile(origXml, expressions);
      TestHarness.validateXPath(SOLR_XML_LOTS_SYSVARS, expressions);

    } finally {
      cc.shutdown();
      if (solrHomeDirectory.exists()) {
        FileUtils.deleteDirectory(solrHomeDirectory);
      }
    }
  }

