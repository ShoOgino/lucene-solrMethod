  // Test the basic setup, create some dirs with core.properties files in them, but no solr.xml (a solr.properties
  // instead) and insure that we find all the cores and can load them.
  @Test
  public void testPropertiesFile() throws Exception {
    setMeUp();
    addSolrPropertiesFile();
    // name, isLazy, loadOnStartup
    addCoreWithProps(makeCorePropFile("core1", false, true));
    addCoreWithProps(makeCorePropFile("core2", false, false));

    // I suspect what we're adding in here is a "configset" rather than a schema or solrconfig.
    //
    addCoreWithProps(makeCorePropFile("lazy1", true, false));

    CoreContainer cc = init();
    try {
      Properties props = cc.containerProperties;

      assertEquals("/admin/cores/props", props.getProperty("cores.adminPath"));
      assertEquals("/admin/cores/props", cc.getAdminPath());
      assertEquals("defcore", props.getProperty("cores.defaultCoreName"));
      assertEquals("defcore", cc.getDefaultCoreName());
      assertEquals("222.333.444.555", props.getProperty("host"));
      assertEquals("6000", props.getProperty("port")); // getProperty actually looks at original props.
      assertEquals("/solrprop", props.getProperty("cores.hostContext"));
      assertEquals("20", props.getProperty("cores.zkClientTimeout"));

      TestLazyCores.checkInCores(cc, "core1");
      TestLazyCores.checkNotInCores(cc, "lazy1", "core2", "collection1");

      SolrCore core1 = cc.getCore("core1");

      // Let's assert we did the right thing for implicit properties too.
      CoreDescriptor desc = core1.getCoreDescriptor();
      assertEquals("core1", desc.getProperty("solr.core.name"));

      // This is too long and ugly to put in. Besides, it varies.
      assertNotNull(desc.getProperty("solr.core.instanceDir"));

      assertEquals("stuffandnonsense", desc.getProperty("solr.core.dataDir"));
      assertEquals("solrconfig-minimal.xml", desc.getProperty("solr.core.configName"));
      assertEquals("schema-tiny.xml", desc.getProperty("solr.core.schemaName"));

      SolrCore core2 = cc.getCore("core2");
      SolrCore lazy1 = cc.getCore("lazy1");
      TestLazyCores.checkInCores(cc, "core1", "core2", "lazy1");
      core1.close();
      core2.close();
      lazy1.close();

    } finally {
      cc.shutdown();
    }
  }

