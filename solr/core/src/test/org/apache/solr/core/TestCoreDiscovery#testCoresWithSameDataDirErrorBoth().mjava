  @Test
  public void testCoresWithSameDataDirErrorBoth() throws Exception{
    setMeUp();
    addSolrXml();
    addCoreWithProps(makeCorePropFile("core1", false, false, "dataDir=" + solrHomeDirectory + "datadir"));
    addCoreWithProps(makeCorePropFile("core2", true,  false, "dataDir=" + solrHomeDirectory + "datadir"));
    // Should just blow up here.
    CoreContainer cc = null;
    try {
      cc = init();
    } catch (SolrException se) {
      assertEquals("Should be returning proper error code of 500", 500, se.code());
      assertTrue(se.getCause().getMessage().indexOf("More than one core points to data dir") != -1);
    } finally {
      if (cc != null) {
        cc.shutdown();
      }
    }
  }

