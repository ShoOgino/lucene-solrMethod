  @Test
  public void testSolrHomeNotReadable() throws Exception {
    File homeDir = solrHomeDirectory;
    setMeUp(homeDir.getAbsolutePath());
    addCoreWithProps(makeCorePropFile("core1", false, true),
        new File(homeDir, "core1" + File.separator + CorePropertiesLocator.PROPERTIES_FILENAME));

    assumeTrue("Cannot make " + homeDir + " non-readable. Test aborted.", homeDir.setReadable(false, false));
    assumeFalse("Appears we are a super user, skip test", homeDir.canRead());
    CoreContainer cc = null;
    try {
      cc = init();
      fail("Should have thrown an exception here");
    } catch (Exception ex) {
      assertThat(ex.getMessage(), containsString("Error reading core root directory"));
    } finally {
      if (cc != null) {
        cc.shutdown();
      }
    }
    // So things can be cleaned up by the framework!
    homeDir.setReadable(true, false);

  }

