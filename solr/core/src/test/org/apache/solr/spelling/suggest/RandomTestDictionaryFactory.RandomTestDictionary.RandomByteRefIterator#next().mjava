      @Override
      public BytesRef next() throws IOException {
        BytesRef next = null;
        if (System.getProperty(enabledSysProp) != null) {
          if (emittedItems < maxItems) {
            ++emittedItems;
            next = new BytesRef(TestUtil.randomUnicodeString(LuceneTestCase.random(), MAX_LENGTH));
            if (emittedItems % 1000 == 0) {
              log.info(enabledSysProp + " emitted " + emittedItems + " items.");
            }
          } else {
            log.info(enabledSysProp + " disabled after emitting " + emittedItems + " items.");
            System.clearProperty(enabledSysProp); // disable once maxItems has been reached
            emittedItems = 0L;
          }
        } else {
          log.warn(enabledSysProp + " invoked when disabled");
          emittedItems = 0L;
        }
        return next;
      }

