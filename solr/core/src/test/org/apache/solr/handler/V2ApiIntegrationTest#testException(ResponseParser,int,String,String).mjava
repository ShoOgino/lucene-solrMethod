  private void testException(ResponseParser responseParser, int expectedCode, String path, String payload) throws IOException, SolrServerException {
    V2Request v2Request = new V2Request.Builder(path)
        .withMethod(SolrRequest.METHOD.POST)
        .withPayload(payload)
        .build();
    v2Request.setResponseParser(responseParser);
    try {
      v2Request.process(cluster.getSolrClient());
      fail("expected an exception with error code: "+expectedCode);
    } catch (HttpSolrClient.RemoteExecutionException e) {
      assertEquals(expectedCode, e.code());

    }
  }

