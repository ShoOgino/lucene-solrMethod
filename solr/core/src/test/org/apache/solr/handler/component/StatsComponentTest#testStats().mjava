  public void testStats() throws Exception {
    for (String f : new String[] {
            "stats_i","stats_l","stats_f","stats_d",
            "stats_ti","stats_tl","stats_tf","stats_td",
            "stats_ti_dv","stats_tl_dv","stats_tf_dv","stats_td_dv"
//            , TODO: enable this test after SOLR-6452 is fixed
//            "stats_ti_ni_dv","stats_tl_ni_dv","stats_tf_ni_dv","stats_td_ni_dv"
    }) {
      doTestFieldStatisticsResult(f);
      doTestFieldStatisticsMissingResult(f);
      doTestFacetStatisticsResult(f);
      doTestFacetStatisticsMissingResult(f);
      clearIndex();
      assertU(commit());
    }

    for (String f : new String[] {"stats_ii",
            "stats_tis","stats_tfs","stats_tls","stats_tds",  // trie fields
            "stats_tis_dv","stats_tfs_dv","stats_tls_dv","stats_tds_dv"  // Doc Values
//          , TODO: enable this test after SOLR-6452 is fixed
            //"stats_tis_ni_dv","stats_tfs_ni_dv","stats_tls_ni_dv","stats_tds_ni_dv"  // Doc Values Not indexed
                                  }) {
      doTestMVFieldStatisticsResult(f);
      clearIndex();
      assertU(commit());
    }
    
  }

