  @Test
  public void testBasic() throws Exception {
    timeSource.sleep(10000);
    List<Pair<String, Long>> list = handler.getFactory().list(100);
    // solr.jvm, solr.node, solr.collection..system
    assertEquals(list.toString(), 3, list.size());
    for (Pair<String, Long> p : list) {
      RrdDb db = new RrdDb(MetricsHistoryHandler.URI_PREFIX + p.first(), true, handler.getFactory());
      int dsCount = db.getDsCount();
      int arcCount = db.getArcCount();
      assertTrue("dsCount should be > 0, was " + dsCount, dsCount > 0);
      assertEquals("arcCount", 5, arcCount);
      db.close();
    }
  }

