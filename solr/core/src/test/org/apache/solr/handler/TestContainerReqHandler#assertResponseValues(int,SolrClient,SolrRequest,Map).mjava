  static void assertResponseValues(int repeats, SolrClient client, SolrRequest req, Map vals) throws Exception {
    for (int i = 0; i < repeats; i++) {
      if (i > 0) {
        Thread.sleep(100);
      }
      try {
        SolrResponse rsp = req.process(client);
        try {
          for (Object e : vals.entrySet()) {
            Map.Entry entry = (Map.Entry) e;
            String key = (String) entry.getKey();
            Object val = entry.getValue();
            Predicate p = val instanceof Predicate ? (Predicate) val : o -> {
              String v = o == null ? null : String.valueOf(o);
              return Objects.equals(val, o);
            };
            assertTrue("attempt: " + i + " Mismatch for value : '" + key + "' in response " + Utils.toJSONString(rsp),
                p.test(rsp.getResponse()._get(key, null)));

          }
          return;
        } catch (Exception e) {
          if (i >= repeats - 1) throw e;
          continue;
        }

      } catch (Exception e) {
        if (i >= repeats - 1) throw e;
        continue;
      }
    }


  }

