  @SuppressWarnings("unchecked")
  private static String extractShardAddresses(final QueryResponse queryResponse, final String delimiter) {
    final StringBuilder sb = new StringBuilder();
    final NamedList<Object> nl = (NamedList<Object>)queryResponse.getResponse().get("shards.info");
    assertNotNull(queryResponse.toString(), nl);
    for (int ii = 0; ii < nl.size(); ++ii) {
      final String shardAddress = (String)((NamedList<Object>)nl.getVal(ii)).get("shardAddress");
      if (sb.length() > 0) {
        sb.append(delimiter);
      }
      sb.append(shardAddress);
    }
    return sb.toString();
  }

