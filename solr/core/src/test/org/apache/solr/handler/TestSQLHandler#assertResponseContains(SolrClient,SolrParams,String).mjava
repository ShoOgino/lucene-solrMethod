  public void assertResponseContains(SolrClient server, SolrParams requestParams, String json)
      throws IOException, SolrServerException {
    String p = requestParams.get("qt");
    ModifiableSolrParams modifiableSolrParams = (ModifiableSolrParams) requestParams;
    modifiableSolrParams.set("indent", modifiableSolrParams.get("indent", "off"));
    if (p != null) {
      modifiableSolrParams.remove("qt");
    }

    QueryRequest query = new QueryRequest(modifiableSolrParams);
    query.setPath(p);
    query.setResponseParser(new InputStreamResponseParser("json"));
    query.setMethod(SolrRequest.METHOD.POST);
    NamedList<Object> genericResponse = server.request(query);
    InputStream stream = (InputStream) genericResponse.get("stream");
    InputStreamReader reader = new InputStreamReader(stream, "UTF-8");
    BufferedReader bufferedReader = new BufferedReader(reader);
    String response = bufferedReader.readLine();
    assertTrue(response.contains(json));
  }

