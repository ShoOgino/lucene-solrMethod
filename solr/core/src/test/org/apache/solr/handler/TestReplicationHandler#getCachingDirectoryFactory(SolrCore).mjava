  private CachingDirectoryFactory getCachingDirectoryFactory(SolrCore core) {
    DirectoryFactory df = core.getDirectoryFactory();
    if (df instanceof MetricsDirectoryFactory) {
      return (CachingDirectoryFactory)((MetricsDirectoryFactory)df).getDelegate();
    } else {
      return (CachingDirectoryFactory)df;
    }
  }

