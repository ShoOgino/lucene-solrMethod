  @SuppressWarnings("unchecked")
  private void ensureRidPresent(ResponseBuilder rb, String expectedRid) {
    SolrQueryRequest req = rb.req;
    SolrQueryResponse resp = rb.rsp;
    //a generated request ID should be added to the request
    String rid = req.getParams().get(CommonParams.REQUEST_ID);
    if(expectedRid == null) {
      assertTrue(rid + " Doesn't match expected pattern.", Pattern.matches(".*-collection1-[0-9]*-[0-9]+", rid));
    } else {
      assertEquals("Expecting " + expectedRid + " but found " + rid, expectedRid, rid);
    }
    //The request ID is added to the debug/track section
    assertEquals(rid, ((NamedList<Object>)rb.getDebugInfo().get("track")).get(CommonParams.REQUEST_ID));
    //RID must be added to the toLog, so that it's included in the main request log
    assertEquals(rid, resp.getToLog().get(CommonParams.REQUEST_ID));
  }

