  private SolrDocumentList queryAndAssertDocs(ModifiableSolrParams query, SolrClient client, int expected) throws Exception {
    QueryResponse rsp = client.query(query);
    SolrDocumentList docs = rsp.getResults();
    if (docs.size() != expected) {
      log.info("History query: {}", query);
      log.info("Wrong response: {}", rsp);
      ModifiableSolrParams fullQuery = params(CommonParams.QT, CommonParams.AUTOSCALING_HISTORY_PATH);
      if (log.isInfoEnabled()) {
        log.info("Full response: {}", client.query(fullQuery));
      }
    }
    assertEquals("Wrong number of documents", expected, docs.size());
    return docs;
  }

