  @BeforeClass
  public static void initManagedSchemaCore() throws Exception {
    // TODO propose convenience API for this?
    // This testing approach means no new solrconfig or schema file or per-test temp solr-home!
    System.setProperty("managed.schema.mutable", "true");
    System.setProperty("managed.schema.resourceName", "schema-one-field-no-dynamic-field-unique-key.xml");
    System.setProperty("enable.update.log", "false");
    initCore("solrconfig-managed-schema.xml", "ignoredSchemaName?");

    // modify solr config  TODO propose more convenient API for this; maybe with JSON-ification of a map
    try (SolrQueryRequestBase req = (SolrQueryRequestBase) req()) {
      req.getContext().put("httpMethod", "POST");
      req.setContentStreams(Collections.singleton(new ContentStreamBase.StringStream(
          "{ 'set-property':{" +
              "'query.enableLazyFieldLoading':true, " +
              "'query.documentCache.class':'solr.LRUCache'" +
              "}}"
      )));
      SolrQueryResponse rsp = new SolrQueryResponse();
      h.getCore().execute(h.getCore().getRequestHandler("/config"), req, rsp);
      assertNull(rsp.getException());
    }

    boolean PERSIST_FALSE = false; // don't write to test resource dir

    IndexSchema schema = h.getCore().getLatestSchema();
    schema = schema.addFieldTypes(Collections.singletonList(
        schema.newFieldType("textType", "solr.TextField", // redundant; TODO improve api
            map("name", "textType",   "class", "solr.TextField",
                "analyzer", map("class", "org.apache.lucene.analysis.standard.StandardAnalyzer")))),
        PERSIST_FALSE);
    schema = schema.addFields(Arrays.asList(
        schema.newField(LAZY_FIELD, "textType", map()),
        schema.newField(BIG_FIELD, "textType", map("large", true))),
        Collections.emptyMap(),
        PERSIST_FALSE);

    h.getCore().setLatestSchema(schema);
  }

