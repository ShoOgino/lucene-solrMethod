  /** SOLR-5163 */ 
  @Test
  public void testValidateQueryFields() throws Exception {
    // field aliasing covered by test - testAliasing
    ModifiableSolrParams params = new ModifiableSolrParams();
    params.add("defType", "edismax");
    params.add("df", "text");
    params.add("q", "olive AND other");
    params.add("qf", "subject^3 title");
    params.add("debugQuery", "true");
    
    // test valid field names
    try (SolrQueryRequest req = req(params)) {
      String response = h.query(req);
      response.contains("+DisjunctionMaxQuery((title:olive | (subject:oliv)^3.0)) +DisjunctionMaxQuery((title:other | (subject:other)^3.0))");
    }
    
    // test invalid field name
    params.set("qf", "subject^3 nosuchfield");
    try (SolrQueryRequest req = req(params)) {
      h.query(req);
    } catch (Exception e) {
      Assert.assertEquals("org.apache.solr.search.SyntaxError: Query Field 'nosuchfield' is not a valid field name", e.getMessage());
    }
    
  }

