  public void testInternals() throws IOException {
    String[] types = new String[]{"i", "l", "f", "d"};
    String[] suffixes = new String[]{"", "_dv", "_mv", "_mv_dv", "_ni", "_ni_dv", "_ni_dv_ns", "_ni_mv", "_ni_mv_dv", "_ni_ns", "_ni_ns_mv", "_dv_ns", "_ni_ns_dv", "_dv_ns_mv"};
    Set<String> typesTested = new HashSet<>();
    for (String type:types) {
      for (String suffix:suffixes) {
        doTestInternals("number_p_" + type + suffix, getSequentialStringArrayWithInts(10));
        typesTested.add("*_p_" + type + suffix);
      }
    }
    for (String suffix:suffixes) {
      doTestInternals("number_p_dt" + suffix, getSequentialStringArrayWithDates(10));
      typesTested.add("*_p_dt" + suffix);
    }
    
    Set<String> typesToTest = new HashSet<>();
    for (DynamicField dynField:h.getCore().getLatestSchema().getDynamicFields()) {
      if (dynField.getPrototype().getType() instanceof PointField) {
        typesToTest.add(dynField.getRegex());
      }
    }
    assertEquals("Missing types in the test", typesTested, typesToTest);
  }

