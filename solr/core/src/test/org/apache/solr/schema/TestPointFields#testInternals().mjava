  public void testInternals() throws IOException {
    String[] types = new String[]{"i", "l", "f", "d"};
    Set<String> typesTested = new HashSet<>();
    for (String type:types) {
      for (String suffix:FIELD_SUFFIXES) {
        doTestInternals("number_p_" + type + suffix, getSequentialStringArrayWithInts(10));
        typesTested.add("*_p_" + type + suffix);
      }
    }
    for (String suffix:FIELD_SUFFIXES) {
      doTestInternals("number_p_dt" + suffix, getSequentialStringArrayWithDates(10));
      typesTested.add("*_p_dt" + suffix);
    }

    assertEquals("Missing types in the test", dynFieldRegexesForType(PointField.class), typesTested);
  }

