  @Test
  public void testSplitMixedReplicaTypes() throws Exception {
    waitForThingsToLevelOut(15);
    String collectionName = "testSplitMixedReplicaTypes";
    CollectionAdminRequest.Create create = CollectionAdminRequest.createCollection(collectionName, "conf1", 1, 2, 2, 2);
    create.setMaxShardsPerNode(5); // some high number so we can create replicas without hindrance
    create.process(cloudClient);
    waitForRecoveriesToFinish(collectionName, false);

    CollectionAdminRequest.SplitShard splitShard = CollectionAdminRequest.splitShard(collectionName);
    splitShard.setShardName(SHARD1);
    splitShard.process(cloudClient);
    waitForThingsToLevelOut(15);

    cloudClient.getZkStateReader().forceUpdateCollection(collectionName);
    ClusterState clusterState = cloudClient.getZkStateReader().getClusterState();
    DocCollection coll = clusterState.getCollection(collectionName);
    log.info("coll: " + coll);

    // verify the original shard
    verifyShard(coll, SHARD1, Slice.State.INACTIVE, 2, 2, 2);
    // verify new sub-shards
    verifyShard(coll, SHARD1_0, Slice.State.ACTIVE, 2, 2, 2);
    verifyShard(coll, SHARD1_1, Slice.State.ACTIVE, 2, 2, 2);
  }

