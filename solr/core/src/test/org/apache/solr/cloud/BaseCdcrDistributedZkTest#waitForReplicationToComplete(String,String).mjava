  protected void waitForReplicationToComplete(String collectionName, String shardId) throws Exception {
    int cnt = 15;
    while (cnt > 0) {
      log.info("Checking queue size @ {}:{}", collectionName, shardId);
      long size = this.getQueueSize(collectionName, shardId);
      if (size == 0) { // if we received -1, it means that the log reader is not yet initialised, we should wait
        return;
      }
      log.info("Waiting for replication to complete. Queue size: {} @ {}:{}", size, collectionName, shardId);
      cnt--;
      Thread.sleep(1000); // wait a bit for the replication to complete
    }
    throw new RuntimeException("Timeout waiting for CDCR replication to complete @" + collectionName + ":"  + shardId);
  }

