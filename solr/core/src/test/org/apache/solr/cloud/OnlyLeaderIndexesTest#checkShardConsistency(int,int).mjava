  private void checkShardConsistency(int expected, int numTry) throws Exception{

    for (int i = 0; i < numTry; i++) {
      boolean inSync = true;
      for (JettySolrRunner solrRunner: cluster.getJettySolrRunners()) {
        try (SolrClient client = solrRunner.newClient()) {
          SolrQuery query = new SolrQuery("*:*");
          query.set("distrib", false);
          long results = client.query(COLLECTION, query).getResults().getNumFound();
          if (expected != results) {
            inSync = false;
            Thread.sleep(500);
            break;
          }
        }
      }
      if (inSync) return;
    }

    fail("Some replicas are not in sync with leader");
  }

