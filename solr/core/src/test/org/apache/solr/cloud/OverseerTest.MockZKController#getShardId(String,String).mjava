    private String getShardId(final String baseUrl, final String coreName) {
      Map<String,Slice> slices = zkStateReader.getClusterState().getSlicesMap(
          collection);
      if (slices != null) {
        for (Slice slice : slices.values()) {
          for (Replica replica : slice.getReplicas()) {
            // TODO: for really large clusters, we could 'index' on this
            String rbaseUrl = replica.getStr(ZkStateReader.BASE_URL_PROP);
            String rcore = replica.getStr(ZkStateReader.CORE_NAME_PROP);
            if (baseUrl.equals(rbaseUrl) && coreName.equals(rcore)) {
              return slice.getName();
            }
          }
        }
      }
      return null;
    }

