  protected void indexAndUpdateCount(List<DocRouter.Range> ranges, int[] docCounts, int id) throws Exception {
    boolean success = true;
    try {
      indexr("id", id);
    } catch (SolrServerException e) {
      if (!e.getMessage().startsWith("No live SolrServers available to handle this request"))  {
        success = false;
        log.error("Exception while adding doc", e);
      } else  {
        // Error is recoverable because the proxy node will store the request in its log and
        // it will be retried later and sent to the leader
        log.warn("Counting doc: " + id + " because error is recoverable", e);
      }
    } finally {
      if (success)  {
        // todo - hook in custom hashing
        byte[] bytes = String.valueOf(id).getBytes("UTF-8");
        int hash = Hash.murmurhash3_x86_32(bytes, 0, bytes.length, 0);
        for (int i = 0; i < ranges.size(); i++) {
          DocRouter.Range range = ranges.get(i);
          if (range.includes(hash))
            docCounts[i]++;
        }
      }
    }
  }

