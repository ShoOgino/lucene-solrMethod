  @Before
  public void setupTest() throws Exception {
    configureCluster(NUM_NODES, TimeSource.get("simTime:" + SPEED));

    // disable metrics history collection
    cluster.disableMetricsHistory();

    // disable .scheduled_maintenance (once it exists)
    CloudTestUtils.waitForTriggerToBeScheduled(cluster, ".scheduled_maintenance");
    CloudTestUtils.suspendTrigger(cluster, ".scheduled_maintenance");
    // disable .auto_add_replicas (once it exists)
    CloudTestUtils.waitForTriggerToBeScheduled(cluster, ".auto_add_replicas");
    CloudTestUtils.suspendTrigger(cluster, ".auto_add_replicas");
    cluster.getSimClusterStateProvider().createSystemCollection();

    waitForSeconds = 5;
    triggerStartedCount.set(0);
    triggerFinishedCount.set(0);
    triggerStartedLatch = new CountDownLatch(1);
    triggerFinishedLatch = new CountDownLatch(1);
    
    // by default assume we want to allow a (virtually) unbounded amount of events,
    // tests that expect a specific number can override
    listenerEventLatch = new CountDownLatch(Integer.MAX_VALUE);
    listenerEvents.clear();
  }

