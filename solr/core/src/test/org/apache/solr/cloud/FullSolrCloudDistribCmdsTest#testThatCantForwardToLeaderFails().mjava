  private void testThatCantForwardToLeaderFails() throws InterruptedException,
      Exception, TimeoutException, IOException, KeeperException {
    ZkNodeProps props = zkStateReader.getLeaderProps(DEFAULT_COLLECTION, "shard1");
    
    chaosMonkey.stopShard("shard1");

    // fake that the leader is still advertised
    String leaderPath = ZkStateReader.getShardLeadersPath(DEFAULT_COLLECTION, "shard1");
    SolrZkClient zkClient = new SolrZkClient(zkServer.getZkAddress(), 10000);
    int fails = 0;
    try {
      zkClient.makePath(leaderPath, ZkStateReader.toJSON(props),
          CreateMode.EPHEMERAL, true);
      for (int i = 200; i < 210; i++) {
        try {
          index_specific(cloudClient, id, i);
        } catch (SolrException e) {
          // expected
          fails++;
          break;
        } catch (SolrServerException e) {
          // expected
          fails++;
          break;
        }
      }
    } finally {
      zkClient.close();
    }
    
    assertTrue("A whole shard is down - some of these should fail", fails > 0);
  }

