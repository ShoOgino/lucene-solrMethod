  @Test
  public void testDeleteStatus() throws IOException, SolrServerException {
    CollectionAdminRequest.Create create = new CollectionAdminRequest.Create();
    create.setCollectionName("requeststatus")
        .setConfigName("conf1")
        .setReplicationFactor(1)
        .setNumShards(1)
        .setAsyncId("collectioncreate")
        .process(cloudClient);

    RequestStatusState state = getRequestStateAfterCompletion("collectioncreate", 30, cloudClient);
    assertSame(RequestStatusState.COMPLETED, state);

    // Let's delete the stored response now
    CollectionAdminRequest.DeleteStatus deleteStatus = new CollectionAdminRequest.DeleteStatus();
    CollectionAdminResponse rsp = deleteStatus
        .setRequestId("collectioncreate")
        .process(cloudClient);
    assertEquals("successfully removed stored response for [collectioncreate]", rsp.getResponse().get("status"));

    // Make sure that the response was deleted from zk
    state = getRequestState("collectioncreate", cloudClient);
    assertSame(RequestStatusState.NOT_FOUND, state);

    // Try deleting the same requestid again
    deleteStatus = new CollectionAdminRequest.DeleteStatus();
    rsp = deleteStatus
        .setRequestId("collectioncreate")
        .process(cloudClient);
    assertEquals("[collectioncreate] not found in stored responses", rsp.getResponse().get("status"));

    // Let's try deleting a non-existent status
    deleteStatus = new CollectionAdminRequest.DeleteStatus();
    rsp = deleteStatus
        .setRequestId("foo")
        .process(cloudClient);
    assertEquals("[foo] not found in stored responses", rsp.getResponse().get("status"));
  }

