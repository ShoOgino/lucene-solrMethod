  @After
  public void printState() throws Exception {
    log.debug("-------------_ FINAL STATE --------------");
    SolrCloudManager cloudManager = cluster.getJettySolrRunner(0).getCoreContainer().getZkController().getSolrCloudManager();
    for (String node: cloudManager.getClusterStateProvider().getLiveNodes()) {
      Map<String, Object> values = cloudManager.getNodeStateProvider().getNodeValues(node, ImplicitSnitch.tags);
      if (log.isDebugEnabled()) {
        log.debug("* Node values: {}\n{}", node, Utils.toJSONString(values));
      }
    }
    if (log.isDebugEnabled()) {
      log.debug("* Live nodes: {}", cloudManager.getClusterStateProvider().getLiveNodes());
    }
    ClusterState state = cloudManager.getClusterStateProvider().getClusterState();
    if (log.isDebugEnabled()) {
      state.forEachCollection(coll -> log.debug("* Collection {} state: {}", coll.getName(), coll));
    }
  }

