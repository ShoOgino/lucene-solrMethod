  private long waitForTargetToSync(int numDocs, CloudSolrClient targetSolrClient) throws SolrServerException, IOException, InterruptedException {
    long start = System.nanoTime();
    QueryResponse response = null;
    while (System.nanoTime() - start <= TimeUnit.NANOSECONDS.convert(120, TimeUnit.SECONDS)) {
      try {
        targetSolrClient.commit();
        response = targetSolrClient.query(new SolrQuery("*:*"));
        log.info("cdcr: numDocs in waitForTargetToSync: " + response.getResults().getNumFound());
        if (response.getResults().getNumFound() == numDocs) {
          break;
        }
      } catch (Exception e) {
        log.warn("Exception trying to commit on target. This is expected and safe to ignore.", e);
      }
      Thread.sleep(1000);
    }
    return response != null ? response.getResults().getNumFound() : 0;
  }

