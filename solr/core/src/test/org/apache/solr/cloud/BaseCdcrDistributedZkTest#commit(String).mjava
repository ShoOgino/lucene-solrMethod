  /**
   * Invokes a commit on the given collection.
   */
  protected void commit(String collection) throws IOException, SolrServerException {
    CloudSolrClient client = createCloudClient(collection);
    try {
      client.commit(true, true);
    } finally {
      client.close();
    }
  }

