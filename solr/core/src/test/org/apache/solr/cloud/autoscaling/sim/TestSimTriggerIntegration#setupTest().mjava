  @Before
  public void setupTest() throws Exception {
    // disable .scheduled_maintenance
    String suspendTriggerCommand = "{" +
        "'suspend-trigger' : {'name' : '.scheduled_maintenance'}" +
        "}";
    SolrRequest req = createAutoScalingRequest(SolrRequest.METHOD.POST, suspendTriggerCommand);
    SolrClient solrClient = cluster.simGetSolrClient();
    NamedList<Object> response = solrClient.request(req);
    String result = response.get("result").toString();
    if (!"success".equals(result) && !result.contains("No trigger exists")) {
      fail("Unexpected response: " + result);
    }

    waitForSeconds = 1 + random().nextInt(3);
    actionConstructorCalled = new CountDownLatch(1);
    actionInitCalled = new CountDownLatch(1);
    triggerFiredLatch = new CountDownLatch(1);
    triggerFired = new AtomicBoolean(false);
    actionStarted = new CountDownLatch(1);
    actionInterrupted = new CountDownLatch(1);
    actionCompleted = new CountDownLatch(1);
    triggerStartedLatch = new CountDownLatch(1);
    triggerFinishedLatch = new CountDownLatch(1);
    triggerStartedCount = new AtomicInteger();
    triggerFinishedCount = new AtomicInteger();
    events.clear();
    listenerEvents.clear();
    while (cluster.getClusterStateProvider().getLiveNodes().size() < 2) {
      // perhaps a test stopped a node but didn't start it back
      // lets start a node
      cluster.simAddNode();
    }
    // do this in advance if missing
    if (!cluster.getSimClusterStateProvider().simListCollections().contains(CollectionAdminParams.SYSTEM_COLL)) {
      cluster.getSimClusterStateProvider().createSystemCollection();
      CloudTestUtils.waitForState(cluster, CollectionAdminParams.SYSTEM_COLL, 120, TimeUnit.SECONDS,
          CloudTestUtils.clusterShape(1, 1, false, true));
    }
  }

