  private void verifyShardLeader(ZkStateReader reader, String collection, String shard, String expectedCore) throws InterruptedException, KeeperException {
    int maxIterations = 100;
    while(maxIterations-->0) {
      reader.updateCloudState(true); // poll state
      ZkNodeProps props =  reader.getCloudState().getLeader(collection, shard);
      if(props!=null) {
        if(expectedCore.equals(props.get(ZkStateReader.CORE_NAME_PROP))) {
          return;
        }
      }
      Thread.sleep(100);
    }
    
    assertEquals("Unexpected shard leader coll:" + collection + " shard:" + shard, expectedCore, (reader.getCloudState().getLeader(collection, shard)!=null)?reader.getCloudState().getLeader(collection, shard).get(ZkStateReader.CORE_NAME_PROP):null);
  }

