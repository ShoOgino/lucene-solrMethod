  @Before
  public void doBefore() throws Exception {
    solrClient = getCloudSolrClient(cluster);
    httpClient = (CloseableHttpClient) solrClient.getHttpClient();
    // delete aliases first since they refer to the collections
    ZkStateReader zkStateReader = cluster.getSolrClient().getZkStateReader();
    //TODO create an API to delete collections attached to the routed alias when the alias is removed
    zkStateReader.aliasesManager.update();// ensure we're seeing the latest
    zkStateReader.aliasesManager.applyModificationAndExportToZk(aliases -> {
      Aliases a = zkStateReader.getAliases();
      for (String alias : a.getCollectionAliasMap().keySet()) {
        a = a.cloneWithCollectionAlias(alias,null); // remove
      }
      return a;
    });
    cluster.deleteAllCollections();
  }

