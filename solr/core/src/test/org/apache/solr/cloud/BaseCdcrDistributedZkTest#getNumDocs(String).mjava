  /**
   * Returns the number of documents in a given collection
   */
  protected long getNumDocs(String collection) throws SolrServerException, IOException {
    CloudSolrClient client = createCloudClient(collection);
    try {
      return client.query(new SolrQuery("*:*")).getResults().getNumFound();
    } finally {
      client.close();
    }
  }

