    @Override
    public byte[] take() throws Exception {
      Timer.Context timer = stats.time(dir + "_take");
      updateLock.lockInterruptibly();
      try {
        while (true) {
          byte[] result = poll();
          if (result != null) {
            return result;
          }
          changed.await();
        }
      } finally {
        updateLock.unlock();
        timer.stop();
      }
    }

