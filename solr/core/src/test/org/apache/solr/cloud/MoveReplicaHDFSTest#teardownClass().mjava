  @AfterClass
  public static void teardownClass() throws Exception {
    try {
      IOUtils.close(
          () -> {
            try {
              if (cluster != null) cluster.shutdown();
            } catch (Exception e) {
              throw new IOException("Could not shut down the cluster.", e);
            }
          },
          () -> {
            try {
              if (dfsCluster != null) HdfsTestUtil.teardownClass(dfsCluster);
            } catch (Exception e) {
              throw new IOException("Could not shut down dfs cluster.", e);
            }
          }
      );
    } finally {
      cluster = null;
      dfsCluster = null;
    }
  }

