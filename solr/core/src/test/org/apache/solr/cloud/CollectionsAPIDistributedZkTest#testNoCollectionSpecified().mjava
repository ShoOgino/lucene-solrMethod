  private void testNoCollectionSpecified() throws Exception {
    
    cloudClient.getZkStateReader().updateClusterState(true);
    assertFalse(cloudClient.getZkStateReader().getAllCollections().contains("corewithnocollection"));
    assertFalse(cloudClient.getZkStateReader().getAllCollections().contains("corewithnocollection2"));
    
    // try and create a SolrCore with no collection name
    Create createCmd = new Create();
    createCmd.setCoreName("corewithnocollection");
    createCmd.setCollection("");
    String dataDir = SolrTestCaseJ4.dataDir.getAbsolutePath() + File.separator
        + System.currentTimeMillis() + "corewithnocollection" + "_1v";
    createCmd.setDataDir(dataDir);
    createCmd.setNumShards(1);
    if (secondConfigSet) {
      createCmd.setCollectionConfigName("conf1");
    }
    
    createNewSolrServer("", getBaseUrl((HttpSolrServer) clients.get(1)))
        .request(createCmd);
    
    // try and create a SolrCore with no collection name
    createCmd.setCollection(null);
    createCmd.setCoreName("corewithnocollection2");
    
    createNewSolrServer("", getBaseUrl((HttpSolrServer) clients.get(1)))
        .request(createCmd);
    
    // in both cases, the collection should have default to the core name
    cloudClient.getZkStateReader().updateClusterState(true);
    assertTrue(cloudClient.getZkStateReader().getAllCollections().contains("corewithnocollection"));
    assertTrue(cloudClient.getZkStateReader().getAllCollections().contains("corewithnocollection2"));
  }

