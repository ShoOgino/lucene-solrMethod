  private void testNoCollectionSpecified() throws Exception {
    assertFalse(cloudClient.getZkStateReader().getClusterState().hasCollection("corewithnocollection"));
    assertFalse(cloudClient.getZkStateReader().getClusterState().hasCollection("corewithnocollection2"));
    
    // try and create a SolrCore with no collection name
    Create createCmd = new Create();
    createCmd.setCoreName("corewithnocollection");
    createCmd.setCollection("");
    String dataDir = createTempDir().toFile().getAbsolutePath();
    createCmd.setDataDir(dataDir);
    createCmd.setNumShards(1);
    if (secondConfigSet) {
      createCmd.setCollectionConfigName("conf1");
    }

    makeRequest(getBaseUrl((HttpSolrClient) clients.get(1)), createCmd);
    
    // try and create a SolrCore with no collection name
    createCmd.setCollection(null);
    createCmd.setCoreName("corewithnocollection2");

    makeRequest(getBaseUrl((HttpSolrClient) clients.get(1)), createCmd);
    
    // in both cases, the collection should have default to the core name
    cloudClient.getZkStateReader().forceUpdateCollection("corewithnocollection");
    cloudClient.getZkStateReader().forceUpdateCollection("corewithnocollection2");
    assertTrue(cloudClient.getZkStateReader().getClusterState().hasCollection("corewithnocollection"));
    assertTrue(cloudClient.getZkStateReader().getClusterState().hasCollection("corewithnocollection2"));
  }

