  private void checkForBackupSuccess(HttpSolrClient client, Path location) throws InterruptedException, IOException {
    CheckBackupStatus checkBackupStatus = new CheckBackupStatus(client);
    while (!checkBackupStatus.success) {
      checkBackupStatus.fetchStatus();
      Thread.sleep(1000);
    }
    try (DirectoryStream<Path> stream = Files.newDirectoryStream(location, "snapshot*")) {
      ArrayList<Path> files = Lists.newArrayList(stream.iterator());
      assertEquals(Arrays.asList(files).toString(), 1, files.size());
    }

  }

