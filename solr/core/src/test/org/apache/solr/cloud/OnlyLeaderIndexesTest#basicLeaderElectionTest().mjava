  public void basicLeaderElectionTest() throws Exception {
    CloudSolrClient cloudClient = cluster.getSolrClient();
    new UpdateRequest()
        .deleteByQuery("*:*")
        .commit(cluster.getSolrClient(), COLLECTION);
    new UpdateRequest()
        .add(sdoc("id", "1"))
        .add(sdoc("id", "2"))
        .process(cloudClient, COLLECTION);
    String oldLeader = getLeader();
    JettySolrRunner oldLeaderJetty = getSolrRunner(true).get(0);
    ChaosMonkey.kill(oldLeaderJetty);
    for (int i = 0; i < 60; i++) { // wait till leader is changed
      if (!oldLeader.equals(getLeader())) {
        break;
      }
      Thread.sleep(100);
    }
    new UpdateRequest()
        .add(sdoc("id", "3"))
        .add(sdoc("id", "4"))
        .process(cloudClient, COLLECTION);
    ChaosMonkey.start(oldLeaderJetty);
    AbstractDistribZkTestBase.waitForRecoveriesToFinish(COLLECTION, cluster.getSolrClient().getZkStateReader(),
        false, true, 60);
    checkRTG(1,4, cluster.getJettySolrRunners());
    new UpdateRequest()
        .commit(cloudClient, COLLECTION);
    checkShardConsistency(4,1);
  }

