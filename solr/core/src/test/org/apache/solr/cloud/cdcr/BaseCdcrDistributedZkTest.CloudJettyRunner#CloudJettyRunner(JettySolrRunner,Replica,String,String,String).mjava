    public CloudJettyRunner(JettySolrRunner jetty, Replica replica,
                            String collection, String shard, String coreNodeName) {
      this.jetty = jetty;
      this.info = replica;
      this.collection = collection;
      
      Properties nodeProperties = jetty.getNodeProperties();

      // we need to update the jetty's shard so that it registers itself to the right shard when restarted
      this.shard = shard;
      nodeProperties.setProperty(CoreDescriptor.CORE_SHARD, this.shard);

      // we need to update the jetty's shard so that it registers itself under the right core name when restarted
      this.coreNodeName = coreNodeName;
      nodeProperties.setProperty(CoreDescriptor.CORE_NODE_NAME, this.coreNodeName);

      this.nodeName = replica.getNodeName();

      ZkCoreNodeProps coreNodeProps = new ZkCoreNodeProps(info);
      this.url = coreNodeProps.getCoreUrl();

      // strip the trailing slash as this can cause issues when executing requests
      this.client = createNewSolrServer(this.url.substring(0, this.url.length() - 1));
    }

