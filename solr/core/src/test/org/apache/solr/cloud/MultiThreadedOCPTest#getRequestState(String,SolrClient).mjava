  private String getRequestState(String requestId, SolrClient client) throws IOException, SolrServerException {
    RequestStatus requestStatusRequest = new RequestStatus();
    requestStatusRequest.setRequestId(requestId);
    CollectionAdminResponse response = requestStatusRequest.process(client);

    NamedList innerResponse = (NamedList) response.getResponse().get("status");
    return (String) innerResponse.get("state");
  }

