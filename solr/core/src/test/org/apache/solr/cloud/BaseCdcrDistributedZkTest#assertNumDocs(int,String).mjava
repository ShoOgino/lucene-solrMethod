  /**
   * Assert the number of documents in a given collection
   */
  protected void assertNumDocs(int expectedNumDocs, String collection)
  throws SolrServerException, IOException, InterruptedException {
    CloudSolrClient client = createCloudClient(collection);
    try {
      int cnt = 30; // timeout after 15 seconds
      AssertionError lastAssertionError = null;
      while (cnt > 0) {
        try {
          assertEquals(expectedNumDocs, client.query(new SolrQuery("*:*")).getResults().getNumFound());
          return;
        }
        catch (AssertionError e) {
          lastAssertionError = e;
          cnt--;
          Thread.sleep(500);
        }
      }
      throw new AssertionError("Timeout while trying to assert number of documents on collection: " + collection, lastAssertionError);
    } finally {
      client.close();
    }
  }

