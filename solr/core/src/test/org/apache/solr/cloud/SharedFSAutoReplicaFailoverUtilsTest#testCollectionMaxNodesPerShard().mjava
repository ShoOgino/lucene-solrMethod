  @Test
  public void testCollectionMaxNodesPerShard() {
    ClusterStateMockUtil.Result result = buildClusterState(results, "csr*sr2", 1, 1, NODE2);
    String createUrl = OverseerAutoReplicaFailoverThread.getBestCreateUrl(result.reader, result.badReplica, null);
    assertNull(createUrl);

    result = buildClusterState(results, "csr*sr2", 1, 2, NODE2);
    createUrl = OverseerAutoReplicaFailoverThread.getBestCreateUrl(result.reader, result.badReplica, null);
    assertEquals(NODE2_URL, createUrl);

    result = buildClusterState(results, "csr*csr2r2", 1, 1, NODE2);
    createUrl = OverseerAutoReplicaFailoverThread.getBestCreateUrl(result.reader, result.badReplica, null);
    assertEquals(NODE2_URL, createUrl);
  }

