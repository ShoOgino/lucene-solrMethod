  @Test
  public void testUploadWithScriptUpdateProcessor() throws Exception {
      // Authorization off
      final String untrustedSuffix = "-untrusted";
      uploadConfigSetWithAssertions("with-script-processor", untrustedSuffix, null, null);
      // try to create a collection with the uploaded configset
      Throwable thrown = expectThrows(HttpSolrClient.RemoteSolrException.class, () -> {
        createCollection("newcollection2", "with-script-processor" + untrustedSuffix,
      1, 1, solrCluster.getSolrClient());
      });

    assertThat(thrown.getMessage(), containsString("Underlying core creation failed"));

    // Authorization on
    final String trustedSuffix = "-trusted";
    protectConfigsHandler();
    uploadConfigSetWithAssertions("with-script-processor", trustedSuffix, "solr", "SolrRocks");
    // try to create a collection with the uploaded configset
    CollectionAdminResponse resp = createCollection("newcollection2", "with-script-processor" + trustedSuffix,
    1, 1, solrCluster.getSolrClient());
    scriptRequest("newcollection2");

  }

