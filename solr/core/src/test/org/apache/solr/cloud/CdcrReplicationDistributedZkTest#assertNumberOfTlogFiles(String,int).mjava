  /**
   * Asserts the number of transaction logs across all the shards. Since the cleaning of the update logs
   * is not immediate on the slave nodes (it relies on the update log synchronizer that is executed every second),
   * it will retry until the assert is successful or until the timeout.
   */
  protected void assertNumberOfTlogFiles(String collection, int maxNumberOfTLogs) throws Exception {
    int cnt = 15; // timeout after 15 seconds
    AssertionError lastAssertionError = null;

    while (cnt > 0) {
      try {
        // Fire a DeleteById query with a commit to trigger update log cleaning on the non-leader nodes
        List<String> ids = new ArrayList<>();
        ids.add("_NON_EXISTING_ID_");
        deleteById(collection, ids);

        // Check the update logs
        this._assertNumberOfTlogFiles(collection, maxNumberOfTLogs);
        return;
      }
      catch (AssertionError e) {
        lastAssertionError = e;
        cnt--;
        Thread.sleep(1000);
      }
    }

    throw new AssertionError("Timeout while trying to assert update logs @ collection="+collection, lastAssertionError);
  }

