  private void waitForNon404(HttpSolrServer collectionClient)
      throws Exception {
    
    long timeoutAt = System.currentTimeMillis() + 30000;
    
    while (System.currentTimeMillis() < timeoutAt) {
      boolean missing = false;
      try {
        collectionClient.query(new SolrQuery("*:*"));
      } catch (SolrException e) {
        // How do I get the response code!?
        if (!e.getMessage().contains("(404)")) {
          throw e;
        }
        missing = true;
      }
      if (!missing) {
        return;
      }
      Thread.sleep(50);
    }
    printLayout();
    fail("Could not find the new collection - 404 : " + collectionClient.getBaseURL());
  }

