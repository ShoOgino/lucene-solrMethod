  /**
   * Helper method to send a status request with specific retry limit and return
   * the message/null from the success response.
   */
  private String sendStatusRequestWithRetry(ModifiableSolrParams params, int maxCounter)
      throws SolrServerException, IOException {
    NamedList status = null;
    RequestStatusState state = null;
    String message = null;
    NamedList r;
    while (maxCounter-- > 0) {
      r = sendRequest(params);
      status = (NamedList) r.get("status");
      state = RequestStatusState.fromKey((String) status.get("state"));
      message = (String) status.get("msg");

      if (state == RequestStatusState.COMPLETED || state == RequestStatusState.FAILED) {
        return (String) status.get("msg");
      }
      try {
        Thread.sleep(1000);
      } catch (InterruptedException e) {

      }

    }
    // Return last state?
    return message;
  }

