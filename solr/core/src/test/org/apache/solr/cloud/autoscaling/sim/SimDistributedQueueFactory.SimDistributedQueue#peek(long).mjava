    @Override
    public byte[] peek(long wait) throws Exception {
      Timer.Context time;
      if (wait == Long.MAX_VALUE) {
        time = stats.time(dir + "_peek_wait_forever");
      } else {
        time = stats.time(dir + "_peek_wait" + wait);
      }
      try {
        Pair<String, byte[]> pair = peekInternal(wait);
        return pair != null ? pair.second() : null;
      } finally {
        time.stop();
      }
    }

