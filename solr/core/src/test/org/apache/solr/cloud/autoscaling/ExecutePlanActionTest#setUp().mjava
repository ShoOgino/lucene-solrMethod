  @Before
  public void setUp() throws Exception  {
    super.setUp();
    // clear any persisted auto scaling configuration
    Stat stat = zkClient().setData(SOLR_AUTOSCALING_CONF_PATH, Utils.toJSON(new ZkNodeProps()), true);

    if (cluster.getJettySolrRunners().size() < NODE_COUNT) {
      // start some to get to original state
      int numJetties = cluster.getJettySolrRunners().size();
      for (int i = 0; i < NODE_COUNT - numJetties; i++) {
        cluster.startJettySolrRunner();
      }
    }
    cluster.waitForAllNodes(30);
    loader = cluster.getJettySolrRunner(0).getCoreContainer().getResourceLoader();
    cloudManager = cluster.getJettySolrRunner(0).getCoreContainer().getZkController().getSolrCloudManager();
    cluster.deleteAllCollections();
  }

