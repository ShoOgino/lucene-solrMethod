  private void waitForValue(String propertyName, String expectedValue, int timeout) throws InterruptedException {
    final ZkStateReader zkStateReader = cluster.getSolrClient().getZkStateReader();

    for (int i = 0; i < timeout; i += 10) {
      final Object value = zkStateReader.getCollectionProperties(collectionName).get(propertyName);
      if ((expectedValue == null && value == null) ||
          (expectedValue != null && expectedValue.equals(value))) {
        return;
      }
      Thread.sleep(10);
    }

    fail(String.format(Locale.ROOT, "Could not see value change after setting collection property. Name: %s, current value: %s, expected value: %s",
            propertyName, zkStateReader.getCollectionProperties(collectionName).get(propertyName), expectedValue));
  }

