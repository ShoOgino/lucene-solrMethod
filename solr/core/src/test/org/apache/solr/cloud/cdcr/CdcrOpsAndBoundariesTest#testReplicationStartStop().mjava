  @Test
  public void testReplicationStartStop() throws Exception {
    createCollections();

    CdcrTestsUtil.indexRandomDocs(10, sourceSolrClient);
    CdcrTestsUtil.cdcrStart(sourceSolrClient);

    assertEquals(10, CdcrTestsUtil.waitForClusterToSync
        (sourceSolrClient.query(new SolrQuery(ALL_Q)).getResults().getNumFound(), targetSolrClient));

    CdcrTestsUtil.cdcrStop(sourceSolrClient);

    CdcrTestsUtil.indexRandomDocs(110, sourceSolrClient);

    // Start again CDCR, the source cluster should reinitialise its log readers
    // with the latest checkpoints

    CdcrTestsUtil.cdcrRestart(sourceSolrClient);

    assertEquals(110, CdcrTestsUtil.waitForClusterToSync
        (sourceSolrClient.query(new SolrQuery(ALL_Q)).getResults().getNumFound(), targetSolrClient));

    deleteCollections();
  }

