  private int getNumOfCores(CloudSolrClient cloudClient, String nodeName, String collectionName) throws IOException, SolrServerException {
    try (HttpSolrClient coreclient = getHttpSolrClient(cloudClient.getZkStateReader().getBaseUrlForNodeName(nodeName))) {
      CoreAdminResponse status = CoreAdminRequest.getStatus(null, coreclient);
      if (status.getCoreStatus().size() == 0) {
        return 0;
      }
      // filter size by collection name
      if (collectionName == null) {
        return status.getCoreStatus().size();
      } else {
        int size = 0;
        Iterator<Map.Entry<String, NamedList<Object>>> it = status.getCoreStatus().iterator();
        while (it.hasNext()) {
          String coll = (String)it.next().getValue().findRecursive("cloud", "collection");
          if (collectionName.equals(coll)) {
            size++;
          }
        }
        return size;
      }
    }
  }

