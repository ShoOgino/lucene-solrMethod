  @Before
  public void init() throws Exception {

    fired.set(false);
    triggerFiredLatch = new CountDownLatch(1);
    actionContextPropsRef.set(null);

    if (cluster.getClusterStateProvider().getLiveNodes().size() > NODE_COUNT) {
      // stop some to get to original state
      int numJetties = cluster.getClusterStateProvider().getLiveNodes().size();
      for (int i = 0; i < numJetties - NODE_COUNT; i++) {
        String node = cluster.getSimClusterStateProvider().simGetRandomNode(random());
        cluster.getSimClusterStateProvider().simRemoveNode(node);
      }
    }

    String setClusterPolicyCommand = "{" +
        " 'set-cluster-policy': [" +
        "      {'cores':'<10', 'node':'#ANY'}," +
        "      {'replica':'<2', 'shard': '#EACH', 'node': '#ANY'}," +
        "      {'nodeRole':'overseer', 'replica':0}" +
        "    ]" +
        "}";
    SolrRequest req = createAutoScalingRequest(SolrRequest.METHOD.POST, setClusterPolicyCommand);
    SolrResponse rsp = cluster.request(req);
    NamedList<Object> response = rsp.getResponse();
    assertEquals(response.get("result").toString(), "success");

    String setClusterPreferencesCommand = "{" +
        "'set-cluster-preferences': [" +
        "{'minimize': 'cores'}," +
        "{'maximize': 'freedisk','precision': 100}]" +
        "}";
    req = createAutoScalingRequest(SolrRequest.METHOD.POST, setClusterPreferencesCommand);
    rsp = cluster.request(req);
    response = rsp.getResponse();
    assertEquals(response.get("result").toString(), "success");
    cluster.getTimeSource().sleep(TimeUnit.SECONDS.toMillis(ScheduledTriggers.DEFAULT_COOLDOWN_PERIOD_SECONDS));
  }

