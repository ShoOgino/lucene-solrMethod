  /**
   * Save clusterstate.json to {@link DistribStateManager}.
   * @return saved state
   */
  private ClusterState saveClusterState(ClusterState state) throws IOException {
    byte[] data = Utils.toJSON(state);
    try {
      VersionedData oldData = stateManager.getData(ZkStateReader.CLUSTER_STATE);
      int version = oldData != null ? oldData.getVersion() : -1;
      stateManager.setData(ZkStateReader.CLUSTER_STATE, data, version);
      LOG.trace("-- saved cluster state version=" + clusterStateVersion +
          ", zkVersion=" + (version + 1) + ", {}", state);
    } catch (Exception e) {
      throw new IOException(e);
    }
    return state;
  }

