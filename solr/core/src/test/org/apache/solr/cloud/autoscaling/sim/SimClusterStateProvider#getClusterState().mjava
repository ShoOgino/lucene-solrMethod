  @Override
  public ClusterState getClusterState() throws IOException {
    ensureNotClosed();
    Map<String, DocCollection> states = getCollectionStates();
    ClusterState state = new ClusterState(clusterStateVersion, liveNodes.get(), states);
    return state;
  }

