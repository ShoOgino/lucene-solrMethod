  @Override
  public ClusterState getClusterState() throws IOException {
    Map<String, DocCollection> states = getCollectionStates();
    ClusterState state = new ClusterState(clusterStateVersion, liveNodes.get(), states);
    if (saveClusterState.getAndSet(false)) {
      saveClusterState(state);
    }
    return state;
  }

