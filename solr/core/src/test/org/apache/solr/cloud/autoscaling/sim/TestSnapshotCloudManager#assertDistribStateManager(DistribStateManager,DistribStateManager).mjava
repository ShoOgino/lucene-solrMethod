  private static void assertDistribStateManager(DistribStateManager one, DistribStateManager two) throws Exception {
    List<String> treeOne = new ArrayList<>(one.listTree("/").stream()
        .filter(STATE_FILTER_FUN).collect(Collectors.toList()));
    List<String> treeTwo = new ArrayList<>(two.listTree("/").stream()
        .filter(STATE_FILTER_FUN).collect(Collectors.toList()));
    Collections.sort(treeOne);
    Collections.sort(treeTwo);
    assertEquals(treeOne, treeTwo);
    for (String path : treeOne) {
      VersionedData vd1 = one.getData(path);
      VersionedData vd2 = two.getData(path);
      assertEquals(path, vd1, vd2);
    }
  }

