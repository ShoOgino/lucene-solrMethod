  private static void assertDistribStateManager(DistribStateManager one, DistribStateManager two) throws Exception {
    List<String> treeOne = new ArrayList<>(one.listTree("/").stream()
        .filter(STATE_FILTER_FUN).collect(Collectors.toList()));
    List<String> treeTwo = new ArrayList<>(two.listTree("/").stream()
        .filter(STATE_FILTER_FUN).collect(Collectors.toList()));
    Collections.sort(treeOne);
    Collections.sort(treeTwo);
    if (!treeOne.equals(treeTwo)) {
      List<String> t1 = new ArrayList<>(treeOne);
      t1.removeAll(treeTwo);
      log.warn("Only in tree one: {}", t1);
      List<String> t2 = new ArrayList<>(treeTwo);
      t2.removeAll(treeOne);
      log.warn("Only in tree two: {}", t2);
    }
    assertEquals(treeOne, treeTwo);
    for (String path : treeOne) {
      VersionedData vd1 = one.getData(path);
      VersionedData vd2 = two.getData(path);
      assertEquals(path, vd1, vd2);
    }
  }

