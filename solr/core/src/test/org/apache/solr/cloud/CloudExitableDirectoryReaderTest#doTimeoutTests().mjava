  public void doTimeoutTests() throws Exception {
    assertPartialResults(params("q", "name:a*", "timeAllowed", "1"));

    /*
    query rewriting for NUM_DOCS_PER_TYPE terms should take less 
    time than this. Keeping it at 5 because the delaying search component delays all requests 
    by at 1 second.
     */
    long fiveSeconds = 5000L;
    
    Long timeAllowed = TestUtil.nextLong(random(), fiveSeconds, Long.MAX_VALUE);
    assertSuccess(params("q", "name:a*", "timeAllowed",timeAllowed.toString()));

    assertPartialResults(params("q", "name:a*", "timeAllowed", "1"));

    timeAllowed = TestUtil.nextLong(random(), fiveSeconds, Long.MAX_VALUE);
    assertSuccess(params("q", "name:b*", "timeAllowed",timeAllowed.toString()));

    timeAllowed = TestUtil.nextLong(random(), Long.MIN_VALUE, -1L);  // negative timeAllowed should disable timeouts
    assertSuccess(params("q", "name:b*", "timeAllowed",timeAllowed.toString()));

    assertSuccess(params("q","name:b*")); // no time limitation
  }

