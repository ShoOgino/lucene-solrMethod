  private String getLeader() throws InterruptedException {
    String leader = null;
    int tries = 30;
    while (tries-- > 0) {
      ZkNodeProps props;
      try {
        reader.updateCloudState(true);
        props = reader.getLeaderProps("collection1", "shard1", 500);
        leader = props.get(ZkStateReader.NODE_NAME_PROP);
        if (leader != null) {
          break;
        }
      } catch (KeeperException e) {
        // ignore
      }
      Thread.sleep(500);
    }
    return leader;
  }

