  /**
   * Asks the LukeRequestHandler on the control client for a list of the fields in the schema - excluding _version_
   */
  private Collection<String> getAllFieldNames() throws SolrServerException, IOException {
    LukeRequest req = new LukeRequest("/admin/luke");
    req.setShowSchema(true); 
    NamedList<Object> rsp = controlClient.request(req);
    NamedList<Object> fields = (NamedList) ((NamedList)rsp.get("schema")).get("fields");
    ArrayList<String> names = new ArrayList<String>(fields.size());
    for (Map.Entry<String,Object> item : fields) {
      String f = item.getKey();
      if (! f.equals("_version_")) {
        names.add(item.getKey());
      }
    }
    return Collections.<String>unmodifiableCollection(names);
  }

