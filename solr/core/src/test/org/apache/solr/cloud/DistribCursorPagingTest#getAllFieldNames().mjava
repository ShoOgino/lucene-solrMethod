  /**
   * Asks the LukeRequestHandler on the control client for a list of the fields in the 
   * schema (excluding _version_) and then returns the field names in a deterministically 
   * random order.
   */
  private List<String> getAllFieldNames() throws SolrServerException, IOException {
    LukeRequest req = new LukeRequest("/admin/luke");
    req.setShowSchema(true); 
    NamedList<Object> rsp = controlClient.request(req);
    NamedList<Object> fields = (NamedList) ((NamedList)rsp.get("schema")).get("fields");
    ArrayList<String> names = new ArrayList<String>(fields.size());
    for (Map.Entry<String,Object> item : fields) {
      String f = item.getKey();
      if (! f.equals("_version_")) {
        names.add(item.getKey());
      }
    }
    Collections.sort(names);
    Collections.shuffle(names,random());
    return Collections.<String>unmodifiableList(names);
  }

