  private static CollectionStatePredicate expectAllReplicasOnSpecificNode
    (final String expectedNodeName,
     final int expectedSliceCount,
     final int expectedReplicaCount) {

    return (liveNodes, collection) -> {
      if (null == collection || expectedSliceCount != collection.getSlices().size()) {
        return false;
      }
      int actualReplicaCount = 0;
      for (Slice slice : collection) {
        for (Replica replica : slice) {
          if ( ! (replica.isActive(liveNodes)
                  && expectedNodeName.equals(replica.getNodeName())) ) {
            return false;
          }
          actualReplicaCount++;
        }
      }
      return expectedReplicaCount == actualReplicaCount;
    };
  }

