  protected static long waitForClusterToSync(int numDocs, CloudSolrClient clusterSolrClient, String query) throws Exception {
    long start = System.nanoTime();
    QueryResponse response = null;
    while (System.nanoTime() - start <= TimeUnit.NANOSECONDS.convert(120, TimeUnit.SECONDS)) {
      clusterSolrClient.commit();
      response = clusterSolrClient.query(new SolrQuery(query));
      if (response.getResults().getNumFound() == numDocs) {
        break;
      }
      Thread.sleep(1000);
    }
    return response != null ? response.getResults().getNumFound() : null;
  }

