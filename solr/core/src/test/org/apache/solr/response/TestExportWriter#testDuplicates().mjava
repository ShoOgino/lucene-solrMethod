  @Test
  public void testDuplicates() throws Exception {
    RefCounted<SolrIndexSearcher> ref = null;
    try {
      ref = h.getCore().getSearcher();
      LeafReader reader = ref.get().getSlowAtomicReader();
      // MultiValued Trie fields use SortedSet
      assertNotNull(reader.getSortedSetDocValues("int_is_t"));
      assertNull(reader.getSortedNumericDocValues("int_is_t"));
      // MultiValued Point fields use SortedNumerics
      assertNull(reader.getSortedSetDocValues("int_is_p"));
      assertNotNull(reader.getSortedNumericDocValues("int_is_p"));
    } finally {
      if (ref != null) ref.decref();
    }
    String s =  h.query(req("q", "id:3", "qt", "/export", "fl", "int_is_t", "sort", "intdv asc"));
    assertJsonEquals(s, "{\"responseHeader\": {\"status\": 0}, \"response\":{\"numFound\":1, \"docs\":[{\"int_is_t\":[1]}]}}");
    s =  h.query(req("q", "id:8", "qt", "/export", "fl", "int_is_p", "sort", "intdv asc"));
    assertJsonEquals(s, "{\"responseHeader\": {\"status\": 0}, \"response\":{\"numFound\":1, \"docs\":[{\"int_is_p\":[1,1,1,1]}]}}");
  }

