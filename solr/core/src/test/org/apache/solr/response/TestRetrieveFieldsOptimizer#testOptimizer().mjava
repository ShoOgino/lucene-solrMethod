  @Test
  public void testOptimizer() {
    RetrieveFieldsOptimizer optimizer = new RetrieveFieldsOptimizer(
        new HashSet<>(Arrays.asList("id", "title")),
        new HashSet<>()
    );
    optimizer.optimize(new HashSet<>(Arrays.asList("id", "title")));
    assertTrue(optimizer.returnDVFields());
    assertFalse(optimizer.returnStoredFields());

    optimizer = new RetrieveFieldsOptimizer(
        new HashSet<>(Arrays.asList("id", "title")),
        new HashSet<>()
    );
    optimizer.optimize(new HashSet<>(Collections.singletonList("title")));
    assertFalse(optimizer.returnDVFields());
    assertTrue(optimizer.returnStoredFields());

    optimizer = new RetrieveFieldsOptimizer(
        null,
        new HashSet<>(Collections.singletonList("id"))
    );
    optimizer.optimize(new HashSet<>(Collections.singletonList("id")));
    assertNull(optimizer.getStoredFields());
    assertTrue(optimizer.getDvFields().contains("id"));

  }

