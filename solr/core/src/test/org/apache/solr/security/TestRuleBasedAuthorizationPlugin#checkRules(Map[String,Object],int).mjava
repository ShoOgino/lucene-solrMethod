  private void checkRules(Map<String, Object> values, int expected) {

    AuthorizationContext context = new MockAuthorizationContext(values);
    RuleBasedAuthorizationPlugin plugin = new RuleBasedAuthorizationPlugin();
    plugin.init((Map) Utils.fromJSONString(permissions));
    AuthorizationResponse authResp = plugin.authorize(context);
    assertEquals(expected, authResp.statusCode);
  }

