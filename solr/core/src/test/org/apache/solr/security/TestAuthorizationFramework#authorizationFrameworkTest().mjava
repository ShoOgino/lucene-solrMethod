  @Test
  public void authorizationFrameworkTest() throws Exception {
    MockAuthorizationPlugin.denyUsers.add("user1");
    MockAuthorizationPlugin.denyUsers.add("user1");
    waitForThingsToLevelOut(10);
    log.info("Starting test");
    ModifiableSolrParams params = new ModifiableSolrParams();
    params.add("q", "*:*");
    // This should work fine.
    cloudClient.query(params);
    
    // This user is blacklisted in the mock. The request should return a 403.
    params.add("uname", "user1");
    try {
      cloudClient.query(params);
      fail("This should have failed");
    } catch (Exception e) {}
    log.info("Ending test");
  }

