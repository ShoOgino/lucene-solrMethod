  @Before
  public void setupCluster() throws Exception {
    configureCluster(1)
        .addConfig("conf", configset("cloud-minimal"))
        .withSecurityJson(STD_CONF)
        .configure();
    CollectionAdminRequest.createCollection(COLLECTION, "conf", 4, 1)
        .setMaxShardsPerNode(100)
        .setBasicAuthCredentials("solr", "solr")
        .process(cluster.getSolrClient());
    cluster.waitForActiveCollection(COLLECTION, 4, 4);

    JettySolrRunner jetty = cluster.getJettySolrRunner(0);
    jetty.stop();
    cluster.waitForJettyToStop(jetty);
    jetty.start();
    cluster.waitForAllNodes(30);
    cluster.waitForActiveCollection(COLLECTION, 4, 4);
  }

