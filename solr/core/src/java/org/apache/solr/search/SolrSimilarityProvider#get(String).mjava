  /** 
   * Solr implementation delegates to the fieldtype's similarity.
   * If this does not exist, uses the schema's default similarity.
   */
  // note: this is intentionally final, to maintain consistency with
  // whatever is specified in the the schema!
  @Override
  public final Similarity get(String field) {
    FieldType fieldType = schema.getFieldTypeNoEx(field);
    if (fieldType == null) {
      return schema.getFallbackSimilarity();
    } else {
      Similarity similarity = fieldType.getSimilarity();
      return similarity == null ? schema.getFallbackSimilarity() : similarity;
    }
  }

