  protected void exclude(Map<Query,Occur> clauses) {
    Set<String> tagsToExclude = new HashSet<>();
    String excludeTags = localParams.get("excludeTags");
    if (excludeTags != null) {
      tagsToExclude.addAll(StrUtils.splitSmart(excludeTags, ','));
    }
    @SuppressWarnings("rawtypes")
    Map tagMap = (Map) req.getContext().get("tags");
    if (tagMap != null && !tagMap.isEmpty() && !tagsToExclude.isEmpty()) {
      clauses.keySet().removeAll(excludeSet(tagMap, tagsToExclude));
    } // else no filters were tagged
  }

