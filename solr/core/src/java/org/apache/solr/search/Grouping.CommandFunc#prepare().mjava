    /**
     * {@inheritDoc}
     */
    protected void prepare() throws IOException {
      Map context = ValueSource.newContext(searcher);
      groupBy.createWeight(context, searcher);
      actualGroupsToFind = getMax(offset, numGroups, maxDoc);
    }

