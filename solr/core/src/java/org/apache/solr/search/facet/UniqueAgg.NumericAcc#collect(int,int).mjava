    @Override
    public void collect(int doc, int slot) throws IOException {
      int valuesDocID = values.docID();
      if (valuesDocID < doc) {
        valuesDocID = values.advance(doc);
      }
      if (valuesDocID > doc) {
        // missing
        return;
      }
      long val = values.longValue();

      LongSet set = sets[slot];
      if (set == null) {
        set = sets[slot] = new LongSet(16);
      }
      // TODO: could handle 0s at this level too
      set.add(val);
    }

