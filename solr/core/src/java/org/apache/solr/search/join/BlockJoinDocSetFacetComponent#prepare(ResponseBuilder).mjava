  @Override
  public void prepare(ResponseBuilder rb) throws IOException {
    
    if (getChildFacetFields(rb.req) != null) {
      validateQuery(rb.getQuery());
      rb.setNeedDocSet(true);
      rb.req.getContext().put(bjqKey, extractChildQuery(rb.getQuery()));
    }
  }

