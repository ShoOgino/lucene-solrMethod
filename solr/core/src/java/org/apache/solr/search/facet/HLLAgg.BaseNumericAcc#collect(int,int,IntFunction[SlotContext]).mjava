    @Override
    public void collect(int doc, int slot, IntFunction<SlotContext> slotContext) throws IOException {
      int valuesDocID = docIdSetIterator().docID();
      if (valuesDocID < doc) {
        valuesDocID = docIdSetIterator().advance(doc);
      }
      if (valuesDocID > doc) {
        return;
      }
      assert valuesDocID == doc;

      HLL hll = sets[slot];
      if (hll == null) {
        hll = sets[slot] = factory.getHLL();
      }
      collectValues(doc, hll);
    }

