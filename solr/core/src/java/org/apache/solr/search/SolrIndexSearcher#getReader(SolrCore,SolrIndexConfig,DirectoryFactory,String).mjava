  private static DirectoryReader getReader(SolrCore core, SolrIndexConfig config, DirectoryFactory directoryFactory, String path) throws IOException {
    DirectoryReader reader = null;
    Directory dir = directoryFactory.get(path, DirContext.DEFAULT, config.lockType);
    try {
      reader = core.getIndexReaderFactory().newReader(dir, core);
    } catch (Throwable t) {
      directoryFactory.release(dir);
      throw new SolrException(ErrorCode.SERVER_ERROR, "Error opening Reader", t);
    }
    return reader;
  }

