  @Override
  @SuppressWarnings("unchecked")
  public TopGroups<BytesRef> result() {
    if (firstPhaseGroups.isEmpty()) {
      return new TopGroups<>(groupSort.getSort(), withinGroupSort.getSort(), 0, 0, new GroupDocs[0], Float.NaN);
    }

    FieldType fieldType = field.getType();
    if (fieldType.getNumberType() != null) {
      return GroupConverter.fromMutable(field, secondPassCollector.getTopGroups(0));
    } else {
      return secondPassCollector.getTopGroups(0);
    }
  }

