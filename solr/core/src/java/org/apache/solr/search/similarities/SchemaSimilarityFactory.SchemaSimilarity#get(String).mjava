    @Override
    public Similarity get(String name) {
      FieldType fieldType = core.getLatestSchema().getFieldTypeNoEx(name);
      if (fieldType == null) {
        return defaultSimilarity;
      } else {
        Similarity similarity = fieldType.getSimilarity();
        similarity = similarity == null ? defaultSimilarity : similarity;

        // Payload score handling: if field type has index-time payload encoding, wrap and computePayloadFactor accordingly
        if (decoders == null) decoders = new HashMap<>();
        PayloadDecoder decoder;
        if (!decoders.containsKey(fieldType)) {
          decoders.put(fieldType, PayloadUtils.getPayloadDecoder(fieldType));
        }
        decoder = decoders.get(fieldType);

        if (decoder != null) similarity = new PayloadScoringSimilarityWrapper(similarity, decoder);

        return similarity;
      }
    }

