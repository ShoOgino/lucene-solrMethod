  // query must be positive
  protected DocSet getDocSetNC(Query query, DocSet filter) throws IOException {
    DocSetCollector collector = new DocSetCollector(maxDoc()>>6, maxDoc());

    try {
      if (filter == null) {
        super.search(query, collector);
      } else {
        Filter luceneFilter = filter.getTopFilter();
        super.search(new FilteredQuery(query, luceneFilter), collector);
      }
    } catch ( ExitableDirectoryReader.ExitingReaderException e) {
        log.warn("Query: " + query + "; " + e.getMessage());
    }
    return collector.getDocSet();
  }

