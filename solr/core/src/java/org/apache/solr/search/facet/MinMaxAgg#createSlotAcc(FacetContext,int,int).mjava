  @Override
  public SlotAcc createSlotAcc(FacetContext fcontext, int numDocs, int numSlots) throws IOException {
    ValueSource vs = getArg();

    if (vs instanceof StrFieldSource) {
      String field = ((StrFieldSource) vs).getField();
      SchemaField sf = fcontext.qcontext.searcher().getSchema().getField(field);
      if (sf.multiValued() || sf.getType().multiValuedFieldCache()) {
        if (sf.hasDocValues()) {
          // dv
        } else {
          // uif
        }
      } else {
        return new SingleValuedOrdAcc(fcontext, sf, numSlots);
      }
    }

    // numeric functions
    return new ValSlotAcc(vs, fcontext, numSlots);
  }

