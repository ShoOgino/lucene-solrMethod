  /** lookup the docid by the unique key field, and return the id *within* the leaf reader in the low 32 bits, and the index of the leaf reader in the high 32 bits.
   * -1 is returned if not found.
   * @lucene.internal
   */
  public long lookupId(BytesRef idBytes) throws IOException {
    String field = schema.getUniqueKeyField().getName();

    for (int i=0, c=leafContexts.size(); i<c; i++) {
      final AtomicReaderContext leaf = leafContexts.get(i);
      final AtomicReader reader = leaf.reader();

      final Fields fields = reader.fields();
      if (fields == null) continue;

      final Bits liveDocs = reader.getLiveDocs();
      
      final DocsEnum docs = reader.termDocsEnum(liveDocs, field, idBytes, false);

      if (docs == null) continue;
      int id = docs.nextDoc();
      if (id == DocIdSetIterator.NO_MORE_DOCS) continue;
      assert docs.nextDoc() == DocIdSetIterator.NO_MORE_DOCS;

      return (((long)i) << 32) | id;
    }

    return -1;
  }

