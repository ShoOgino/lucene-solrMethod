    @Override
    public int compareDocToValue(int doc, BytesRef value) {
      final BytesRef docValue = termsIndex.getTerm(doc, tempBR);
      if (docValue == null) {
        if (value == null) {
          return 0;
        }
        return 1;
      } else if (value == null) {
        return -1;
      }
      return docValue.compareTo(value);
    }

