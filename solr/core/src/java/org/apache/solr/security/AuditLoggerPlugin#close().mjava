  @Override
  public void close() throws IOException {
    if (async && executorService != null) {
      int timeSlept = 0;
      while (!queue.isEmpty() && timeSlept < 30) {
        try {
          log.info("Async auditlogger queue still has {} elements, sleeping to let it drain...", queue.size());
          Thread.sleep(1000);
          timeSlept ++;
        } catch (InterruptedException ignored) {}
      }
      closed = true;
      log.info("Shutting down async Auditlogger background thread(s)");
      executorService.shutdownNow();
    }
  }

