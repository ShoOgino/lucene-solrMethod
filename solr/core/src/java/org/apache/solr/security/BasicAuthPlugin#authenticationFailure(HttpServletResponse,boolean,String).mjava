  private void authenticationFailure(HttpServletResponse response, boolean isAjaxRequest, String message) throws IOException {
    for (Map.Entry<String, String> entry : authenticationProvider.getPromptHeaders().entrySet()) {
      String value = entry.getValue();
      // Prevent browser from intercepting basic authentication header when reqeust from Admin UI
      if (isAjaxRequest && HttpHeaders.WWW_AUTHENTICATE.equalsIgnoreCase(entry.getKey()) && value != null) {
        if (value.startsWith("Basic ")) {
          value = "x" + value;
          log.debug("Prefixing {} header for Basic Auth with 'x' to prevent browser basic auth popup", 
              HttpHeaders.WWW_AUTHENTICATE);
        }
      }
      response.setHeader(entry.getKey(), value);
    }
    response.sendError(401, message);
  }

