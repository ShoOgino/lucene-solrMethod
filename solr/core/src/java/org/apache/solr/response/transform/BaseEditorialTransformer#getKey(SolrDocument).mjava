  protected String getKey(SolrDocument doc) {
    Object obj = doc.get(idFieldName);
    if (obj instanceof IndexableField) {
      IndexableField f = (IndexableField) obj;
      Number n = f.numericValue();
      if (n != null) {
        return ft.readableToIndexed(n.toString());
      }
      return ft.readableToIndexed(f.stringValue());
    }
    throw new AssertionError("Expected an IndexableField but got: " + obj.getClass());
  }

