    public boolean write(int docId, LeafReader reader, Writer out, int fieldIndex) throws IOException {
      SortedSetDocValues vals = DocValues.getSortedSet(reader, this.field);
      List<Long> ords;
      if (vals.advance(docId) == docId) {
        ords = new ArrayList();
        long o = -1;
        while((o = vals.nextOrd()) != SortedSetDocValues.NO_MORE_ORDS) {
          ords.add(o);
        }
        assert ords.size() > 0;
      } else {
        return false;
      }


      if(fieldIndex>0) {
        out.write(',');
      }
      out.write('"');
      out.write(this.field);
      out.write('"');
      out.write(':');
      out.write('[');
      int v = 0;
      for(long ord : ords) {
        BytesRef ref = vals.lookupOrd(ord);
        fieldType.indexedToReadable(ref, cref);
        if(v > 0) {
          out.write(',');
        }

        if(!numeric) {
          out.write('"');
        }

        writeStr(cref.toString(), out);

        if(!numeric) {
          out.write('"');
        }
        ++v;
      }
      out.write("]");
      return true;
    }

