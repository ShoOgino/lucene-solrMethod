  protected void writeDoc(SortDoc sortDoc,
                          List<AtomicReaderContext> leaves,
                          FieldWriter[] fieldWriters,
                          FixedBitSet[] sets,
                          Writer out) throws IOException{

    int ord = sortDoc.ord;
    FixedBitSet set = sets[ord];
    set.clear(sortDoc.docId);
    AtomicReaderContext context = leaves.get(ord);
    boolean needsComma = false;
    for(FieldWriter fieldWriter : fieldWriters) {
      if(needsComma) {
        out.write(',');
      }
      fieldWriter.write(sortDoc.docId, context.reader(), out);
      needsComma = true;
    }
  }

