    DirectoryFileFetcher(Directory tmpIndexDir, Map<String, Object> fileDetails, String saveAs,
                boolean isConf, long latestGen) throws IOException {
      this.copy2Dir = tmpIndexDir;
      this.fileName = (String) fileDetails.get(NAME);
      this.size = (Long) fileDetails.get(SIZE);
      this.isConf = isConf;
      this.saveAs = saveAs;

      indexGen = latestGen;
      
      outStream = copy2Dir.createOutput(saveAs, IOContext.DEFAULT);

      if (includeChecksum)
        checksum = new Adler32();
    }

