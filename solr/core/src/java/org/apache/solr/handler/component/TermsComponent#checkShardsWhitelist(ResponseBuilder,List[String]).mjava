  protected void checkShardsWhitelist(final ResponseBuilder rb, final List<String> lst) {
    final List<String> urls = new LinkedList<String>();
    for (final String ele : lst) {
      urls.addAll(StrUtils.splitSmart(ele, '|'));
    }
    
    if (whitelistHostChecker.isWhitelistHostCheckingEnabled() && rb.req.getCore().getCoreContainer().getZkController() == null && !whitelistHostChecker.hasExplicitWhitelist()) {
      throw new SolrException(ErrorCode.FORBIDDEN, "TermsComponent "+HttpShardHandlerFactory.INIT_SHARDS_WHITELIST
          +" not configured but required when using the '"+ShardParams.SHARDS+"' parameter with the TermsComponent."
          +HttpShardHandlerFactory.SET_SOLR_DISABLE_SHARDS_WHITELIST_CLUE);
    } else {
      ClusterState cs = null;
      if (rb.req.getCore().getCoreContainer().getZkController() != null) {
        cs = rb.req.getCore().getCoreContainer().getZkController().getClusterState();
      }
      whitelistHostChecker.checkWhitelist(cs, urls.toString(), urls);
    }
  }

