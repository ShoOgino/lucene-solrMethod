    public void close() {
      if (doClose) {
        zkClient.close();
      }
      try {
        out.flush();
      } catch (Exception e) {
        throw new RuntimeException(e);
      }
    }

