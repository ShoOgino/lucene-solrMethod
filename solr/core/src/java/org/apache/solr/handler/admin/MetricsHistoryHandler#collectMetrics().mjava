  private void collectMetrics() {
    log.debug("-- collectMetrics");
    try {
      checkSystemCollection();
    } catch (Exception e) {
      log.warn("Error checking for .system collection, keeping metrics history in memory", e);
      factory.setPersistent(false);
    }
    // get metrics
    collectLocalReplicaMetrics();
    collectGlobalMetrics();
  }

