    @SuppressWarnings({"unchecked"})
    public Tuple read() {
      if (sendEOF) {
        @SuppressWarnings({"rawtypes"})
        Map m = new HashMap();
        m.put("EOF", true);
        return new Tuple(m);
      } else {
        sendEOF = true;
        @SuppressWarnings({"rawtypes"})
        Map m = new HashMap();
        m.put("DaemonOp", message);
        return new Tuple(m);
      }
    }

