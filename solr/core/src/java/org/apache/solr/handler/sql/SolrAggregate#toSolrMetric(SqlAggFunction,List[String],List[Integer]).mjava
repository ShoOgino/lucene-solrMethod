  private Metric toSolrMetric(SqlAggFunction aggregation, List<String> inNames, List<Integer> args) {
    switch (args.size()) {
      case 0:
        if(aggregation.equals(SqlStdOperatorTable.COUNT)) {
          return new CountMetric();
        }
      case 1:
        final String inName = inNames.get(args.get(0));
        if (aggregation.equals(SqlStdOperatorTable.SUM) || aggregation.equals(SqlStdOperatorTable.SUM0)) {
          return new SumMetric(inName);
        } else if (aggregation.equals(SqlStdOperatorTable.MIN)) {
          return new MinMetric(inName);
        } else if (aggregation.equals(SqlStdOperatorTable.MAX)) {
          return new MaxMetric(inName);
        } else if (aggregation.equals(SqlStdOperatorTable.AVG)) {
          return new MeanMetric(inName);
        }
      default:
        throw new AssertionError("Invalid aggregation " + aggregation + " with args " + args + " with names" + inNames);
    }
  }

