    private Map<String, Elevation> buildElevationMap(Map<ElevatingQuery, ElevationBuilder> elevationBuilderMap) {
      Map<String, Elevation> elevationMap = Maps.newHashMapWithExpectedSize(elevationBuilderMap.size());
      for (Map.Entry<ElevatingQuery, ElevationBuilder> entry : elevationBuilderMap.entrySet()) {
        ElevatingQuery elevatingQuery = entry.getKey();
        if (elevatingQuery.subsetMatch) {
          throw new UnsupportedOperationException("Subset matching is not supported by " + getClass().getName());
        }
        String analyzedQuery = analyzeQuery(elevatingQuery.queryString);
        Elevation elevation = entry.getValue().build();
        Elevation duplicateElevation = elevationMap.put(analyzedQuery, elevation);
        if (duplicateElevation != null) {
          throw new IllegalArgumentException("Duplicate elevation for query.  Analyzed: \"" + analyzedQuery + "\"" +
              " Original: \"" + elevatingQuery.queryString + "\"");
        }
      }
      return Collections.unmodifiableMap(elevationMap);
    }

