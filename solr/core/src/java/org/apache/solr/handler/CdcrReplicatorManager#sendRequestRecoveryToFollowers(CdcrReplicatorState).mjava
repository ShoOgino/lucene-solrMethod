  private void sendRequestRecoveryToFollowers(CdcrReplicatorState state) throws SolrServerException, IOException {
    Collection<Slice> slices = state.getClient().getZkStateReader().getClusterState().getCollection(state.getTargetCollection()).getActiveSlices();
    for (Slice slice : slices) {
      Collection<Replica> replicas = slice.getReplicas();
      for (Replica replica : replicas) {
        if (slice.getLeader().getCoreName().equals(replica.getCoreName())) {
          continue; // no need to request recovery for leader
        }
        sendRequestRecoveryToFollower(state.getClient(), replica.getCoreName());
        log.info("RequestRecovery cmd is issued by core: " + replica.getCoreName() + " of shard: " + slice.getName() +
            "for target: " + state.getTargetCollection());
      }
    }
  }

