  @Override
  public void close() {
    if (log.isDebugEnabled()) {
      log.debug("Closing {}", hashCode());
    }
    if (collectService != null) {
      boolean shutdown = false;
      while (!shutdown) {
        try {
          // Wait a while for existing tasks to terminate
          collectService.shutdownNow();
          shutdown = collectService.awaitTermination(5, TimeUnit.SECONDS);
        } catch (InterruptedException ie) {
          // Preserve interrupt status
          Thread.currentThread().interrupt();
        }
      }
    }
    if (factory != null) {
      factory.close();
    }
    knownDbs.clear();
  }

