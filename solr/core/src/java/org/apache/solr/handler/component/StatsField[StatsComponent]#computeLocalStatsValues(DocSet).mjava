  /**
   * Computes the {@link StatsValues} for this {@link StatsField} relative to the 
   * specified {@link DocSet} 
   * @see #computeBaseDocSet
   */
  public StatsValues computeLocalStatsValues(DocSet base) throws IOException {

    if (sf.multiValued() || sf.getType().multiValuedFieldCache()) {
      // TODO: should this also be used for single-valued string fields? (should work fine)
      return DocValuesStats.getCounts(searcher, fieldName, base, calcDistinct, facets);
    } else {
      return getFieldCacheStats(base);
    }
  }

