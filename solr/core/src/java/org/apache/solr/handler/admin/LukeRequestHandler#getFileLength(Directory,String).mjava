  private static long getFileLength(Directory dir, String filename) {
    try {
      return dir.fileLength(filename);
    } catch (IOException e) {
      // Whatever the error is, only log it and return -1.
      log.warn("Error getting file length for [{}]", filename, e);
      return -1;
    }
  }

