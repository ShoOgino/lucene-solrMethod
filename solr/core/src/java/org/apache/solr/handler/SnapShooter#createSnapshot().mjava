  public NamedList createSnapshot() throws Exception {
    IndexCommit indexCommit;
    if (commitName != null) {
      indexCommit = getIndexCommitFromName();
      return createSnapshot(indexCommit);
    } else {
      indexCommit = getIndexCommit();
      IndexDeletionPolicyWrapper deletionPolicy = solrCore.getDeletionPolicy();
      deletionPolicy.saveCommitPoint(indexCommit.getGeneration());
      try {
        return createSnapshot(indexCommit);
      } finally {
        deletionPolicy.releaseCommitPoint(indexCommit.getGeneration());
      }
    }
  }

