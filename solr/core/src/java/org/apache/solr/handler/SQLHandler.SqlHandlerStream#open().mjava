    public void open() throws IOException {
      Properties properties = new Properties();
      // Add all query parameters
      Iterator<String> parameterNamesIterator = params.getParameterNamesIterator();
      while(parameterNamesIterator.hasNext()) {
        String param = parameterNamesIterator.next();
        properties.setProperty(param, params.get(param));
      }

      // Set these last to ensure that they are set properly
      properties.setProperty("lex", "MYSQL");
      properties.setProperty("zk", defaultZkhost);

      try {
        Class.forName(CalciteSolrDriver.class.getCanonicalName());
      } catch (ClassNotFoundException e) {
        throw new IOException(e);
      }

      try {
        connection = DriverManager.getConnection("jdbc:calcitesolr:", properties);
        statement = connection.createStatement();
        resultSet = statement.executeQuery(sql);
        resultSetMetaData = this.resultSet.getMetaData();
        numColumns = resultSetMetaData.getColumnCount();
      } catch (SQLException e) {
        this.close();
        throw new IOException(e);
      }
    }

