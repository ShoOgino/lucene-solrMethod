  // Not thread safe... don't use in Callable.
  // Don't modify the returned URL list.
  private List<String> getURLs(ShardRequest sreq, String shard) {
    List<String> urls = shardToURLs.get(shard);
    if (urls == null) {
      urls = httpShardHandlerFactory.makeURLList(shard);
      preferCurrentHostForDistributedReq(sreq, urls);
      shardToURLs.put(shard, urls);
    }
    return urls;
  }

