    @Override
    public Tuple read() throws IOException {
      // Return a metadata tuple as the first tuple and then pass through to the JDBCStream.
      if(includeMetadata && firstTuple) {
        try {
          Map<String, Object> fields = new HashMap<>();

          firstTuple = false;

          ResultSetMetaData resultSetMetaData = resultSet.getMetaData();

          List<String> metadataFields = new ArrayList<>();
          Map<String, String> metadataAliases = new HashMap<>();
          for(int i = 1; i <= resultSetMetaData.getColumnCount(); i++) {
            String columnName = resultSetMetaData.getColumnName(i);
            String columnLabel = resultSetMetaData.getColumnLabel(i);
            metadataFields.add(columnName);
            metadataAliases.put(columnName, columnLabel);
          }

          fields.put("isMetadata", true);
          fields.put("fields", metadataFields);
          fields.put("aliases", metadataAliases);
          return new Tuple(fields);
        } catch (SQLException e) {
          throw new IOException(e);
        }
      } else {
        return super.read();
      }
    }

