  /**
   * Analyzes the provided query string and returns a space concatenation of the analyzed tokens.
   */
  public String analyzeQuery(String query) {
    //split query terms with analyzer then join
    StringBuilder norm = new StringBuilder();
    try (TokenStream tokens = queryAnalyzer.tokenStream("", query)) {
      tokens.reset();
      CharTermAttribute termAtt = tokens.addAttribute(CharTermAttribute.class);
      while (tokens.incrementToken()) {
        norm.append(termAtt);
      }
      tokens.end();
    } catch (IOException e) {
      Throwables.propagate(e);
    }
    return norm.toString();
  }

