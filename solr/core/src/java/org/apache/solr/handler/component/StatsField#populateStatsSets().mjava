  /**
   * A helper method which inspects the {@link #localParams} associated with this StatsField, 
   * and uses them to populate the {@link #statsInResponse} and {@link #statsToCalculate} data 
   * structures
   */
  private void populateStatsSets() {
    
    boolean statSpecifiedByLocalParam = false;
    // local individual stat
    Iterator<String> itParams = localParams.getParameterNamesIterator();
    while (itParams.hasNext()) {
      String paramKey = itParams.next();
        Stat stat = Stat.forName(paramKey);
        if (stat != null) {
          statSpecifiedByLocalParam = true;
          // TODO: this isn't going to work for planned "non-boolean' stats - eg: SOLR-6350, SOLR-6968
          if (localParams.getBool(paramKey, false)) {
            statsInResponse.add(stat);
            statsToCalculate.addAll(stat.getDistribDeps());
          }
        }
    }
    
    // if no individual stat setting. 
    if ( ! statSpecifiedByLocalParam ) {
      statsInResponse.addAll(DEFAULT_STATS);
      for (Stat stat : statsInResponse) {
        statsToCalculate.addAll(stat.getDistribDeps());
      }
    }

    // calcDistinct has special "default" behavior using top level CalcDistinct param
    if (topLevelCalcDistinct && localParams.getBool(Stat.calcdistinct.toString(), true)) {
      statsInResponse.add(Stat.calcdistinct);
      statsToCalculate.addAll(Stat.calcdistinct.getDistribDeps());
    }
  }

