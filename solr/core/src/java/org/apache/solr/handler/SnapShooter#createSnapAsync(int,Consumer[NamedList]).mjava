  public void createSnapAsync(final int numberToKeep, Consumer<NamedList> result) throws IOException {
    //TODO should use Solr's ExecutorUtil
    new Thread(() -> {
      try {
        result.accept(createSnapshot());
      } catch (Exception e) {
        log.error("Exception while creating snapshot", e);
        NamedList snapShootDetails = new NamedList<>();
        snapShootDetails.add("exception", e.getMessage());
        result.accept(snapShootDetails);
      }
      if (snapshotName == null) {
        try {
          deleteOldBackups(numberToKeep);
        } catch (IOException e) {
          log.warn("Unable to delete old snapshots ", e);
        }
      }
    }).start();

  }

