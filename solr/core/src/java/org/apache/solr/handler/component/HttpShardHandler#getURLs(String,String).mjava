  // Not thread safe... don't use in Callable.
  // Don't modify the returned URL list.
  private List<String> getURLs(String shard, String preferredHostAddress) {
    List<String> urls = shardToURLs.get(shard);
    if (urls == null) {
      urls = httpShardHandlerFactory.makeURLList(shard);
      if (preferredHostAddress != null && urls.size() > 1) {
        preferCurrentHostForDistributedReq(preferredHostAddress, urls);
      }
      shardToURLs.put(shard, urls);
    }
    return urls;
  }

