  /**
   * Returns the effective {@link LegacyNumericType} for the field for the purposes of hash values.
   * ie: If the field has an explict LegacyNumericType that is returned; If the field has no explicit
   * LegacyNumericType then {@link LegacyNumericType#LONG} is returned;  If field is null, then
   * {@link LegacyNumericType#FLOAT} is assumed for ValueSource.
   */
  private static LegacyNumericType getHashableNumericType(SchemaField field) {
    if (null == field) {
      return LegacyNumericType.FLOAT;
    }
    final LegacyNumericType result = field.getType().getNumericType();
    return null == result ? LegacyNumericType.LONG : result;
  }

