  private String getFields(List<Map.Entry<String, Class>> fields) {
    StringBuilder buf = new StringBuilder();
    boolean appendVersion = true;
    for(Map.Entry<String, Class> field : fields) {

      if(buf.length() > 0) {
        buf.append(",");
      }

      if(field.getKey().equals("_version_")) {
        appendVersion = false;
      }

      buf.append(field.getKey());
    }

    if(appendVersion){
      buf.append(",_version_");
    }

    return buf.toString();
  }

