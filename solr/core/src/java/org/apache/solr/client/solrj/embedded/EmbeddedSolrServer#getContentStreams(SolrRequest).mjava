  private Set<ContentStream> getContentStreams(SolrRequest request) throws IOException {
    if (request.getMethod() == SolrRequest.METHOD.GET) return null;
    if (request instanceof ContentStreamUpdateRequest) {
      ContentStreamUpdateRequest csur = (ContentStreamUpdateRequest) request;
      Collection<ContentStream> cs = csur.getContentStreams();
      if (cs != null) return new HashSet<>(cs);
    }
    RequestWriter.ContentWriter contentWriter = request.getContentWriter(CommonParams.JAVABIN_MIME);
    final String cType = contentWriter == null ? CommonParams.JAVABIN_MIME : contentWriter.getContentType();

    return Collections.singleton(new ContentStreamBase() {

      @Override
      public InputStream getStream() throws IOException {
        BAOS baos = new BAOS();
        if (contentWriter != null) {
          contentWriter.write(baos);
        } else {
          new BinaryRequestWriter().write(request, baos);
        }
        return new ByteArrayInputStream(baos.toByteArray());
      }

      @Override
      public String getContentType() {
        return cType;

      }
    });
  }

