  @Override
  protected void init(IndexSchema schema, Map<String, String> args) {
    restrictProps(SORT_MISSING_FIRST | SORT_MISSING_LAST);
    // valType has never been used for anything except to throw an error, so make it optional since the
    // code (see getValueSource) gives you a FileFloatSource.
    String ftypeS = args.remove("valType");
    if (ftypeS != null) {
      ftype = schema.getFieldTypes().get(ftypeS);
      if (ftype != null && !(ftype instanceof FloatField) && !(ftype instanceof TrieFloatField)) {
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,
            "Only float and pfloat (Trie|Float)Field are currently supported as external field type.  Got " + ftypeS);
      }
    }
    keyFieldName = args.remove("keyField");
    String defValS = args.remove("defVal");
    defVal = defValS == null ? 0 : Float.parseFloat(defValS);
    this.schema = schema;
  }

