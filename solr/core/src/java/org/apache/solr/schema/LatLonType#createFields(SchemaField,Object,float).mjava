  @Override
  public StorableField[] createFields(SchemaField field, Object value, float boost) {
    String externalVal = value.toString();
    //we could have tileDiff + 3 fields (two for the lat/lon, one for storage)
    StorableField[] f = new StorableField[(field.indexed() ? 2 : 0) + (field.stored() ? 1 : 0)];
    if (field.indexed()) {
      int i = 0;
      double[] latLon;
      try {
        latLon = ParseUtils.parseLatitudeLongitude(null, externalVal);
      } catch (InvalidShapeException e) {
        throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, e);
      }
      //latitude
      SchemaField lat = subField(field, i);
      f[i] = lat.createField(String.valueOf(latLon[LAT]), lat.indexed() && !lat.omitNorms() ? boost : 1f);
      i++;
      //longitude
      SchemaField lon = subField(field, i);
      f[i] = lon.createField(String.valueOf(latLon[LON]), lon.indexed() && !lon.omitNorms() ? boost : 1f);

    }

    if (field.stored()) {
      FieldType customType = new FieldType();
      customType.setStored(true);
      f[f.length - 1] = createField(field.getName(), externalVal, customType, 1f);
    }
    return f;
  }

