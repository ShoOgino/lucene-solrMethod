  /**Take in a JSON command set and execute them . It tries to capture as many errors
   * as possible instead of failing at the frst error it encounters
   * @param rdr The input as a Reader
   * @return Lis of errors . If the List is empty then the operation is successful.
   */
  public List performOperations(Reader rdr) throws Exception {
    List<CommandOperation> ops = null;
    try {
      ops = CommandOperation.parse(rdr);
    } catch (Exception e) {
      String msg= "Error parsing schema operations ";
      log.warn(msg  ,e );
      return Collections.singletonList(singletonMap(CommandOperation.ERR_MSGS, msg + ":" + e.getMessage()));
    }
    List errs = CommandOperation.captureErrors(ops);
    if(!errs.isEmpty()) return errs;

    IndexSchema schema = req.getCore().getLatestSchema();
    if (!(schema instanceof ManagedIndexSchema)) {
      return singletonList( singletonMap(CommandOperation.ERR_MSGS,"schema is not editable"));
    }

    synchronized (schema.getSchemaUpdateLock()) {
      return doOperations(ops);
    }

  }

