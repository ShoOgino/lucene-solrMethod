  public SolrCore reload(ConfigSet coreConfig) throws IOException {
    solrCoreState.increfSolrCoreState();
    final SolrCore currentCore;
    if (!getNewIndexDir().equals(getIndexDir())) {
      // the directory is changing, don't pass on state
      currentCore = null;
    } else {
      currentCore = this;
    }

    boolean success = false;
    SolrCore core = null;
    try {
      CoreDescriptor cd = new CoreDescriptor(coreDescriptor.getName(), coreDescriptor);
      cd.loadExtraProperties(); //Reload the extra properties
      core = new SolrCore(getName(), getDataDir(), coreConfig.getSolrConfig(),
          coreConfig.getIndexSchema(), coreConfig.getProperties(),
          cd, updateHandler, solrDelPolicy, currentCore);
      
      // we open a new IndexWriter to pick up the latest config
      core.getUpdateHandler().getSolrCoreState().newIndexWriter(core, false);
      
      core.getSearcher(true, false, null, true);
      success = true;
      return core;
    } finally {
      // close the new core on any errors that have occurred.
      if (!success) {
        IOUtils.closeQuietly(core);
      }
    }
  }

