  private boolean updatePackages(Map<String, Object> properties, int ver) {
    Map m = (Map) properties.getOrDefault(PACKAGE, Collections.emptyMap());
    if (pkgs.isEmpty() && m.isEmpty()) return false;
    boolean[] needsReload = new boolean[1];
    if (m.size() == pkgs.size()) {
      m.forEach((k, v) -> {
        if (v instanceof Map) {
          Package pkg = pkgs.get(k);
          if (pkg == null || pkg.isModified((Map) v)) {
            needsReload[0] = true;
          }
        }
      });
    } else {
      needsReload[0] = true;
    }
    if (needsReload[0]) {
      createNewClassLoaders(m, ver);
    }
    return needsReload[0];
  }

