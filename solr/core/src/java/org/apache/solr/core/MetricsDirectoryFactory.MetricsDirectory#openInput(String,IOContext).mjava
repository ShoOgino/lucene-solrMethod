    @Override
    public IndexInput openInput(String name, IOContext context) throws IOException {
      IndexInput input = in.openInput(name, context);
      if (!directoryTotals) {
        return input;
      }
      if (input != null) {
        return new MetricsInput(totalReads, totalReadSizes, metricManager, registry, getMetricName(name, false), input);
      } else {
        return null;
      }
    }

