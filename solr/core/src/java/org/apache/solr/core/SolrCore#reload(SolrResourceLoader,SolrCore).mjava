  public SolrCore reload(SolrResourceLoader resourceLoader, SolrCore prev) throws IOException,
      ParserConfigurationException, SAXException {
    
    SolrConfig config = new SolrConfig(resourceLoader,
        getSolrConfig().getName(), null);
    
    IndexSchema schema = new IndexSchema(config,
        getSchema().getResourceName(), null);
    
    solrCoreState.increfSolrCoreState();
    
    if (!getNewIndexDir().equals(getIndexDir())) {
      // the directory is changing, don't pass on state
      prev = null;
    }
    
    SolrCore core = new SolrCore(getName(), getDataDir(), config,
        schema, coreDescriptor, updateHandler, prev);
    core.solrDelPolicy = this.solrDelPolicy;
    
    core.getUpdateHandler().getSolrCoreState().newIndexWriter(core, false, false);
    
    core.getSearcher(true, false, null, true);
    
    return core;
  }

