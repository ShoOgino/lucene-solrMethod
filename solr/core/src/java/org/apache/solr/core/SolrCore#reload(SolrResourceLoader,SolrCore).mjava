  public SolrCore reload(SolrResourceLoader resourceLoader, SolrCore prev) throws IOException,
      ParserConfigurationException, SAXException {
    
    SolrConfig config = new SolrConfig(resourceLoader, getSolrConfig().getName(), null);
    
    IndexSchema schema = IndexSchemaFactory.buildIndexSchema(getLatestSchema().getResourceName(), config);
    
    solrCoreState.increfSolrCoreState();
    
    if (!getNewIndexDir().equals(getIndexDir())) {
      // the directory is changing, don't pass on state
      prev = null;
    }
    
    SolrCore core = new SolrCore(getName(), getDataDir(), config,
        schema, coreDescriptor, updateHandler, this.solrDelPolicy, prev);
    core.solrDelPolicy = this.solrDelPolicy;
    
    core.getUpdateHandler().getSolrCoreState().newIndexWriter(core, false);
    
    core.getSearcher(true, false, null, true);
    
    return core;
  }

