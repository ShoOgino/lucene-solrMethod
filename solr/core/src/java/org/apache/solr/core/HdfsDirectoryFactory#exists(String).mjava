  @Override
  public boolean exists(String path) {
    final Path hdfsDirPath = new Path(path);
    final Configuration conf = getConf();
    FileSystem fileSystem = null;
    try {
      // no need to close the fs, the cache will do it
      fileSystem = tmpFsCache.get(path, () -> FileSystem.get(hdfsDirPath.toUri(), conf));
    } catch (ExecutionException e) {
      throw new RuntimeException(e);
    }

    try {
      return fileSystem.exists(hdfsDirPath);
    } catch (IOException e) {
      LOG.error("Error checking if hdfs path exists", e);
      throw new RuntimeException("Error checking if hdfs path exists", e);
    }
  }

