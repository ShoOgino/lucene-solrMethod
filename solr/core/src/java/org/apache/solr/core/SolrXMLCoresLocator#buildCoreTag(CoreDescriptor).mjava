  /**
   * Serialize a coredescriptor as a String containing an XML &lt;core> tag.
   * @param cd the CoreDescriptor
   * @return an XML representation of the CoreDescriptor
   */
  protected static String buildCoreTag(CoreDescriptor cd) {

    StringBuilder builder = new StringBuilder(NEWLINE).append(INDENT).append("<core");
    for (Map.Entry<Object, Object> entry : cd.getPersistableStandardProperties().entrySet()) {
      builder.append(" ").append(entry.getKey()).append("=\"").append(entry.getValue()).append("\"");
    }

    Properties userProperties = cd.getPersistableUserProperties();
    if (userProperties.isEmpty()) {
      return builder.append("/>").append(NEWLINE).toString();
    }

    builder.append(">").append(NEWLINE);
    for (Map.Entry<Object, Object> entry : userProperties.entrySet()) {
      builder.append(INDENT).append(INDENT)
          .append("<property name=\"").append(entry.getKey()).append("\" value=\"")
          .append(entry.getValue()).append("\"/>").append(NEWLINE);
    }

    return builder.append("</core>").append(NEWLINE).toString();

  }

