  public void exportSnapshot(String collectionName, String snapshotName, String destPath, Optional<String> backupRepo,
      Optional<String> asyncReqId) {
    try {
      CollectionAdminRequest.Backup backup = new CollectionAdminRequest.Backup(collectionName, snapshotName);
      backup.setIndexBackupStrategy(CollectionAdminParams.COPY_FILES_STRATEGY);
      backup.setLocation(destPath);
      if (backupRepo.isPresent()) {
        backup.setRepositoryName(backupRepo.get());
      }
      if (asyncReqId.isPresent()) {
        backup.setAsyncId(asyncReqId.get());
      }
      CollectionAdminResponse resp = backup.process(solrClient);
      Preconditions.checkState(resp.getStatus() == 0, "The request failed. The status code is " + resp.getStatus());
    } catch (Exception e) {
      log.error("Failed to backup collection meta-data for collection " + collectionName, e);
      System.out.println("Failed to backup collection meta-data for collection " + collectionName
          + " due to following error : " + e.getLocalizedMessage());
      System.exit(1);
    }
  }

