  /**
   *  Package local for unit tests only please do not use elsewhere
   */
  ByteBuffer fetchBlob(String key) {
    Replica replica = getSystemCollReplica();
    String url = replica.getStr(BASE_URL_PROP) + "/" + CollectionAdminParams.SYSTEM_COLL + "/blob/" + key + "?wt=filestream";

    HttpClient httpClient = coreContainer.getUpdateShardHandler().getHttpClient();
    HttpGet httpGet = new HttpGet(url);
    ByteBuffer b;
    try {
      HttpResponse entity = httpClient.execute(httpGet);
      int statusCode = entity.getStatusLine().getStatusCode();
      if (statusCode != 200) {
        throw new SolrException(SolrException.ErrorCode.NOT_FOUND, "no such blob or version available: " + key);
      }
      try (InputStream is = entity.getEntity().getContent()) {
        b = SimplePostTool.inputStreamToByteArray(is);
      }
    } catch (Exception e) {
      if (e instanceof SolrException) {
        throw (SolrException) e;
      } else {
        throw new SolrException(SolrException.ErrorCode.NOT_FOUND, "could not load : " + key, e);
      }
    } finally {
      httpGet.releaseConnection();
    }
    return b;
  }

