    @Override
    public IndexOutput createTempOutput(String prefix, String suffix, IOContext context) throws IOException {
      IndexOutput output = in.createTempOutput(prefix, suffix, context);
      if (!directoryTotals) {
        return output;
      }
      if (output != null) {
        return new MetricsOutput(totalWrites, totalWriteSizes, metricManager, registry, getMetricName(TEMP, true), output);
      } else {
        return null;
      }
    }

