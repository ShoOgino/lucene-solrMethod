  private void initCoreList(CoreContainer container) throws IOException {
    
    coreNodes = (NodeList) config.evaluate("solr/cores/core",
        XPathConstants.NODESET);
    // Check a couple of error conditions
    Set<String> names = new HashSet<String>(); // for duplicate names
    Map<String,String> dirs = new HashMap<String,String>(); // for duplicate
                                                            // data dirs.
    
    for (int idx = 0; idx < coreNodes.getLength(); ++idx) {
      Node node = coreNodes.item(idx);
      String name = DOMUtil.getAttr(node, CoreDescriptor.CORE_NAME, null);
      String dataDir = DOMUtil.getAttr(node, CoreDescriptor.CORE_DATADIR, null);
      if (name != null) {
        if (!names.contains(name)) {
          names.add(name);
        } else {
          String msg = String.format(Locale.ROOT,
              "More than one core defined for core named %s", name);
          log.error(msg);
        }
      }

      String instDir = DOMUtil.getAttr(node, CoreDescriptor.CORE_INSTDIR, null);
      if (dataDir != null && instDir != null) { // this won't load anyway if instDir not specified.

        String absData = new File(instDir, dataDir).getCanonicalPath();
        if (!dirs.containsKey(absData)) {
          dirs.put(absData, name);
        } else {
          String msg = String
              .format(
                  Locale.ROOT,
                  "More than one core points to data dir %s. They are in %s and %s",
                  absData, dirs.get(absData), name);
          log.warn(msg);
        }
      }
    }
    
  }

