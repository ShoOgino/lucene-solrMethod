  private DirectoryFactory initDirectoryFactory() {
    final PluginInfo info = solrConfig.getPluginInfo(DirectoryFactory.class.getName());
    final DirectoryFactory dirFactory;
    if (info != null) {
      log.debug(info.className);
      dirFactory = getResourceLoader().newInstance(info.className, DirectoryFactory.class);
      // allow DirectoryFactory instances to access the CoreContainer
      dirFactory.initCoreContainer(getCoreDescriptor().getCoreContainer());
      dirFactory.init(info.initArgs);
    } else {
      log.debug("solr.NRTCachingDirectoryFactory");
      dirFactory = new NRTCachingDirectoryFactory();
      dirFactory.initCoreContainer(getCoreDescriptor().getCoreContainer());
    }
    if (solrConfig.indexConfig.metricsInfo != null && solrConfig.indexConfig.metricsInfo.isEnabled()) {
      final DirectoryFactory factory = new MetricsDirectoryFactory(coreDescriptor.getCoreContainer().getMetricManager(),
          coreMetricManager.getRegistryName(), dirFactory);
        factory.init(solrConfig.indexConfig.metricsInfo.initArgs);
      return factory;
    } else {
      return dirFactory;
    }
  }

