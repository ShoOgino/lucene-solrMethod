    private String getMetricName(String name, boolean output) {
      if (!directoryDetails) {
        return null;
      }
      String lastName;
      if (name.startsWith(SEGMENTS_PREFIX) || name.startsWith(PENDING_SEGMENTS_PREFIX)) {
        lastName = SEGMENTS;
      } else {
        int pos = name.lastIndexOf('.');
        if (pos != -1 && name.length() > pos + 1) {
          lastName = name.substring(pos + 1);
        } else {
          lastName = OTHER;
        }
      }
      StringBuilder sb = new StringBuilder(PREFIX);
      sb.append(lastName);
      sb.append('.');
      if (output) {
        sb.append("write");
      } else {
        sb.append("read");
      }
      return sb.toString();
    }

