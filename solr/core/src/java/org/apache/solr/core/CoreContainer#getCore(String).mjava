  /** Gets a core by name and increase its refcount.
   * @see SolrCore#close() 
   * @param name the core name
   * @return the core if found
   */
  public SolrCore getCore(String name) {

    name = checkDefault(name);
    // Do this in two phases since we don't want to lock access to the cores over a load.
    SolrCore core = coreMaps.getCoreFromAnyList(name);

    if (core != null) return core;

    // OK, it's not presently in any list, is it in the list of dynamic cores but not loaded yet? If so, load it.
    CoreDescriptor desc = coreMaps.getDynamicDescriptor(name);
    if (desc == null) { //Nope, no transient core with this name
      return null;
    }

    core = coreMaps.waitPendingCoreOps(name); // This will put an entry in pending core ops if the core isn't loaded

    if (isShutDown) return null; // We're quitting, so stop. This needs to be after the wait above since we may come off
                                 // the wait as a consequence of shutting down.

    if (core == null) {
      try {
        core = create(desc); // This should throw an error if it fails.
        core.open();
        registerCore(desc.isTransient(), name, core, false);
      } catch (Exception ex) {
        throw recordAndThrow(name, "Unable to create core: " + name, ex);
      } finally {
        coreMaps.releasePending(name);
      }
    }
    return core;
  }

