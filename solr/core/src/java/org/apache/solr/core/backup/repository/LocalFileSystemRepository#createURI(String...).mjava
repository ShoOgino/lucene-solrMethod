  @Override
  public URI createURI(String... pathComponents) {
    Preconditions.checkArgument(pathComponents.length > 0);

    String basePath = Preconditions.checkNotNull(pathComponents[0]);
    // Note the URI.getPath() invocation on Windows platform generates an invalid URI.
    // Refer to http://stackoverflow.com/questions/9834776/java-nio-file-path-issue
    // Since the caller may have used this method to generate the string representation
    // for the pathComponents, we implement a work-around specifically for Windows platform
    // to remove the leading '/' character.
    if (Constants.WINDOWS) {
      basePath = basePath.replaceFirst("^/(.:/)", "$1");
    }

    Path result = Paths.get(basePath);
    for (int i = 1; i < pathComponents.length; i++) {
      result = result.resolve(pathComponents[i]);
    }

    return result.toUri();
  }

