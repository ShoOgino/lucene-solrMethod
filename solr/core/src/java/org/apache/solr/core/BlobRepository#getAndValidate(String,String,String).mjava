  private ByteBuffer getAndValidate(String key, String url, String sha256) throws IOException {
    ByteBuffer byteBuffer = fetchFromUrl(key, url);
    String computedDigest = sha256Digest(byteBuffer);
    if (!computedDigest.equals(sha256)) {
      throw new SolrException(SERVER_ERROR, StrUtils.formatString(INVALID_JAR_MSG, url, sha256, computedDigest));
    }
    File file = new File(getBlobsPath().toFile(), sha256);
    try (FileOutputStream fos = new FileOutputStream(file)) {
      fos.write(byteBuffer.array(), byteBuffer.arrayOffset(), byteBuffer.limit());
      IOUtils.fsync(file.toPath(), false);
    }
    return byteBuffer;
  }

