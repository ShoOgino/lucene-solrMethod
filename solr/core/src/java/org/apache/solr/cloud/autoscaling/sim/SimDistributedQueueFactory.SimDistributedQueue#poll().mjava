    @Override
    public byte[] poll() throws Exception {
      Timer.Context time = stats.time(dir + "_poll");
      updateLock.lockInterruptibly();
      try {
        Pair<String, byte[]>  pair = queue.poll();
        if (pair != null) {
          changed.signalAll();
          return pair.second();
        } else {
          return null;
        }
      } finally {
        updateLock.unlock();
        time.stop();
      }
    }

