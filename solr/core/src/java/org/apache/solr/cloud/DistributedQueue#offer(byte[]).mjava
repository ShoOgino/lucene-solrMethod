  /**
   * Inserts data into queue.
   * 
   * @return true if data was successfully added
   */
  public boolean offer(byte[] data) throws KeeperException,
      InterruptedException {
    for (;;) {
      try {
        zookeeper.create(dir + "/" + prefix, data, acl,
            CreateMode.PERSISTENT_SEQUENTIAL, true);
        return true;
      } catch (KeeperException.NoNodeException e) {
        try {
          zookeeper.create(dir, new byte[0], acl, CreateMode.PERSISTENT, true);
        } catch (KeeperException.NodeExistsException ne) {
        //someone created it
        }
      }
    }

    
    
  }

