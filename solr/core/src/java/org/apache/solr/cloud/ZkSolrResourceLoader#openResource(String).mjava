  /**
   * Opens any resource by its name. By default, this will look in multiple
   * locations to load the resource: $configDir/$resource from ZooKeeper.
   * It will look for it in any jar
   * accessible through the class loader if it cannot be found in ZooKeeper. 
   * Override this method to customize loading resources.
   * 
   * @return the stream for the named resource
   */
  @Override
  public InputStream openResource(String resource) {
    InputStream is = null;
    String file = collectionZkPath + "/" + resource;
    try {
      if (zkController.pathExists(file)) {
        byte[] bytes = zkController.getZkClient().getData(collectionZkPath + "/" + resource, null, null, true);
        return new ByteArrayInputStream(bytes);
      }
    } catch (Exception e) {
      throw new RuntimeException("Error opening " + file, e);
    }
    try {
      // delegate to the class loader (looking into $INSTANCE_DIR/lib jars)
      is = classLoader.getResourceAsStream(resource);
    } catch (Exception e) {
      throw new RuntimeException("Error opening " + resource, e);
    }
    if (is == null) {
      throw new RuntimeException("Can't find resource '" + resource
          + "' in classpath or '" + collectionZkPath + "', cwd="
          + System.getProperty("user.dir"));
    }
    return is;
  }

