    private TriggerListeners(Map<String, Map<TriggerEventProcessorStage, List<TriggerListener>>> listenersPerStage,
                             Map<String, TriggerListener> listenersPerName) {
      this.listenersPerStage = new HashMap<>();
      listenersPerStage.forEach((n, listeners) -> {
        Map<TriggerEventProcessorStage, List<TriggerListener>> perStage = this.listenersPerStage.computeIfAbsent(n, name -> new HashMap<>());
        listeners.forEach((s, lst) -> {
          List<TriggerListener> newLst = perStage.computeIfAbsent(s, stage -> new ArrayList<>());
          newLst.addAll(lst);
        });
      });
      this.listenersPerName = new HashMap<>(listenersPerName);
    }

