  private void handleSetPolicies(SolrQueryRequest req, SolrQueryResponse rsp, CommandOperation op) throws KeeperException, InterruptedException {
    String policyName = op.getStr("name");

    if (policyName == null || policyName.trim().length() == 0) {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, "The policy name cannot be null or empty");
    }

    Set<String> keys = op.getDataMap().keySet();
    boolean isValid = false;
    for (String key : keys) {
      if (key.equals("conditions") || key.equals("preferences")) isValid = true;
      else if(!key.equals("name")){
        isValid = false;
        break;
      }
    }
    if (!isValid) {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,
          "No conditions or peferences are specified for the policy " + policyName);
    }

    zkSetPolicies(container.getZkController().getZkStateReader(), policyName, op.getValuesExcluding("name"));
    rsp.getValues().add("result", "success");
  }

