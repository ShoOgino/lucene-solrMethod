  @Override
  public void saveState() {
    Map<String,Object> state = Utils.getDeepCopy(getState(), 10, false, true);
    if (lastState != null && lastState.equals(state)) {
      // skip saving if identical
      return;
    }
    byte[] data = Utils.toJSON(state);
    String path = ZkStateReader.SOLR_AUTOSCALING_TRIGGER_STATE_PATH + "/" + getName();
    try {
      if (clusterDataProvider.hasData(path)) {
        // update
        clusterDataProvider.setData(path, data, -1);
      } else {
        // create
        clusterDataProvider.createData(path, data, CreateMode.PERSISTENT);
      }
      lastState = state;
    } catch (IOException e) {
      LOG.warn("Exception updating trigger state '" + path + "'", e);
    }
  }

