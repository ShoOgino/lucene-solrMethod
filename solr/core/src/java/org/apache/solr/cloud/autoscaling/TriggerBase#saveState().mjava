  @Override
  public void saveState() {
    Map<String,Object> state = deepCopyState();
    if (lastState != null && lastState.equals(state)) {
      // skip saving if identical
      return;
    }
    byte[] data = Utils.toJSON(state);
    String path = ZkStateReader.SOLR_AUTOSCALING_TRIGGER_STATE_PATH + "/" + getName();
    try {
      if (stateManager.hasData(path)) {
        // update
        stateManager.setData(path, data, -1);
      } else {
        // create
        stateManager.createData(path, data, CreateMode.PERSISTENT);
      }
      lastState = state;
    } catch (AlreadyExistsException e) {
      
    } catch (InterruptedException | BadVersionException | IOException | KeeperException e) {
      log.warn("Exception updating trigger state '" + path + "'", e);
    }
  }

