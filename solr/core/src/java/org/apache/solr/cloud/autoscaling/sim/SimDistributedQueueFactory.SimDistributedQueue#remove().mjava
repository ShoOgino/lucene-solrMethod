    @Override
    public byte[] remove() throws Exception {
      Timer.Context time = stats.time(dir + "_remove");
      updateLock.lockInterruptibly();
      try {
        byte[] res = queue.remove().second();
        changed.signalAll();
        return res;
      } finally {
        updateLock.unlock();
        time.stop();
      }
    }

