  /**
   * Populate this instance from another {@link DistribStateManager} instance.
   * @param other another instance
   * @param config optional {@link AutoScalingConfig}, which will overwrite any existing config.
   */
  public SnapshotDistribStateManager(DistribStateManager other, AutoScalingConfig config) throws Exception {
    List<String> tree = other.listTree("/");
    if (log.isDebugEnabled()) {
      log.debug("- copying {} resources from {}", tree.size(), other.getClass().getSimpleName());
    }
    for (String path : tree) {
      dataMap.put(path, other.getData(path));
    }
    if (config != null) { // overwrite existing
      VersionedData vd = new VersionedData(config.getZkVersion(), Utils.toJSON(config), CreateMode.PERSISTENT, "0");
      dataMap.put(ZkStateReader.SOLR_AUTOSCALING_CONF_PATH, vd);
    }
  }

