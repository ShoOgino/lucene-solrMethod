  @SuppressWarnings({"unchecked"})
  public static SnapshotCloudManager readSnapshot(File sourceDir) throws Exception {
    if (!sourceDir.exists()) {
      throw new Exception("Source path doesn't exist: " + sourceDir);
    }
    if (!sourceDir.isDirectory()) {
      throw new Exception("Source path is not a directory: " + sourceDir);
    }
    Map<String, Object> snapshot = new HashMap<>();
    List<String> allKeys = new ArrayList<>(REQUIRED_KEYS);
    allKeys.add(AUTOSCALING_JSON_KEY);
    int validData = 0;
    for (String key : allKeys) {
      File src = new File(sourceDir, key + ".json");
      if (src.exists()) {
        InputStream is = new FileInputStream(src);
        Map<String, Object> data = (Map<String, Object>)Utils.fromJSON(is);
        is.close();
        snapshot.put(key, data);
        if (REQUIRED_KEYS.contains(key)) {
          validData++;
        }
      }
    }
    if (validData < REQUIRED_KEYS.size()) {
      throw new Exception("Some data is missing - expected: " + REQUIRED_KEYS + ", found: " + snapshot.keySet());
    }
    return new SnapshotCloudManager(snapshot);
  }

