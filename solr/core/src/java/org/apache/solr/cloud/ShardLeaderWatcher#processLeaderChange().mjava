  private void processLeaderChange() throws KeeperException, InterruptedException {
    if(closed) return;
    try {
      byte[] data = zkClient.getData(path, this, null, true);
      if (data != null) {
        final ZkCoreNodeProps leaderProps = new ZkCoreNodeProps(ZkNodeProps.load(data));
        listener.announceLeader(collection, shard, leaderProps);
      }
    } catch (KeeperException ke) {
      //check if we lost connection or the node was gone
      if (ke.code() != Code.CONNECTIONLOSS && ke.code() != Code.SESSIONEXPIRED
          && ke.code() != Code.NONODE) {
        throw ke;
      }
    }
  }

