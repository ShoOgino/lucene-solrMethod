  @Override
  protected void setState(Map<String, Object> state) {
    this.lastEventMap.clear();
    Map<String, Long> replicaVsTime = (Map<String, Long>)state.get("lastEventMap");
    if (replicaVsTime != null) {
      this.lastEventMap.putAll(replicaVsTime);
    }
  }

