  @Override
  public List<String> listData(String path, Watcher watcher) throws NoSuchElementException, IOException, KeeperException, InterruptedException {
    final String prefix = path + "/";
    return dataMap.entrySet().stream()
        .filter(e -> e.getKey().startsWith(prefix))
        .map(e -> {
          String suffix = e.getKey().substring(prefix.length());
          int idx = suffix.indexOf('/');
          if (idx == -1) {
            return suffix;
          } else {
            return suffix.substring(0, idx);
          }
        })
        .collect(Collectors.toList());
  }

