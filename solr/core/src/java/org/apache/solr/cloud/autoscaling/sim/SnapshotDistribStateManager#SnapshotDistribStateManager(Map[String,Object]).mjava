  /**
   * Populate this instance from a previously generated snapshot.
   * @param snapshot previous snapshot created using this class.
   */
  public SnapshotDistribStateManager(Map<String, Object> snapshot) {
    snapshot.forEach((path, value) -> {
      Map<String, Object> map = (Map<String, Object>)value;
      Number version = (Number)map.getOrDefault("version", 0);
      String owner = (String)map.get("owner");
      String modeStr = (String)map.getOrDefault("mode", CreateMode.PERSISTENT.toString());
      CreateMode mode = CreateMode.valueOf(modeStr);
      byte[] bytes = null;
      if (map.containsKey("data")) {
        bytes = Base64.base64ToByteArray((String)map.get("data"));
      }
      dataMap.put(path, new VersionedData(version.intValue(), bytes, mode, owner));
    });
    log.debug("- loaded snapshot of {} resources", dataMap.size());
  }

