  @Override
  public void configure(SolrResourceLoader loader, SolrCloudManager cloudManager, AutoScalingConfig.TriggerListenerConfig config) throws TriggerValidationException {
    this.loader = loader;
    this.cloudManager = cloudManager;
    this.config = config;
    this.enabled = Boolean.parseBoolean(String.valueOf(config.properties.getOrDefault("enabled", true)));
    // validate the config
    Map<String, String> results = new HashMap<>();
    // prepare a copy to treat the prefix-based properties
    Map<String, Object> propsToCheck = new HashMap<>(config.properties);
    propsToCheck.keySet().removeIf(k ->
      validPropertyPrefixes.stream().anyMatch(p -> k.startsWith(p)));
    TriggerUtils.checkProperties(propsToCheck, results, requiredProperties, validProperties);
    if (!results.isEmpty()) {
      throw new TriggerValidationException(config.name, results);
    }
  }

