  @SuppressWarnings({"unchecked"})
  private AutoScalingConfig handleSetPolicies(SolrQueryRequest req, SolrQueryResponse rsp, CommandOperation op,
                                              AutoScalingConfig currentConfig) throws KeeperException, InterruptedException, IOException {
    Map<String, Object> policiesMap = op.getDataMap();
    for (Map.Entry<String, Object> policy : policiesMap.entrySet()) {
      String policyName = policy.getKey();
      if (policyName == null || policyName.trim().length() == 0) {
        op.addError("The policy name cannot be null or empty");
        return currentConfig;
      }
    }
    Map<String, List<Clause>> currentClauses = new HashMap<>(currentConfig.getPolicy().getPolicies());
    Map<String, List<Clause>> newClauses = null;
    try {
      newClauses = Policy.clausesFromMap((Map<String, List<Map<String, Object>>>) op.getCommandData(),
          new ArrayList<>() );
    } catch (Exception e) {
      op.addError(e.getMessage());
      return currentConfig;
    }
    currentClauses.putAll(newClauses);
    Policy p = currentConfig.getPolicy().withPolicies(currentClauses);
    currentConfig = currentConfig.withPolicy(p);
    return currentConfig;
  }

