    public static Op fromMap(Map<String, Object> map) {
      if (!map.containsKey("action")) {
        return null;
      }
      CollectionParams.CollectionAction action = CollectionParams.CollectionAction.get(String.valueOf(map.get("action")));
      if (action == null) {
        return null;
      }
      Op op = new Op(action);
      Map<Object, Object> hints = (Map<Object, Object>)map.get("hints");
      if (hints != null && !hints.isEmpty()) {
        hints.forEach((k, v) ->  {
          Suggester.Hint h = Suggester.Hint.get(k.toString());
          if (h == null) {
            return;
          }
          if (!(v instanceof Collection)) {
            v = Collections.singletonList(v);
          }
          ((Collection)v).forEach(vv -> {
            if (vv instanceof Map) {
              // maybe it's a Pair?
              Map<String, Object> m = (Map<String, Object>)vv;
              if (m.containsKey("first") && m.containsKey("second")) {
                Pair p = Pair.parse(m);
                if (p != null) {
                  op.addHint(h, p);
                  return;
                }
              }
            }
            op.addHint(h, vv);
          });
        });
      }
      return op;
    }

