  public GenericDistributedQueue(DistribStateManager stateManager, String dir, Stats stats, int maxQueueSize) {
    this.dir = dir;

    try {
      if (!stateManager.hasData(dir)) {
        try {
          stateManager.makePath(dir);
        } catch (AlreadyExistsException e) {
          // ignore
        }
      }
    } catch (IOException | KeeperException e) {
      throw new SolrException(ErrorCode.SERVER_ERROR, e);
    } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
      throw new SolrException(ErrorCode.SERVER_ERROR, e);
    }

    this.stateManager = stateManager;
    this.stats = stats;
    this.maxQueueSize = maxQueueSize;
  }

