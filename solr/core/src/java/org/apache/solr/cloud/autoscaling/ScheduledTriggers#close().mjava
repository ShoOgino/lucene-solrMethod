  @Override
  public void close() throws IOException {
    synchronized (this) {
      // mark that we are closed
      isClosed = true;
      for (ScheduledTrigger scheduledTrigger : scheduledTriggers.values()) {
        IOUtils.closeQuietly(scheduledTrigger);
      }
      scheduledTriggers.clear();
    }
    ExecutorUtil.shutdownAndAwaitTermination(scheduledThreadPoolExecutor);
    ExecutorUtil.shutdownAndAwaitTermination(actionExecutor);
  }

