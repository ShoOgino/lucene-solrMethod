  @Override
  public void close() throws IOException {
    synchronized (this) {
      // mark that we are closed
      isClosed = true;
      for (TriggerWrapper triggerWrapper : scheduledTriggerWrappers.values()) {
        IOUtils.closeQuietly(triggerWrapper);
      }
      scheduledTriggerWrappers.clear();
    }
    // shutdown and interrupt all running tasks because there's no longer any
    // guarantee about cluster state
    scheduledThreadPoolExecutor.shutdownNow();
    actionExecutor.shutdownNow();
    listeners.close();
  }

