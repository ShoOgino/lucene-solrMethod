  /**
   *
   * Gets last element of the Queue without removing it.
   */
  public String getTailId() throws KeeperException, InterruptedException {
    TreeMap<Long, String> orderedChildren = null;
    orderedChildren = orderedChildren(null);
    if(orderedChildren == null || orderedChildren.isEmpty()) return null;

    for(String headNode : orderedChildren.descendingMap().values())
      if (headNode != null) {
        try {
          QueueEvent queueEvent = new QueueEvent(dir + "/" + headNode, zookeeper.getData(dir + "/" + headNode,
              null, null, true), null);
          return queueEvent.getId();
        } catch (KeeperException.NoNodeException e) {
          // Another client removed the node first, try next
        }
      }
    return null;
  }

