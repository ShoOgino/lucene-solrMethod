  @SuppressWarnings({"unchecked"})
  private AutoScalingConfig handleSetClusterPreferences(SolrQueryRequest req, SolrQueryResponse rsp, CommandOperation op,
                                                        AutoScalingConfig currentConfig) throws KeeperException, InterruptedException, IOException {
    List<Map<String, Object>> preferences = (List<Map<String, Object>>) op.getCommandData();
    if (preferences == null || !(preferences instanceof List)) {
      op.addError("A list of cluster preferences not found");
      return currentConfig;
    }
    List<Preference> prefs = null;
    try {
      prefs = preferences.stream().map(Preference::new).collect(Collectors.toList());
    } catch (Exception e) {
      op.addError(e.getMessage());
      return currentConfig;
    }
    Policy p = currentConfig.getPolicy().withClusterPreferences(prefs);
    currentConfig = currentConfig.withPolicy(p);
    return currentConfig;
  }

