  /**
   * Logic to decide a flush before processing a ZkWriteCommand
   *
   * @param cmd the ZkWriteCommand instance
   * @return true if a flush is required, false otherwise
   */
  protected boolean maybeFlushBefore(ZkWriteCommand cmd) {
    if (cmd.collection == null || lastStateFormat <= 0) {
      return false;
    }
    return cmd.collection.getStateFormat() != lastStateFormat;
  }

