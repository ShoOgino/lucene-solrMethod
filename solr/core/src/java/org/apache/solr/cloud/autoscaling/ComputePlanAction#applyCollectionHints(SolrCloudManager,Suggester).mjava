  /**
   * Applies collection hints for all collections that match the {@link #collectionsPredicate}
   * and returns the number of collections that matched.
   * @return number of collections that match the {@link #collectionsPredicate}
   * @throws IOException if {@link org.apache.solr.client.solrj.impl.ClusterStateProvider} throws IOException
   */
  private int applyCollectionHints(SolrCloudManager cloudManager, Suggester s) throws IOException {
    ClusterState clusterState = cloudManager.getClusterStateProvider().getClusterState();
    Set<String> set = clusterState.getCollectionStates().keySet().stream()
            .filter(collectionRef -> collectionsPredicate.test(collectionRef))
            .collect(Collectors.toSet());
    if (set.size() < clusterState.getCollectionStates().size())  {
      // apply hints only if a subset of collections are selected
      set.forEach(c -> s.hint(Suggester.Hint.COLL, c));
    }
    return set.size();
  }

