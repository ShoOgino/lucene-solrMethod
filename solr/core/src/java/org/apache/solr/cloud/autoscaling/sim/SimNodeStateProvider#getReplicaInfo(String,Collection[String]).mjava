  @Override
  public Map<String, Map<String, List<Replica>>> getReplicaInfo(String node, Collection<String> keys) {
    List<Replica> replicas = clusterStateProvider.simGetReplicaInfos(node);
    if (replicas == null || replicas.isEmpty()) {
      return new HashMap<>();
    }
    Map<String, Map<String, List<Replica>>> res = new HashMap<>();
    // TODO: probably needs special treatment for "metrics:solr.core..." tags
    for (Replica r : replicas) {
      @SuppressWarnings({"unchecked"})
      Map<String, List<Replica>> perCollection = res.computeIfAbsent(r.getCollection(), Utils.NEW_HASHMAP_FUN);
      @SuppressWarnings({"unchecked"})
      List<Replica> perShard = perCollection.computeIfAbsent(r.getShard(), Utils.NEW_ARRAYLIST_FUN);
      // XXX filter out some properties?
      perShard.add(r);
    }
    return res;
  }

