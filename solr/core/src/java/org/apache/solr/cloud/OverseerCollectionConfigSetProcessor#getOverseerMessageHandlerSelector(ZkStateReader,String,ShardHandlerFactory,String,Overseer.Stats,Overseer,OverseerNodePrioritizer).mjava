  private static OverseerMessageHandlerSelector getOverseerMessageHandlerSelector(
      ZkStateReader zkStateReader,
      String myId,
      final ShardHandlerFactory shardHandlerFactory,
      String adminPath,
      Overseer.Stats stats,
      Overseer overseer,
      OverseerNodePrioritizer overseerNodePrioritizer) {
    final OverseerCollectionMessageHandler collMessageHandler = new OverseerCollectionMessageHandler(
        zkStateReader, myId, shardHandlerFactory, adminPath, stats, overseer, overseerNodePrioritizer);
    final OverseerConfigSetMessageHandler configMessageHandler = new OverseerConfigSetMessageHandler(
        zkStateReader);
    return message -> {
      String operation = message.getStr(Overseer.QUEUE_OPERATION);
      if (operation != null && operation.startsWith(CONFIGSETS_ACTION_PREFIX)) {
        return configMessageHandler;
      }
      return collMessageHandler;
    };
  }

