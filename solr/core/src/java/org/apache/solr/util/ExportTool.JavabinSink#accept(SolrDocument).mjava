    @Override
    public void accept(SolrDocument doc) throws IOException {
      SolrInputDocument document = new SolrInputDocument();
      doc.forEach((s, o) -> {
        if (s.equals("_version_")) return;
        if (o instanceof List) {
          if (((List) o).size() == 1) o = ((List) o).get(0);
        }
        document.addField(s, o);
      });

      codec.writeSolrInputDocument(document);

    }

