    private StreamingResponseCallback getStreamer(DocsSink sink) {
      return new StreamingResponseCallback() {
        @Override
        public void streamSolrDocument(SolrDocument doc) {
          try {
            sink.accept(doc);
          } catch (IOException e) {
            throw new RuntimeException(e);
          }
          docsWritten++;
        }

        @Override
        public void streamDocListInfo(long numFound, long start, Float maxScore) {

        }
      };
    }

