    @Override
    public void accept(SolrDocument doc) throws IOException {
      Map m = new LinkedHashMap(doc.size());
      doc.forEach((s, field) -> {
        if (s.equals("_version_")) return;
        if (field instanceof List) {
          if (((List) field).size() == 1) {
            field = ((List) field).get(0);
          }
        }
        m.put(s, field);
      });
      jsonw.writeObj(m);
      writer.flush();
      writer.append('\n');

    }

