  /**
   * Convert a {@link Meter} to a map.
   * @param name metric name
   * @param meter meter instance
   * @param simple use simplified representation for complex metrics - instead of a (name, map)
   *             only the selected (name "." key, value) pairs will be produced.
   * @param consumer consumer that accepts produced objects
   */
  static void convertMeter(String name, Meter meter, boolean simple, BiConsumer<String, Object> consumer) {
    if (simple) {
      consumer.accept(name + ".count", meter.getCount());
    } else {
      Map<String, Object> response = new LinkedHashMap<>();
      response.put("count", meter.getCount());
      response.put("meanRate", meter.getMeanRate());
      response.put("1minRate", meter.getOneMinuteRate());
      response.put("5minRate", meter.getFiveMinuteRate());
      response.put("15minRate", meter.getFifteenMinuteRate());
      consumer.accept(name, response);
    }
  }

