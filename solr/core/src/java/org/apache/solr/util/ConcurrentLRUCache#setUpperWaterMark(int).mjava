  public void setUpperWaterMark(int upperWaterMark) {
    if (upperWaterMark < 1) throw new IllegalArgumentException("upperWaterMark must be >= 1");
    this.upperWaterMark = upperWaterMark;
  }

