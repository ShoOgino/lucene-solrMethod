  private String getNameFor(HttpRequest request) {
    try {
      final RequestLine requestLine = request.getRequestLine();
      String schemeHostPort = null;
      if (request instanceof HttpRequestWrapper) {
        HttpRequestWrapper wrapper = (HttpRequestWrapper) request;
        schemeHostPort = wrapper.getTarget().getSchemeName() + "://" + wrapper.getTarget().getHostName() + ":" +  wrapper.getTarget().getPort();
      }
      final URIBuilder url = new URIBuilder(requestLine.getUri());
      return SolrMetricManager.mkName((schemeHostPort != null ? schemeHostPort : "") + url.removeQuery().build().toString() + "." + methodNameString(request), scope);
    } catch (URISyntaxException e) {
      throw new IllegalArgumentException(e);
    }
  }

