    public SolrInputDocument readRecord() throws IOException {
      while(true) {
        String line = null;

        if(finished) {
          return null;
        }

        if(pushedBack != null) {
          line = pushedBack;
          pushedBack = null;
        } else {
          line = bufferedReader.readLine();
        }

        if (line != null) {
          if (line.contains("QTime=")) {
            return parseQueryRecord(line);
          } else if (line.contains("Registered new searcher")) {
            return parseNewSearch(line);
          } else if (line.contains("path=/update")) {
            return parseUpdate(line);
          } else if (line.contains(" ERROR ")) {
            this.cause = null;
            return parseError(line, readTrace());
          } else if (line.contains("start commit")) {
            return parseCommit(line);
          } else {
            continue;
          }
        } else {
          return null;
        }
      }
    }

