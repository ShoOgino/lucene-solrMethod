  /* package visibility for tests. */
  String createRegistryName(String collectionName, String coreName) {
    if (collectionName == null || (collectionName != null && !coreName.startsWith(collectionName + "_"))) {
      // single core, or unknown naming scheme
      return SolrMetricManager.getRegistryName(SolrInfoMBean.Group.core, coreName);
    }
    // split "collection1_shard1_1_replica1" into parts
    String str = coreName.substring(collectionName.length() + 1);
    String shard;
    String replica = null;
    int pos = str.lastIndexOf("_replica");
    if (pos == -1) { // ?? no _replicaN part ??
      shard = str;
    } else {
      shard = str.substring(0, pos);
      replica = str.substring(pos + 1);
    }
    return SolrMetricManager.getRegistryName(SolrInfoMBean.Group.core, collectionName, shard, replica);
  }

