  @Override
  public Map<String, Metric> getMetrics() {
    final Map<String, Metric> metrics = new HashMap<>();

    try {
      final ObjectName on = new ObjectName("java.lang:type=OperatingSystem");
      // verify that it exists
      MBeanInfo info = mBeanServer.getMBeanInfo(on);
      // collect valid attributes
      Set<String> attributes = new HashSet<>();
      for (MBeanAttributeInfo ai : info.getAttributes()) {
        attributes.add(ai.getName());
      }
      for (String metric : METRICS) {
        // verify that an attribute exists before attempting to add it
        if (attributes.contains(metric)) {
          metrics.put(metric, new JmxAttributeGauge(mBeanServer, on, metric));
        }
      }
    } catch (JMException ignored) {
      log.debug("Unable to load OperatingSystem MBean", ignored);
    }

    return metrics;
  }

