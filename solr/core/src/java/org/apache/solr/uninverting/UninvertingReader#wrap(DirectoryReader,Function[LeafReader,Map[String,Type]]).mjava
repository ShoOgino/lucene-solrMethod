  /**
   * 
   * Wraps a provided DirectoryReader. Note that for convenience, the returned reader
   * can be used normally (e.g. passed to {@link DirectoryReader#openIfChanged(DirectoryReader)})
   * and so on. 
   * 
   * @param in input directory reader
   * @param perSegmentMapper function to map a segment reader to a mapping of fields to their uninversion type
   * @return a wrapped directory reader
   */
  public static DirectoryReader wrap(DirectoryReader in, final Function<LeafReader, Map<String,Type>> perSegmentMapper) throws IOException {
    return new UninvertingDirectoryReader(in, perSegmentMapper);
  }

