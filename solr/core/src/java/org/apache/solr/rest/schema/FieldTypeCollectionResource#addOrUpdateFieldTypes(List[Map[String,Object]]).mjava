  @SuppressWarnings("unchecked")
  protected void addOrUpdateFieldTypes(List<Map<String, Object>> fieldTypeList) throws Exception {
    List<FieldType> newFieldTypes = new ArrayList<>(fieldTypeList.size());
    ManagedIndexSchema oldSchema = (ManagedIndexSchema) getSchema();
    for (Map<String,Object> fieldTypeJson : fieldTypeList) {
      if (1 == fieldTypeJson.size() && fieldTypeJson.containsKey(IndexSchema.FIELD_TYPE)) {
        fieldTypeJson = (Map<String, Object>) fieldTypeJson.get(IndexSchema.FIELD_TYPE);
      }
      FieldType newFieldType = 
          FieldTypeResource.buildFieldTypeFromJson(oldSchema, 
              (String)fieldTypeJson.get(IndexSchema.NAME), fieldTypeJson);
      newFieldTypes.add(newFieldType);
    }
    // now deploy the added types (all or nothing)
    addNewFieldTypes(newFieldTypes, oldSchema);
  }

