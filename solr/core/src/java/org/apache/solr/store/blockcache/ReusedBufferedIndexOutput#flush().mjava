  @Override
  public void flush() throws IOException {
    flushBufferToCache();
    flushInternal();
  }

