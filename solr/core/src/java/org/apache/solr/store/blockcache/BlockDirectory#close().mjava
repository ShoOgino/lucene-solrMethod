  @Override
  public void close() throws IOException {
    try {
      String[] files = listAll();
      
      for (String file : files) {
        cache.delete(getFileCacheName(file));
      }
      // segments.gen won't be removed above
      cache.delete(dirName + "/" + "segments.gen");
      
    } catch (FileNotFoundException e) {
      // the local file system folder may be gone
    } finally {
      directory.close();
      cache.releaseResources();
    }
  }

