  /** Returns an instance of the wrapped {@link MergePolicy} after it has been configured with all set parameters. */
  protected final MergePolicy getWrappedMergePolicy() {
    if (wrappedMergePolicyArgs == null) {
      return getDefaultWrappedMergePolicy();
    }

    final String className = (String) wrappedMergePolicyArgs.remove(CLASS);
    if (className == null) {
      throw new IllegalArgumentException("Class name not defined for wrapped MergePolicyFactory!");
    }

    final MergePolicyFactory mpf = resourceLoader.newInstance(
        className,
        MergePolicyFactory.class,
        NO_SUB_PACKAGES,
        new Class[] {SolrResourceLoader.class, MergePolicyFactoryArgs.class},
        new Object[] {resourceLoader, wrappedMergePolicyArgs});
    return mpf.getMergePolicy();
  }

