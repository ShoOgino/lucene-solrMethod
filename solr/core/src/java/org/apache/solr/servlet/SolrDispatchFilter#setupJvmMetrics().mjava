  private void setupJvmMetrics()  {
    SolrMetricManager metricManager = cores.getMetricManager();
    try {
      String registry = SolrMetricManager.getRegistryName(SolrInfoBean.Group.jvm);
      metricManager.registerAll(registry, new AltBufferPoolMetricSet(), true, "buffers");
      metricManager.registerAll(registry, new ClassLoadingGaugeSet(), true, "classes");
      metricManager.registerAll(registry, new OperatingSystemMetricSet(), true, "os");
      metricManager.registerAll(registry, new GarbageCollectorMetricSet(), true, "gc");
      metricManager.registerAll(registry, new MemoryUsageGaugeSet(), true, "memory");
      metricManager.registerAll(registry, new ThreadStatesGaugeSet(), true, "threads"); // todo should we use CachedThreadStatesGaugeSet instead?
    } catch (Exception e) {
      log.warn("Error registering JVM metrics", e);
    }
  }

