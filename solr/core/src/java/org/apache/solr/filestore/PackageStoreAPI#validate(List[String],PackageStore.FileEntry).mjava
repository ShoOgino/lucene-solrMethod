  public void validate(List<String> sigs,
                       PackageStore.FileEntry entry) throws SolrException {
    Map<String, byte[]> keys = CloudUtil.getTrustedKeys(
        coreContainer.getZkController().getZkClient(), "exe");
    if (keys == null || keys.isEmpty()) {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,
          "ZooKeeper does not have any public keys");
    }
    CryptoKeys cryptoKeys = null;
    try {
      cryptoKeys = new CryptoKeys(keys);
    } catch (Exception e) {
      throw new SolrException(SolrException.ErrorCode.SERVER_ERROR,
          "Error parsing public keys in ZooKeeper");
    }
    for (String sig : sigs) {
      Supplier<String> errMsg = () -> "Signature does not match any public key : " + sig;
      if (entry.getBuffer() != null) {
        if (cryptoKeys.verify(sig, entry.getBuffer()) == null) {
          throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, errMsg.get());
        }
      } else {
        InputStream inputStream = entry.getInputStream();
        if (cryptoKeys.verify(sig, inputStream) == null) {
          throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, errMsg.get());
        }

      }

    }
  }

