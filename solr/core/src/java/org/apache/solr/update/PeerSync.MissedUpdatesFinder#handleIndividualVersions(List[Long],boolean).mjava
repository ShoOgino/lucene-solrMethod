    private MissedUpdatesRequest handleIndividualVersions(List<Long> otherVersions, boolean completeList) {
      List<Long> toRequest = new ArrayList<>();
      for (Long otherVersion : otherVersions) {
        // stop when the entries get old enough that reorders may lead us to see updates we don't need
        if (!completeList && Math.abs(otherVersion) < ourLowThreshold) break;

        if (ourUpdateSet.contains(otherVersion) || requestedUpdateSet.contains(otherVersion)) {
          // we either have this update, or already requested it
          // TODO: what if the shard we previously requested this from returns failure (because it goes
          // down)
          continue;
        }

        toRequest.add(otherVersion);
        requestedUpdateSet.add(otherVersion);
      }

      return MissedUpdatesRequest.of(StrUtils.join(toRequest, ','), toRequest.size());
    }

