  @Override
  public SolrIndexSearcher reopenSearcher(SolrIndexSearcher previousSearcher) throws IOException {
    
    IndexReader currentReader = previousSearcher.getIndexReader();
    IndexReader newReader;

    IndexWriter writer = solrCoreState.getIndexWriter(core);
    // SolrCore.verbose("start reopen from",previousSearcher,"writer=",writer);
    newReader = IndexReader.openIfChanged(currentReader, writer, true);
    // SolrCore.verbose("reopen result", newReader);
    
    if (newReader == null) {
      currentReader.incRef();
      newReader = currentReader;
    }

    return new SolrIndexSearcher(core, schema, "main", newReader, true, true, true, core.getDirectoryFactory());
  }

