  @Override
  public long getLastLogId() {
    if (id != -1) return id;
    if (tlogFiles.length == 0) return -1;
    String last = tlogFiles[tlogFiles.length - 1];
    if (TLOG_NAME.length() + 1 > last.lastIndexOf('.'))  {
      // old tlog created by default UpdateLog impl
      return Long.parseLong(last.substring(TLOG_NAME.length() + 1));
    } else  {
      return Long.parseLong(last.substring(TLOG_NAME.length() + 1, last.lastIndexOf('.')));
    }
  }

