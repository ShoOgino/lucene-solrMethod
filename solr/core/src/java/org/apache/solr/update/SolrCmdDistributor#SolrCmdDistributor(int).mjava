  public SolrCmdDistributor(int numHosts) {
    int maxPermits = Math.max(8, (numHosts - 1) * 8);
    
    // limits how many tasks can actually execute at once
    if (maxPermits != semaphore.getMaxPermits()) {
      semaphore.setMaxPermits(maxPermits);
    }

    completionService = new ExecutorCompletionService<Request>(commExecutor);
    pending = new HashSet<Future<Request>>();
  }

