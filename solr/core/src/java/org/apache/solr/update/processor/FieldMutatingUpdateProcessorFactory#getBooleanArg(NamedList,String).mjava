  /**
   * Removes the first instance of the key from NamedList, returning the Boolean
   * that key referred to, or null if the key is not specified.
   * @exception SolrException invalid type or structure
   */
  public static Boolean getBooleanArg(final NamedList args, final String key) {
    Boolean bool;
    List values = args.getAll(key);
    if (0 == values.size()) {
      return null;
    }
    if (values.size() > 1) {
      throw new SolrException(SERVER_ERROR, "Only one '" + key + "' is allowed");
    }
    Object o = args.remove(key);
    if (o instanceof Boolean) {
      bool = (Boolean)o;
    } else if (o instanceof CharSequence) {
      bool = Boolean.parseBoolean(o.toString());
    } else {
      throw new SolrException(SERVER_ERROR, "'" + key + "' must have type 'bool' or 'str'; found " + o.getClass());
    }
    return bool;
  }

