  @Override
  public void rollback() throws IOException {
    try {
      super.rollback();
    } finally {
      isClosed = true;
      directoryFactory.release(getDirectory());
      numCloses.incrementAndGet();
    }
  }

