  private SolrCmdDistributor.Node lookupShardLeaderOfCollection(String collection) {
    //TODO consider router to get the right slice.  Refactor common code in CloudSolrClient & DistributedUrp
    final Collection<Slice> activeSlices = zkController.getClusterState().getCollection(collection).getActiveSlices();
    if (activeSlices.isEmpty()) {
      throw new SolrException(SolrException.ErrorCode.SERVICE_UNAVAILABLE, "Cannot route to collection " + collection);
    }
    final Slice slice = activeSlices.iterator().next();
    //TODO when should we do StdNode vs RetryNode?
    final Replica leader = slice.getLeader();
    if (leader == null) {
      throw new SolrException(SolrException.ErrorCode.SERVICE_UNAVAILABLE,
          "No 'leader' replica available for shard " + slice.getName() + " of collection " + collection);
    }
    return new SolrCmdDistributor.RetryNode(new ZkCoreNodeProps(leader), zkController.getZkStateReader(),
        collection, null);
  }

