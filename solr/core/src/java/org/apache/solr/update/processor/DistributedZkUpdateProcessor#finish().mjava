  @Override
  public void finish() throws IOException {
    clusterState = zkController.getClusterState();

    assertNotFinished();

    doFinish();
  }

