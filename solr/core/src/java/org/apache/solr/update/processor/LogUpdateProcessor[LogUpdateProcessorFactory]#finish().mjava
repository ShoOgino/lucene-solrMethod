  @Override
  public void finish() throws IOException {
    if (logDebug) { log.debug("PRE_UPDATE FINISH " + req); }
    if (next != null) next.finish();

    // LOG A SUMMARY WHEN ALL DONE (INFO LEVEL)

    if (log.isInfoEnabled()) {
      log.info(getLogStringAndClearRspToLog());
    } else if (log.isWarnEnabled()) {
      long elapsed = rsp.getEndTime() - req.getStartTime();
      if (elapsed >= slowUpdateThresholdMillis) {
        log.warn(getLogStringAndClearRspToLog());
      }
    }
  }

