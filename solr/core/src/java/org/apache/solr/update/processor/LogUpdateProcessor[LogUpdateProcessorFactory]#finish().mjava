  @Override
  public void finish() throws IOException {
    if (logDebug) { log.debug("PRE_UPDATE finish()"); }
    if (next != null) next.finish();

    // LOG A SUMMARY WHEN ALL DONE (INFO LEVEL)
    


    NamedList<Object> stdLog = rsp.getToLog();

    StringBuilder sb = new StringBuilder();

    for (int i=0; i<toLog.size(); i++) {
      String name = toLog.getName(i);
      Object val = toLog.getVal(i);
      if (name != null) {
        sb.append(name).append('=');
      }
      sb.append(val).append(' ');
    }

    stdLog.clear();   // make it so SolrCore.exec won't log this again

    // if id lists were truncated, show how many more there were
    if (adds != null && numAdds > maxNumToLog) {
      adds.add("... (" + numAdds + " adds)");
    }
    if (deletes != null && numDeletes > maxNumToLog) {
      deletes.add("... (" + numDeletes + " deletes)");
    }
    long elapsed = rsp.getEndTime() - req.getStartTime();

    sb.append(" 0 ").append(elapsed);
    log.info(sb.toString());
  }

