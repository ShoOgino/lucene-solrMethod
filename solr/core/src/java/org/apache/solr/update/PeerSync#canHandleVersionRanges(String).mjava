  private boolean canHandleVersionRanges(String replica) {
    SyncShardRequest sreq = new SyncShardRequest();
    requests.add(sreq);

    // determine if leader can handle version ranges
    sreq.shards = new String[] {replica};
    sreq.actualShards = sreq.shards;
    sreq.params = new ModifiableSolrParams();
    sreq.params.set("qt", "/get");
    sreq.params.set(DISTRIB, false);
    sreq.params.set("checkCanHandleVersionRanges", false);

    ShardHandler sh = shardHandlerFactory.getShardHandler();
    sh.submit(sreq, replica, sreq.params);

    ShardResponse srsp = sh.takeCompletedIncludingErrors();
    Boolean canHandleVersionRanges = srsp.getSolrResponse().getResponse().getBooleanArg("canHandleVersionRanges");

    if (canHandleVersionRanges == null || canHandleVersionRanges.booleanValue() == false) {
      return false;
    }

    return true;
  }

