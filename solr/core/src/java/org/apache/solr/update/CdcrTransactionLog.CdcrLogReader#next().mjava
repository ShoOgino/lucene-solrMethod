    @Override
    public Object next() throws IOException, InterruptedException {
      Object o = super.next();
      if (o != null) {
        this.numRecords++;
        // We are replaying the log. We need to update the number of records for the writeCommit.
        if (isReplaying) {
          synchronized (CdcrTransactionLog.this) {
            CdcrTransactionLog.this.numRecords = this.numRecords;
          }
        }
      }
      return o;
    }

