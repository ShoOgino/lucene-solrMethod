  private static void addField(Document doc, SchemaField field, Object val, float boost) {
    if (field.isPolyField()) {
      StorableField[] farr = field.getType().createFields(field, val, boost);
      for (StorableField f : farr) {
        if (f != null) doc.add((Field) f); // null fields are not added
      }
    } else {
      StorableField f = field.createField(val, boost);
      if (f != null) doc.add((Field) f);  // null fields are not added
    }
  }

