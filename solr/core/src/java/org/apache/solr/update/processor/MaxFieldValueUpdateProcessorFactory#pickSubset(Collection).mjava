  @Override
  @SuppressWarnings("unchecked")
  public Collection pickSubset(Collection values) {
    Collection result = values;
    try {
      // NOTE: max must be put into a temp local in order to avoid ecj errors for javadoc lint
      Object max = Collections.max(values);
      result = Collections.singletonList(max);
    } catch (ClassCastException e) {
      throw new SolrException
        (BAD_REQUEST, 
         "Field values are not mutually comparable: " + e.getMessage(), e);
    }
    return result;
  }

