  @Override
  public synchronized void openIndexWriter(SolrCore core) throws IOException {
    log.info("Creating new IndexWriter...");
    synchronized (writerPauseLock) {
      if (closed) {
        throw new SolrException(ErrorCode.SERVICE_UNAVAILABLE, "Already closed");
      }
      
      try {
        indexWriter = createMainIndexWriter(core, "DirectUpdateHandler2");
        log.info("New IndexWriter is ready to be used.");
        // we need to null this so it picks up the new writer next get call
        refCntWriter = null;
      } finally {
        pauseWriter = false;
        writerPauseLock.notifyAll();
      }
    }
  }

