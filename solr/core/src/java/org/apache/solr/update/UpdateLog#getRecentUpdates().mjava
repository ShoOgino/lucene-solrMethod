  /** The RecentUpdates object returned must be closed after use */
  public RecentUpdates getRecentUpdates() {
    Deque<TransactionLog> logList;
    synchronized (this) {
      logList = new LinkedList<TransactionLog>(logs);
      for (TransactionLog log : logList) {
        log.incref();
      }
      if (prevTlog != null) {
        prevTlog.incref();
        logList.addFirst(prevTlog);
      }
      if (tlog != null) {
        tlog.incref();
        logList.addFirst(tlog);
      }
    }

    // TODO: what if I hand out a list of updates, then do an update, then hand out another list (and
    // one of the updates I originally handed out fell off the list).  Over-request?

    boolean success = false;
    RecentUpdates recentUpdates = null;
    try {
      recentUpdates = new RecentUpdates();
      recentUpdates.logList = logList;
      recentUpdates.update();
      success = true;
    } finally {
      // defensive: if some unknown exception is thrown,
      // make sure we close so that the tlogs are decref'd
      if (!success && recentUpdates != null) {
        recentUpdates.close();
      }
    }

    return recentUpdates;
  }

