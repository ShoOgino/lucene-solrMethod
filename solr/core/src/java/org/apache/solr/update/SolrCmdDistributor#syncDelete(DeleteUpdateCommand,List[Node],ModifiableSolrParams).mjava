  public void syncDelete(DeleteUpdateCommand cmd, List<Node> nodes, ModifiableSolrParams params) throws IOException {
    log.info("SYNCDELETE on {} : ", nodes, cmd);
    checkResponses(false);
    // flush all pending adds
    flushAdds(1);
    // flush all pending deletes
    flushDeletes(1);
    // finish pending requests
    checkResponses(false);

    DeleteUpdateCommand clonedCmd = clone(cmd);
    DeleteRequest deleteRequest = new DeleteRequest();
    deleteRequest.cmd = clonedCmd;
    deleteRequest.params = params;

    UpdateRequestExt ureq = new UpdateRequestExt();
    if (cmd.isDeleteById()) {
      ureq.deleteById(cmd.getId(), cmd.getVersion());
    } else {
      ureq.deleteByQuery(cmd.query);
    }
    ureq.setParams(params);
    for (Node node : nodes) {
      syncRequest(node, ureq);
    }
  }

