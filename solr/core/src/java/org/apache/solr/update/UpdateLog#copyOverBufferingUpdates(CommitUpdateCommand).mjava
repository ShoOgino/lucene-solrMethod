  /**
   * Block updates, append a commit at current tlog,
   * then copy over buffer updates to new tlog and bring back ulog to active state.
   * So any updates which hasn't made it to the index is preserved in the current tlog,
   * this also make RTG work
   * @param cuc any updates that have version larger than the version of cuc will be copied over
   */
  public void copyOverBufferingUpdates(CommitUpdateCommand cuc) {
    versionInfo.blockUpdates();
    try {
      operationFlags &= ~FLAG_GAP;
      state = State.ACTIVE;
      copyAndSwitchToNewTlog(cuc);
    } finally {
      versionInfo.unblockUpdates();
    }
  }

