  /**
   * Check if we are already in sync. Simple fingerprint comparison should do
   */
  private boolean alreadyInSync() {
    for (String replica : replicas) {
      requestFingerprint(replica);
    }
    
    for (;;) {
      ShardResponse srsp = shardHandler.takeCompletedOrError();
      if (srsp == null) break;

      Object replicaFingerprint = srsp.getSolrResponse().getResponse().get("fingerprint");
      if (replicaFingerprint == null) {
        log.warn("Replica did not return a fingerprint - possibly an older Solr version");
        continue;
      }
      
      try {
        IndexFingerprint otherFingerprint = IndexFingerprint.fromObject(replicaFingerprint);
        IndexFingerprint ourFingerprint = IndexFingerprint.getFingerprint(core, Long.MAX_VALUE);
        if(IndexFingerprint.compare(otherFingerprint, ourFingerprint) == 0) {
          log.info("We are already in sync. No need to do a PeerSync ");
          return true;
        }
      } catch(IOException e) {
        log.warn("Could not cofirm if we are already in sync. Continue with PeerSync");
      }
    }
    
    return false;
  }

