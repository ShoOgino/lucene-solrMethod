    /**
     * Expert: Instantiate a sub-reader. A sub-reader is used for batch updates. It allows to iterates over the
     * update logs entries without modifying the state of the parent log reader. If the batch update fails, the state
     * of the sub-reader is discarded and the state of the parent reader is not modified. If the batch update
     * is successful, the sub-reader is used to fast forward the parent reader with the method
     * {@link #forwardSeek(org.apache.solr.update.CdcrUpdateLog.CdcrLogReader)}.
     */
    public CdcrLogReader getSubReader() {
      // Add the last element of the queue to properly initialise the pointer and log reader
      CdcrLogReader clone = new CdcrLogReader(new ArrayList<TransactionLog>(), this.tlogs.peekLast());
      clone.tlogs.clear(); // clear queue before copy
      clone.tlogs.addAll(tlogs); // perform a copy of the list
      clone.lastPositionInTLog = this.lastPositionInTLog;
      clone.numRecordsReadInCurrentTlog = this.numRecordsReadInCurrentTlog;
      clone.lastVersion = this.lastVersion;
      clone.nextToLastVersion = this.nextToLastVersion;

      // If the update log is not empty, we need to initialise the tlog reader
      // NB: the tlogReader is equal to null if the update log is empty
      if (tlogReader != null) {
        clone.tlogReader.close();
        clone.tlogReader = currentTlog.getReader(this.tlogReader.currentPos());
      }

      return clone;
    }

