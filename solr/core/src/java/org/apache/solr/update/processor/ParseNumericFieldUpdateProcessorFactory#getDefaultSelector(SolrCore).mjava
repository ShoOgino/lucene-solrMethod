  /**
   * Returns true if the field doesn't match any schema field or dynamic field,
   *           or if the matched field's type is compatible
   * @param core Where to get the current schema from
   */
  @Override
  public FieldMutatingUpdateProcessor.FieldNameSelector
  getDefaultSelector(final SolrCore core) {

    return new FieldMutatingUpdateProcessor.FieldNameSelector() {
      @Override
      public boolean shouldMutate(final String fieldName) {
        final IndexSchema schema = core.getLatestSchema();
        FieldType type = schema.getFieldTypeNoEx(fieldName);
        return (null == type) || isSchemaFieldTypeCompatible(type);
      }
    };
  }

