  /**
   * expert: Reset the update log before initialisation. This is needed by the IndexFetcher during a
   * a Recovery operation in order to re-initialise the UpdateLog with a new set of tlog files.
   */
  public void reset() {
    synchronized (this) {
      // Close readers
      for (CdcrLogReader reader : new ArrayList<>(logPointers.keySet())) {
        reader.close();
      }
      logPointers.clear();

      // Close and clear logs
      doClose(prevTlog);
      doClose(tlog);

      for (TransactionLog log : logs) {
        if (log == prevTlog || log == tlog) continue;
        doClose(log);
      }

      logs.clear();
      newestLogsOnStartup.clear();
      tlog = prevTlog = null;
      prevMapLog = prevMapLog2 = null;

      map.clear();
      if (prevMap != null) prevMap.clear();
      if (prevMap2 != null) prevMap2.clear();

      numOldRecords = 0;

      oldDeletes.clear();
      deleteByQueries.clear();

      // reset lastDataDir for triggering full #init()
      lastDataDir = null;
    }
  }

