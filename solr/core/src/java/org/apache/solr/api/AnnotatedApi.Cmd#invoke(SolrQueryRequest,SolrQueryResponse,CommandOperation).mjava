    void invoke(SolrQueryRequest req, SolrQueryResponse rsp, CommandOperation cmd) {
      try {
        if (paramsCount == 2) {
          method.invoke(obj, req, rsp);
        } else {
          Object o = cmd.getCommandData();
          if (o instanceof Map && c != null) {
            o = mapper.readValue(Utils.toJSONString(o), c);
          }
          if (isWrappedInPayloadObj) {
            PayloadObj<Object> payloadObj = new PayloadObj<>(cmd.name, cmd.getCommandData(), o);
            cmd = payloadObj;
            method.invoke(obj, req, rsp, payloadObj);
          } else {
            method.invoke(obj, req, rsp, o);
          }
          if (cmd.hasError()) {
            throw new ApiBag.ExceptionWithErrObject(SolrException.ErrorCode.BAD_REQUEST, "Error executing command",
                CommandOperation.captureErrors(Collections.singletonList(cmd)));
          }
        }


      } catch (SolrException se) {
        log.error("Error executing command  ", se);
        throw se;
      } catch (InvocationTargetException ite) {
        log.error("Error executing command ", ite);
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR, ite.getCause());
      } catch (Exception e) {
        log.error("Error executing command : ", e);
        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR, e);
      }

    }

