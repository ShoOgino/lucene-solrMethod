    Cmd(String command, Object obj, Method method) {
      if (Modifier.isPublic(method.getModifiers())) {
        this.command = command;
        this.obj = obj;
        this.method = method;
        Class<?>[] parameterTypes = method.getParameterTypes();
        paramsCount = parameterTypes.length;
        if (parameterTypes.length == 1) {
          readPayloadType(method.getGenericParameterTypes()[0]);
        } else if (parameterTypes.length == 3) {
          if (parameterTypes[0] != SolrQueryRequest.class || parameterTypes[1] != SolrQueryResponse.class) {
            throw new RuntimeException("Invalid params for method " + method);
          }
          Type t = method.getGenericParameterTypes()[2];
          readPayloadType(t);
        }
        if (parameterTypes.length > 3) {
          throw new RuntimeException("Invalid params count for method " + method);
        }
      } else {
        throw new RuntimeException(method.toString() + " is not a public static method");
      }

    }

