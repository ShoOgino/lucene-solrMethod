  /** accumulates per-segment multi-valued stats */
  static void accumMulti(int counts[], int docBase, FieldFacetStats[] facetStats, SortedSetDocValues si, DocIdSetIterator disi, int subIndex, OrdinalMap map) throws IOException {
    final LongValues ordMap = map == null ? null : map.getGlobalOrds(subIndex);
    int doc;
    while ((doc = disi.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
      si.setDocument(doc);
      long ord;
      while ((ord = si.nextOrd()) != SortedSetDocValues.NO_MORE_ORDS) {
        int term = (int) ord;
        if (map != null) {
          term = (int) ordMap.get(term);
        }
        counts[term]++;
        for (FieldFacetStats f : facetStats) {
          f.facetTermNum(docBase + doc, term);
        }
      }
    }
  }

