  private static SSLTestConfig buildSSLConfig() {
    // test has been disabled
    if (RandomizedContext.current().getTargetClass().isAnnotationPresent(SuppressSSL.class)) {
      return new SSLTestConfig();
    }
    
    // we don't choose ssl that often because of SOLR-5776
    final boolean trySsl = random().nextInt(10) < 2;
    // NOTE: clientAuth is useless unless trySsl==true, but we randomize it independently
    // just in case it might find bugs in our test/ssl client code (ie: attempting to use
    // SSL w/client cert to non-ssl servers)
    boolean trySslClientAuth = random().nextInt(10) < 2;
    if (Constants.MAC_OS_X) {
      // see SOLR-9039
      // If a solution is found to remove this, please make sure to also update
      // TestMiniSolrCloudClusterSSL.testSslAndClientAuth as well.
      trySslClientAuth = false; 
    }
    
    log.info("Randomized ssl ({}) and clientAuth ({})", trySsl, trySslClientAuth);
    
    return new SSLTestConfig(trySsl, trySslClientAuth);
  }

