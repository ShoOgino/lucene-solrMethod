    private static Map<String, Level> setLogLevels(Map<String, Level> logLevels) {
      LoggerContext ctx = LoggerContext.getContext(false);
      Configuration config = ctx.getConfiguration();

      Map<String, Level> oldLevels = new HashMap<>();
      logLevels.forEach((loggerName, level) -> {
        LoggerConfig logConfig = config.getLoggerConfig(loggerName);
        // what the initial logger level was. It will use the root value if logger is being defined for the first time
        oldLevels.put(loggerName, logConfig.getLevel());
        if (loggerName.equals(logConfig.getName())) {
          logConfig.setLevel(level);
        } else {
          LoggerConfig loggerConfig = new LoggerConfig(loggerName, level, true);
          loggerConfig.setLevel(level);
          config.addLogger(loggerName, loggerConfig);
        }
      });
      ctx.updateLoggers();
      return oldLevels;
    }

