  /**
   * Processes a "query" using a URL path (with no context path) + optional query params,
   * e.g. "/schema/fields?indent=on"
   *
   * @param request the URL path and optional query params
   * @return The response to the query
   * @exception Exception any exception in the response.
   */
  public String query(String request) throws Exception {
    URL url = new URL(getBaseURL() + request);
    HttpURLConnection connection = (HttpURLConnection)url.openConnection();
    InputStream inputStream = null;
    StringWriter strWriter;
    try {
      try {
        inputStream = connection.getInputStream();
      } catch (IOException e) {
        inputStream = connection.getErrorStream();
      }
      strWriter = new StringWriter();
      IOUtils.copy(new InputStreamReader(inputStream, "UTF-8"), strWriter);
    } finally {
      IOUtils.closeQuietly(inputStream);
    }
    return strWriter.toString();
  }

