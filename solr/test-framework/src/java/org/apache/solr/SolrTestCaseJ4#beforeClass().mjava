  @BeforeClass 
  @SuppressWarnings("unused")
  private static void beforeClass() {
    System.setProperty("jetty.testMode", "true");
    System.setProperty("enable.update.log", usually() ? "true" : "false");
    System.setProperty("tests.shardhandler.randomSeed", Long.toString(random().nextLong()));
    System.setProperty("solr.clustering.enabled", "false");
    setupLogging();
    startTrackingSearchers();
    startTrackingZkClients();
    ignoreException("ignore_exception");
    newRandomConfig();
    sslConfig = getSSLConfig();
    
    
    if(sslConfig != null && sslConfig.useSsl) {
      // SolrCloud tests should usually clear this
      System.setProperty("urlScheme", "https");
      
      // Turn off two-way SSL since it isn't configured below...
      sslConfig.clientAuth = false;
      HttpClientUtil.setConfigurer(new HttpClientConfigurer(){
        @SuppressWarnings("deprecation")
        protected void configure(DefaultHttpClient httpClient, SolrParams config) {
          super.configure(httpClient, config);
          SchemeRegistry registry = httpClient.getConnectionManager().getSchemeRegistry();
          // Make sure no tests cheat by using HTTP
          registry.unregister("http");
          try {
            // Don't complain that we are using self-signed certs during the test
            registry.register(new Scheme("https", 443, new SSLSocketFactory(new TrustSelfSignedStrategy())));
          } catch (KeyManagementException | UnrecoverableKeyException
              | NoSuchAlgorithmException | KeyStoreException ex) {
            throw new IllegalStateException("Unable to setup https scheme for HTTPClient to test SSL.", ex);
          }
        }
      });
    }
  }

