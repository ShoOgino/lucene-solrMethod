  private void initEngine(Context context) {
    String scriptText = context.getScript();
    String scriptLang = context.getScriptLanguage();
    if (scriptText == null) {
      throw new DataImportHandlerException(SEVERE,
          "<script> tag is not present under <dataConfig>");
    }
    ScriptEngineManager scriptEngineMgr = new ScriptEngineManager();
    ScriptEngine scriptEngine = scriptEngineMgr.getEngineByName(scriptLang);
    if (scriptEngine == null) {
      throw new DataImportHandlerException(SEVERE,
          "Cannot load Script Engine for language: " + scriptLang);
    }
    if (scriptEngine instanceof Invocable) {
      engine = (Invocable) scriptEngine;
    } else {
      throw new DataImportHandlerException(SEVERE,
          "The installed ScriptEngine for: " + scriptLang
              + " does not implement Invocable.  Class is "
              + scriptEngine.getClass().getName());
    }
    try {
      try {
        AccessController.doPrivileged(new PrivilegedExceptionAction<Void>() {
          @Override
          public Void run() throws ScriptException  {
            scriptEngine.eval(scriptText);
            return null;
          }
        }, SCRIPT_SANDBOX);
      } catch (PrivilegedActionException e) {
        throw (ScriptException) e.getException();
      }
    } catch (ScriptException e) {
      wrapAndThrow(SEVERE, e, "'eval' failed with language: " + scriptLang
          + " and script: \n" + scriptText);
    }
  }

