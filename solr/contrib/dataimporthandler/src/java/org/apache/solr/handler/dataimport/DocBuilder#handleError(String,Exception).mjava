  @SuppressWarnings({"unchecked"})
  void handleError(String message, Exception e) {
    if (!dataImporter.getCore().getCoreContainer().isZooKeeperAware()) {
      writer.rollback();
    }

    statusMessages.put(message, "Indexing error");
    addStatusMessage(message);
    if ((config != null) && (config.getOnError() != null)) {
      invokeEventListener(config.getOnError(), e);
    }
  }

