  /**
   * NOTE: declared as a method to allow for extensibility
   *
   * @lucene.experimental this API is experimental and subject to change
   * @return the result of evaluating a string
   */
  protected Date evaluateWrapper(VariableWrapper variableWrapper, Locale locale, TimeZone tz) {
    Date date = null;
    Object variableval = resolveWrapper(variableWrapper,locale,tz);
    if (variableval instanceof Date) {
      date = (Date) variableval;
    } else {
      String s = variableval.toString();
      try {
        date = getDateFormat(DEFAULT_DATE_FORMAT, tz, locale).parse(s);
      } catch (ParseException exp) {
        wrapAndThrow(SEVERE, exp, "Invalid expression for date");
      }
    }
    return date;
  }

