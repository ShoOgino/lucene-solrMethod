  private void assertSearch(Query query, String field, String... values) throws IOException {
    /* The limit of search queue is doubled to catch the error in case when for some reason there are more docs than expected  */
    SolrIndexSearcher searcher = req.getSearcher();
    TopDocs result = searcher.search(query, values.length * 2);
    assertEquals(values.length, result.totalHits.value);
    List<String> actualValues = new ArrayList<String>();
    for (int index = 0; index < values.length; ++index) {
      Document doc = searcher.doc(result.scoreDocs[index].doc);
      actualValues.add(doc.get(field));
    }
    
    for (String expectedValue: values) {
      boolean removed = actualValues.remove(expectedValue);
      if (!removed) {
        fail("Search result does not contain expected values");
      }
    }
  }

