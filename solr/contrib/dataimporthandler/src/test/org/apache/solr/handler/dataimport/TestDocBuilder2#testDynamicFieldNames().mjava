  @Test
  @SuppressWarnings("unchecked")
  public void testDynamicFieldNames() throws Exception {
    @SuppressWarnings({"rawtypes"})
    List rows = new ArrayList();
    rows.add(createMap("mypk", "101", "text", "ApacheSolr"));
    MockDataSource.setIterator("select * from x", rows.iterator());

    LocalSolrQueryRequest request = lrf.makeRequest("command", "full-import",
        "debug", "on", "clean", "true", "commit", "true",
        "dataConfig", DATA_CONFIG_WITH_DYNAMIC_FIELD_NAMES);
    h.query("/dataimport", request);
    assertQ(req("id:101"), "//*[@numFound='1']", "//*[@name='101_s']");
  }

