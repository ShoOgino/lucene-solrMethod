  public void testPagingQuery() {
    SolrEntityProcessor processor = new NoNextMockProcessor() ;
    
    HashMap<String,String> entityAttrs = new HashMap<String,String>(){{
      put(SolrEntityProcessor.SOLR_SERVER,"http://route:66/no");
      if (random().nextBoolean()) {
        List<String> noCursor = Arrays.asList("","false",CursorMarkParams.CURSOR_MARK_START);//only 'true' not '*'
        Collections.shuffle(noCursor, random());
        put(CursorMarkParams.CURSOR_MARK_PARAM,  noCursor.get(0));
      }}};
    processor.init(getContext(null, null, null, null, Collections.emptyList(), 
        entityAttrs));
    try {
    processor.buildIterator();
    SolrQuery query = new SolrQuery();
    ((SolrDocumentListIterator) processor.rowIterator).passNextPage(query);
    assertEquals("0", query.get(CommonParams.START));
    assertNull( query.get(CursorMarkParams.CURSOR_MARK_PARAM));
    assertNotNull( query.get(CommonParams.TIME_ALLOWED));
    }finally {
      processor.destroy();
    }
  }

