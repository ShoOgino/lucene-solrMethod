  /**
   * Code copied with some adaptations from {@link org.apache.solr.util.TestHarness.LocalRequestFactory#makeRequest(String...)}.
   */
  @SuppressWarnings({"unchecked"})
  private static LocalSolrQueryRequest localMakeRequest(SolrCore core, String ... q) {
    if (q.length==1) {
      Map<String, String> args = new HashMap<>();
      args.put(CommonParams.VERSION,"2.2");

      return new LocalSolrQueryRequest(core, q[0], "", 0, 20, args);
    }
    if (q.length%2 != 0) {
      throw new RuntimeException("The length of the string array (query arguments) needs to be even");
    }
    @SuppressWarnings({"rawtypes"})
    Map.Entry<String, String> [] entries = new NamedList.NamedListEntry[q.length / 2];
    for (int i = 0; i < q.length; i += 2) {
      entries[i/2] = new NamedList.NamedListEntry<>(q[i], q[i+1]);
    }
    @SuppressWarnings({"rawtypes"})
    NamedList nl = new NamedList(entries);
    if(nl.get("wt" ) == null) nl.add("wt","xml");
    return new LocalSolrQueryRequest(core, nl);
  }

