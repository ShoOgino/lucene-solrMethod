  @Test
  public void testEvil() {
    assumeTrue("This test only works with security manager", System.getSecurityManager() != null);
    String script = "function f1(row) {"
            + "var os = Packages.java.lang.System.getProperty('os.name');"
            + "row.put('name', os);"
            + "return row;\n"
            + "}";

    Context context = getContext("f1", script);
    Map<String, Object> map = new HashMap<>();
    map.put("name", "Scott");
    EntityProcessorWrapper sep = new EntityProcessorWrapper(new SqlEntityProcessor(), null, null);
    sep.init(context);
    DataImportHandlerException expected = expectThrows(DataImportHandlerException.class, () -> {
      sep.applyTransformer(map);
    });
    assumeFalse("This JVM does not have JavaScript installed.  Test Skipped.",
        expected.getMessage().startsWith("Cannot load Script Engine for language"));
    assertTrue(expected.getCause().toString(), SecurityException.class.isAssignableFrom(expected.getCause().getClass()));
  }

