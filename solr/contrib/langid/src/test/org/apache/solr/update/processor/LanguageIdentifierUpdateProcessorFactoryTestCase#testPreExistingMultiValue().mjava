  /**
   * Test not only 1st value taken into account (empty string),
   * but all other values of 'text_multivalue' field ('en').
   */
  @Test
  public void testPreExistingMultiValue() throws Exception {
    SolrInputDocument doc;
    parameters = new ModifiableSolrParams();
    parameters.add("langid.fl", "text_multivalue");
    parameters.add("langid.langField", "language");
    parameters.add("langid.langsField", "languages");
    parameters.add("langid.enforceSchema", "false");
    parameters.add("langid.map", "true");
    liProcessor = createLangIdProcessor(parameters);
    
    doc = englishDoc();
    assertEquals("en", liProcessor.process(doc).getFieldValue("language"));
    assertEquals("en", liProcessor.process(doc).getFieldValue("languages"));
    
    doc = englishDoc();
    doc.setField("language", "no");
    assertEquals("no", liProcessor.process(doc).getFieldValue("language"));
    assertEquals("no", liProcessor.process(doc).getFieldValue("languages"));
    assertNotNull(liProcessor.process(doc).getFieldValue("text_multivalue_no"));
  }

