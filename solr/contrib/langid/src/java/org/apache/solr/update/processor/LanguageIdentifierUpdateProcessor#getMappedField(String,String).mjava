  /**
   * Returns the name of the field to map the current contents into, so that they are properly analyzed.  For instance
   * if the currentField is "text" and the code is "en", the new field would be "text_en".  If such a field doesn't exist,
   * then null is returned.
   *
   * @param currentField The current field name
   * @param language the language code
   * @return The new schema field name, based on pattern and replace
   */
  protected String getMappedField(String currentField, String language) {
    String lc = lcMap.containsKey(language) ? lcMap.get(language) : language;
    String newFieldName = langPattern.matcher(mapPattern.matcher(currentField).replaceFirst(mapReplaceStr)).replaceFirst(lc);
    log.debug("Doing mapping from "+currentField+" with language "+language+" to field "+newFieldName);
    return newFieldName;
  }

