  protected Set<String> collectFieldValues(AnalyticsField testField, Predicate<String> valuesFiller) throws IOException {
    StringField idField = new StringField("id");
    Filter filter = new QueryWrapperFilter(new MatchAllDocsQuery());
    Set<String> missing = new HashSet<>();
    
    List<LeafReaderContext> contexts = searcher.getTopReaderContext().leaves();
    for (int leafNum = 0; leafNum < contexts.size(); leafNum++) {
      LeafReaderContext context = contexts.get(leafNum);
      DocIdSet dis = filter.getDocIdSet(context, null); // solr docsets already exclude any deleted docs
      if (dis == null) {
        continue;
      }
      DocIdSetIterator disi = dis.iterator();
      if (disi != null) {
        testField.doSetNextReader(context);
        idField.doSetNextReader(context);
        int doc = disi.nextDoc();
        while( doc != DocIdSetIterator.NO_MORE_DOCS){
          // Add a document to the statistics being generated
          testField.collect(doc);
          idField.collect(doc);

          String id = idField.getString();
          if (!valuesFiller.test(id)) {
            missing.add(id);
          }
          doc = disi.nextDoc();
        }
      }
    }
    return missing;
  }

