  /**
   * Export the shard data through a bit-stream for the given pivot,
   * to be imported by the {@link #importPivot} method in the originating shard.
   *
   * @param output The bit-stream to output the data through
   * @param pivot the values for this pivot node and the pivot children (if they exist)
   * @throws IOException if an exception occurs while writing to the {@link DataOutput}
   */
  public void exportPivot(DataOutput output, Map<String,T> pivot) throws IOException {
    output.writeInt(pivot.size());
    for (String pivotValue : pivot.keySet()) {
      output.writeUTF(pivotValue);
      exportPivotValue(output, pivot.get(pivotValue));
    }
  }

