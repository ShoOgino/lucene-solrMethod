  /**
   * Create the response for a request.
   *
   * <p>
   * NOTE: Analytics requests specified in the old olap-style format
   * have their responses generated by {@link #createOldResponse()}.
   *
   * @return a {@link Map} representation of the response
   */
  public Map<String,Object> createResponse() {
    Map<String,Object> analyticsResponse = new HashMap<>();
    if (ungroupedExpressions.size() > 0) {
      addUngroupedResults(analyticsResponse);
    }

    Map<String,Object> groupingsResponse = new HashMap<>();
    groupingManagers.forEach( (name, groupingManager) -> {
      groupingsResponse.put(name, groupingManager.createResponse());
    });

    if (groupingsResponse.size() > 0) {
      analyticsResponse.put(AnalyticsResponseHeadings.GROUPINGS, groupingsResponse);
    }
    return analyticsResponse;
  }

