  /**
   * Cleans a directory without deleting it.
   *
   * @param directory directory to clean
   * @throws IOException in case cleaning is unsuccessful
   */
  public static void cleanDirectory(File directory) throws IOException {
      if (!directory.exists()) {
          String message = directory + " does not exist";
          throw new IllegalArgumentException(message);
      }

      if (!directory.isDirectory()) {
          String message = directory + " is not a directory";
          throw new IllegalArgumentException(message);
      }

      File[] files = directory.listFiles();
      if (files == null) {  // null if security restricted
          throw new IOException("Failed to list contents of " + directory);
      }

      IOException exception = null;
      for (File file : files) {
          try {
              forceDelete(file);
          } catch (IOException ioe) {
              exception = ioe;
          }
      }

      if (null != exception) {
          throw exception;
      }
  }

