  @Override
  public DocIdSet getDocIdSet(IndexReader reader) throws IOException {
    long start = System.currentTimeMillis();
      
    OpenBitSet bits = new OpenBitSet(reader.maxDoc());

    TermDocs termDocs = reader.termDocs();
    List<Double> area = shape.getArea();
    int sz = area.size();
    log.fine("Area size "+ sz);

    // iterate through each boxid
    for (int i =0; i< sz; i++) {
      double boxId = area.get(i).doubleValue();
      termDocs.seek(new Term(fieldName,
          NumericUtils.doubleToPrefixCoded(boxId)));
      
      // iterate through all documents
      // which have this boxId
      while (termDocs.next()) {
        bits.fastSet(termDocs.doc());
      }
    }
    
    long end = System.currentTimeMillis();
    if(log.isLoggable(Level.FINE)) {
      log.fine("BoundaryBox Time Taken: "+ (end - start) + " found: "+bits.cardinality()+" candidates");
    }
    return bits;
  }

