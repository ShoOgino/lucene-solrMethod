    private void setAction(IndexDocument doc) {
        Integer docCountToKeep = this.action.get(doc);
        if (!doc.isDelete() && (docCountToKeep == null || docCountToKeep == 0)) {
            /*
             * add a ONE for ONE documents to keep for this IndexDocument when
             * doDelete. doDelete will keep the latest added document and
             * deletes all other documents for this IndexDocument e.g. all
             * duplicates
             */
            this.action.put(doc, ONE);
        } else if (doc.isDelete()
                && (docCountToKeep == null || docCountToKeep > 0)) {
            /*
             * add a zero for zero documents to keep for this IndexDocument when
             * doDelete
             */
            this.action.put(doc, ZERO);
        }
    }

