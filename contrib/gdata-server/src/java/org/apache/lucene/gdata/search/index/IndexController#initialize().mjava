    /**
     * @see org.apache.lucene.gdata.search.SearchComponent#initialize()
     */
    public synchronized void initialize() {
        if (this.isInitialized.get())
            throw new IllegalStateException(
                    "IndexController is already initialized");
        this.destroyed.set(false);
        /*
         * if this fails the server must not startup --> throw runtime exception
         */
        GDataServerRegistry.getRegistry().registerEntryEventListener(this);

        GDataServerRegistry.getRegistry().registerEntryEventListener(this);
        Collection<ProvidedService> services = GDataServerRegistry
                .getRegistry().getServices();
        this.indexerMap = new ConcurrentHashMap<String, ServiceIndex>(services
                .size());
       
        for (ProvidedService service : services) {
            IndexSchema schema = service.getIndexSchema();
            /*
             * initialize will fail if mandatory values are not set. This is
             * just a
             */
            schema.initialize();
            addIndexSchema(schema);
        }
        this.isInitialized.set(true);
        

    }

