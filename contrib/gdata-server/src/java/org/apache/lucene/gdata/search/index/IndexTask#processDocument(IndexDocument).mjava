    private void processDocument(IndexDocument document) throws IOException {
        /*
         * a null document is used for waking up the task if the indexer has
         * been destroyed to finish up and commit. should I change this?! -->
         * see TimedIndexTask#getTask() also!!
         */
        if (document == null) {
            INNERLOG.warn("Can not process document -- is null -- run commit");
            return;
        }
        if (document.isDelete()) {
            this.indexer.deleteDocument(document);
            return;
        } else if (document.isInsert()) {
            this.indexer.addDocument(document);
            return;
        } else if (document.isUpdate()) {
            this.indexer.updateDocument(document);
            return;
        }
        /*
         * that should not happen -- anyway skip the document and write it to
         * the log
         */
        INNERLOG.warn("IndexDocument has no Action " + document);

    }

