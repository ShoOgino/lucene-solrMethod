    /*
     * Test method for 'org.apache.lucene.gdata.servlet.handler.RequestAuthenticator.authenticateAccount(GDataRequest, AccountRole)'
     */
    public void testGetTokenFromRequest() {
        // test token present
        this.requestMock.expectAndDefaultReturn(this.request.getHeader(AuthenticationController.AUTHORIZATION_HEADER), this.tokenHeader);
        this.requestMock.replay();
        assertEquals(this.token,this.authenticator.getTokenFromRequest(this.request));
        this.requestMock.verify();
        this.requestMock.reset();
        
        // test token null / cookie present
        this.requestMock.expectAndDefaultReturn(this.request.getHeader(AuthenticationController.AUTHORIZATION_HEADER), null);
        this.requestMock.expectAndDefaultReturn(this.request.getCookies(), new Cookie[]{this.authCookie});
        this.requestMock.replay();
        assertEquals(this.token,this.authenticator.getTokenFromRequest(this.request));
        this.requestMock.verify();
        this.requestMock.reset();
        
        // test token null / cookie not present
        this.requestMock.expectAndDefaultReturn(this.request.getHeader(AuthenticationController.AUTHORIZATION_HEADER), null);
        this.requestMock.expectAndDefaultReturn(this.request.getCookies(), new Cookie[]{new Cookie("somekey","someValue")});
        this.requestMock.replay();
        assertNull(this.authenticator.getTokenFromRequest(this.request));
        this.requestMock.verify();
        this.requestMock.reset();
        
//      test token null / cookie array emtpy 
        this.requestMock.expectAndDefaultReturn(this.request.getHeader(AuthenticationController.AUTHORIZATION_HEADER), null);
        this.requestMock.expectAndDefaultReturn(this.request.getCookies(), new Cookie[]{});
        this.requestMock.replay();
        assertNull(this.authenticator.getTokenFromRequest(this.request));
        this.requestMock.verify();
        this.requestMock.reset();
        
//      test token null / cookie array null
        this.requestMock.expectAndDefaultReturn(this.request.getHeader(AuthenticationController.AUTHORIZATION_HEADER), null);
        this.requestMock.expectAndDefaultReturn(this.request.getCookies(), null);
        this.requestMock.replay();
        assertNull(this.authenticator.getTokenFromRequest(this.request));
        this.requestMock.verify();
        this.requestMock.reset();
    }

