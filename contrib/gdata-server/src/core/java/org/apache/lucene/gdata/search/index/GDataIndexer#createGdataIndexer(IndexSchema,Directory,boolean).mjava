    /**
     * This factory method creates a new GDataIndexer using a instance of
     * {@link IndexTask}
     * 
     * @param config -
     *            the config to be used to configure the indexer
     * @param dir -
     *            the directory to index to
     * @param create -
     *            <code>true</code> to create a new index, <code>false</code>
     *            to use the existing one.
     * @return - a new GDataIndexer instance
     * @throws IOException -
     *             if an IOException occurs while initializing the indexer
     */
    public static synchronized GDataIndexer createGdataIndexer(
            final IndexSchema config, Directory dir, boolean create)
            throws IOException {
        GDataIndexer retVal = new GDataIndexer(config, dir, create);
        retVal.setIndexTask(new IndexTask(retVal, retVal.futurQueue));
        retVal.init();
        return retVal;
    }

