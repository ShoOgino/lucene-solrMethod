    /**
     * @see org.apache.lucene.gdata.server.authentication.AuthenticationController#authenticatAccount(org.apache.lucene.gdata.data.GDataAccount,
     *      java.lang.String)
     */
    public String authenticatAccount(GDataAccount account, String requestIp) {
        try {
            String passIp = requestIp.substring(0, requestIp.lastIndexOf('.'));
            String role = Integer.toString(account.getRolesAsInt());

            return calculateAuthToken(passIp, role, account.getName());
        } catch (Exception e) {
            throw new AuthenticatorException("Can not authenticat account -- "
                    + e.getMessage(), e);

        }
    }

