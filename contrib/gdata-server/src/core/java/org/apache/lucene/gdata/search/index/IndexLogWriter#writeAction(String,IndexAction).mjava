    synchronized void writeAction(String id, IndexAction action)
            throws IOException {
        if (this.isClosed.get())
            throw new IllegalStateException("Writer is already closed");
        this.writer.write(buildElement(id, action.name()));
        this.writer.flush();
    }

