    /**
     * This factory method creates a new GDataIndexer using a instance of
     * {@link org.apache.lucene.gdata.search.index.TimedIndexTask}.
     * This indexer will automatically commit the index
     * if no modification to the index occur for the given time. The used time
     * unit is {@link TimeUnit#SECONDS}. Values less than the default value
     * will be ignored. For the default value see
     * {@link org.apache.lucene.gdata.search.index.TimedIndexTask}.
     * 
     * @param config -
     *            the config to be used to configure the indexer
     * @param dir -
     *            the directory to index to
     * @param create -
     *            <code>true</code> to create a new index, <code>false</code>
     *            to use the existing one.
     * @param commitTimeout -
     *            the amount of seconds to wait until a commit should be
     *            scheduled
     * @return - a new GDataIndexer instance
     * @throws IOException -
     *             if an IOException occurs while initializing the indexer
     */
    public static synchronized GDataIndexer createTimedGdataIndexer(
            final IndexSchema config, Directory dir, boolean create,
            long commitTimeout) throws IOException {

        GDataIndexer retVal = new GDataIndexer(config, dir, create);
        retVal.setIndexTask(new TimedIndexTask(retVal, retVal.futurQueue,
                commitTimeout));
        retVal.init();
        return retVal;
    }

