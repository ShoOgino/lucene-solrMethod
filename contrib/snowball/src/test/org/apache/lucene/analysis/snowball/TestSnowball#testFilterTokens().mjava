  public void testFilterTokens() throws Exception {
    final Token tok = new Token(2, 7, "wrd");
    tok.setTermBuffer("accents");
    tok.setPositionIncrement(3);
    Payload tokPayload = new Payload(new byte[]{0,1,2,3});
    tok.setPayload(tokPayload);
    int tokFlags = 77;
    tok.setFlags(tokFlags);

    SnowballFilter filter = new SnowballFilter(
        new TokenStream() {
          public Token next(final Token reusableToken) {
            assert reusableToken != null;
            return tok;
          }
        },
        "English"
    );

    final Token reusableToken = new Token();
    Token nextToken = filter.next(reusableToken);

    assertEquals("accent", nextToken.term());
    assertEquals(2, nextToken.startOffset());
    assertEquals(7, nextToken.endOffset());
    assertEquals("wrd", nextToken.type());
    assertEquals(3, nextToken.getPositionIncrement());
    assertEquals(tokFlags, nextToken.getFlags());
    assertEquals(tokPayload, nextToken.getPayload());
  }

