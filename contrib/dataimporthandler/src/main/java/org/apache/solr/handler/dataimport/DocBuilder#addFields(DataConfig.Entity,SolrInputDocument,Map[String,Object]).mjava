  @SuppressWarnings("unchecked")
  private void addFields(DataConfig.Entity entity, SolrInputDocument doc, Map<String, Object> arow) {
    for (Map.Entry<String, Object> entry : arow.entrySet()) {
      String key = entry.getKey();
      DataConfig.Field field = entity.colNameVsField.get(key);
      if (field == null)  {
        field = entity.lowercaseColNameVsField.get(key.toLowerCase());
      }
      if (field == null && entity.rootEntity != null)  {
        field = entity.rootEntity.colNameVsField.get(key);
      }
      if (field == null && entity.rootEntity != null)  {
        field = entity.rootEntity.lowercaseColNameVsField.get(key.toLowerCase());
      }
      if (field == null)  {
        // This can be a dynamic field
        SchemaField sf = dataImporter.getSchema().getFieldOrNull(key);
        if (sf != null) {
          addFieldToDoc(entry.getValue(), key, 1.0f, sf.multiValued(), doc);
        }
      } else  {
        if (field.toWrite)  {
          addFieldToDoc(entry.getValue(), key, field.boost, field.multiValued, doc);
        }
      }
      
    }
  }

