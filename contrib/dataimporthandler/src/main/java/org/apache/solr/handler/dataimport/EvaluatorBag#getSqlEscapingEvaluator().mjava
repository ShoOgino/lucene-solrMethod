  /**
   * <p/>
   * Returns an <code>Evaluator</code> instance meant to be used for escaping
   * values in SQL queries.
   * </p>
   * <p/>
   * It escapes the value of the given expression by replacing all occurrences
   * of single-quotes by two single-quotes and similarily for double-quotes
   * </p>
   *
   * @return an <code>Evaluator</code> instance capable of SQL-escaping
   *         expressions.
   */
  public static Evaluator getSqlEscapingEvaluator() {
    return new Evaluator() {
      public String evaluate(String expression, Context context) {
        Object o = context.getVariableResolver().resolve(expression);

        if (o == null)
          return null;

        return o.toString().replaceAll("'", "''").replaceAll("\"", "\"\"");
      }
    };
  }

