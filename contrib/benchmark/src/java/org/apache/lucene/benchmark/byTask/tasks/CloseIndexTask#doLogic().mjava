  public int doLogic() throws IOException {
    IndexWriter iw = getRunData().getIndexWriter();
    if (iw != null) {
      // If infoStream was set to output to a file, close it.
      PrintStream infoStream = iw.getInfoStream();
      if (infoStream != null && infoStream != System.out
          && infoStream != System.err) {
        infoStream.close();
      }
      iw.close(doWait);
      getRunData().setIndexWriter(null);
    }
    return 1;
  }

