  public Document makeDocument() throws Exception {

    String line;
    synchronized(this) {
      while(true) {
        line = fileIn.readLine();
        if (line == null) {
          // Reset the file
          openFile();
          if (!forever)
            throw new NoMoreDataException();
        } else {
          break;
        }
      }
    }

    if (doReuseFields)
      return getDocState().setFields(line);
    else
      return localDocState.setFields(line);
  }

