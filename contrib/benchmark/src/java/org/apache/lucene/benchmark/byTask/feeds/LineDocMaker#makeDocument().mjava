  public Document makeDocument() throws Exception {

    String line;
    synchronized(this) {
      while(true) {
        line = fileIn.readLine();
        if (line == null) {
          if (!forever)
            throw new NoMoreDataException();
          else {
            // Reset the file
            openFile();
          }
        } else {
          break;
        }
      }
    }

    return getDocState().setFields(line);
  }

