  protected DocData getNextDocData() throws NoMoreDataException {
    Random r = new Random();
    DocData doc = super.getNextDocData();
    Properties props = new Properties();

    // random int
    props.put("sort_field", Integer.toString(nextInt(r, sortRange)));

    // random string
    int len = nextInt(r, 2, 20);
    char[] buffer = new char[len];
    for(int i=0;i<len;i++)
      buffer[i] = (char) nextInt(r, 0x80);
    props.put("random_string", new String(buffer));

    // random country
    props.put("country", COUNTRIES[nextInt(r, COUNTRIES.length)]);
    doc.setProps(props);
    return doc;
  }

