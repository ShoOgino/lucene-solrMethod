	private NamedList checkEngine(CarrotClusteringEngine engine,
			int expectedNumClusters, SolrParams clusteringParams) throws IOException {
		// Get all documents to cluster
		RefCounted<SolrIndexSearcher> ref = h.getCore().getSearcher();
		MatchAllDocsQuery query = new MatchAllDocsQuery();
		DocList docList;
		try {
			SolrIndexSearcher searcher = ref.get();
			docList = searcher.getDocList(query, (Query) null, new Sort(), 0,
					numberOfDocs);
			assertEquals("docList size", this.numberOfDocs, docList.matches());
		} finally {
			ref.decref();
		}

		ModifiableSolrParams solrParams = new ModifiableSolrParams();
		solrParams.add(CarrotParams.PRODUCE_SUMMARY, "true");
		solrParams.add(clusteringParams);

		// Perform clustering
		NamedList results = engine.cluster(query, docList, solrParams);
		assertEquals("number of clusters", expectedNumClusters, results.size());
		checkClusters(results, false);
		return results;
	}

