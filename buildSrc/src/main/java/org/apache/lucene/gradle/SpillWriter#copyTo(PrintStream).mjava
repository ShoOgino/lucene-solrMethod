  public void copyTo(PrintStream ps) throws IOException {
    if (spill != null) {
      flush();
      char [] buf = new char [MAX_BUFFERED];
      try (Reader reader = Files.newBufferedReader(spillPath, StandardCharsets.UTF_8)) {
        int len;
        while ((len = reader.read(buf)) >= 0) {
          ps.print(new String(buf, 0, len));
        }
      }
    } else {
      ps.append(buffer.getBuffer());
    }
  }

