  /** Sort a single partition in-memory. */
  protected File sortPartition(int len) throws IOException {
    byte [][] data = this.buffer;
    File tempFile = File.createTempFile("sort", "partition", tempDirectory);

    long start = System.currentTimeMillis();
    Arrays.sort(data, 0, len, unsignedByteOrderComparator);
    sortInfo.sortTime += (System.currentTimeMillis() - start);
    
    ByteSequencesWriter out = new ByteSequencesWriter(tempFile);
    try {
      for (int i = 0; i < len; i++) {
        assert data[i].length <= Short.MAX_VALUE;
        out.write(data[i]);
      }
      out.close();

      // Clean up the buffer for the next partition.
      this.buffer = EMPTY;
      return tempFile;
    } finally {
      IOUtils.close(out);
    }
  }

