  /** Read in a single partition of data */
  int readPartition(ByteSequencesReader reader) throws IOException {
    long start = System.currentTimeMillis();

    // We will be reallocating from scratch.
    Arrays.fill(this.buffer, null);

    int bytesLimit = this.ramBufferSize.bytes;
    byte [][] data = this.buffer;
    byte[] line;
    int linesRead = 0;
    while ((line = reader.read()) != null) {
      if (linesRead + 1 >= data.length) {
        data = Arrays.copyOf(data,
            ArrayUtil.oversize(linesRead + MIN_EXPECTED_GROWTH, 
                RamUsageEstimator.NUM_BYTES_OBJECT_REF));
      }
      data[linesRead++] = line;

      // Account for the created objects.
      // (buffer slots do not account to buffer size.) 
      bytesLimit -= line.length + RamUsageEstimator.NUM_BYTES_ARRAY_HEADER;
      if (bytesLimit < 0) {
        break;
      }
    }
    this.buffer = data;

    sortInfo.readTime += (System.currentTimeMillis() - start);
    return linesRead;
  }

