  /**
   * All-details constructor.
   */
  public Sort(BufferSize ramBufferSize, File tempDirectory, int maxTempfiles) {
    if (ramBufferSize.bytes < 1024 * 1024 / 2) {
      // Half-meg buffer is the absolute minimum.
      throw new IllegalArgumentException("At least 0.5MB RAM buffer is needed: "
          + ramBufferSize.bytes);
    }
    
    if (maxTempfiles < 2) {
      throw new IllegalArgumentException("maxTempFiles must be >= 2");
    }

    this.ramBufferSize = ramBufferSize;
    this.tempDirectory = tempDirectory;
    this.maxTempFiles = maxTempfiles;
  }

