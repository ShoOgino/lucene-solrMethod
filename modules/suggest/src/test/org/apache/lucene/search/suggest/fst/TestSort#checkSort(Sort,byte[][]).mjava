  /**
   * Check sorting data on an instance of {@link Sort}.
   */
  private SortInfo checkSort(Sort sort, byte[][] data) throws IOException {
    File unsorted = writeAll("unsorted", data);

    Arrays.sort(data, Sort.unsignedByteOrderComparator);
    File golden = writeAll("golden", data);

    File sorted = new File(tempDir, "sorted");
    SortInfo sortInfo = sort.sort(unsorted, sorted);
    System.out.println("Input size [MB]: " + unsorted.length() / (1024 * 1024));
    System.out.println(sortInfo);

    assertFilesIdentical(golden, sorted);
    return sortInfo;
  }

