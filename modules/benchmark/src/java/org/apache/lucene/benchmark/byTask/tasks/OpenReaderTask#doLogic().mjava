  @Override
  public int doLogic() throws IOException {
    Directory dir = getRunData().getDirectory();
    Config config = getRunData().getConfig();
    IndexReader r = null;
    final IndexDeletionPolicy deletionPolicy;
    if (readOnly) {
      deletionPolicy = null;
    } else {
      deletionPolicy = CreateIndexTask.getIndexDeletionPolicy(config);
    }
    if (commitUserData != null) {
      r = IndexReader.open(OpenReaderTask.findIndexCommit(dir, commitUserData),
                           deletionPolicy,
                           readOnly); 
    } else {
      r = IndexReader.open(dir,
                           deletionPolicy,
                           readOnly); 
    }
    getRunData().setIndexReader(r);
    // We transfer reference to the run data
    r.decRef();
    return 1;
  }

