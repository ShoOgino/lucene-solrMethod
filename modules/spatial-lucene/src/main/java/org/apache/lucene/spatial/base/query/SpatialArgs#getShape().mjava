  /**
   * Considers {@link SpatialOperation#BBoxWithin} in returning the shape.
   * @return
   */
  public Shape getShape() {
    if (shape != null && (operation == SpatialOperation.BBoxWithin || operation == SpatialOperation.BBoxIntersects))
      return shape.getBoundingBox();
    return shape;
  }

