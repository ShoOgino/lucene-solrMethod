  /**
   * Subclasses might override {@link #getNodes(com.spatial4j.core.shape.Shape, int, boolean)}
   * and check if the argument is a shape and if so, delegate
   * to this implementation, which calls {@link #getNode(com.spatial4j.core.shape.Point, int)} and
   * then calls {@link #getNode(String)} repeatedly if inclParents is true.
   */
  protected final List<Node> getNodesAltPoint(Point p, int detailLevel, boolean inclParents) {
    Node cell = getNode(p, detailLevel);
    if (!inclParents) {
      return Collections.singletonList(cell);
    }

    String endToken = cell.getTokenString();
    assert endToken.length() == detailLevel;
    List<Node> cells = new ArrayList<Node>(detailLevel);
    for (int i = 1; i < detailLevel; i++) {
      cells.add(getNode(endToken.substring(0, i)));
    }
    cells.add(cell);
    return cells;
  }

