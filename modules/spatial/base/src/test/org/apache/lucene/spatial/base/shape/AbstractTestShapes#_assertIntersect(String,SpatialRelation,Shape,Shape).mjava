  private void _assertIntersect(String msg, SpatialRelation expected, Shape a, Shape b) {
    SpatialRelation sect = a.relate(b, ctx);
    if (sect == expected)
      return;
    if (expected == WITHIN || expected == CONTAINS) {
      if (a.getClass().equals(b.getClass())) // they are the same shape type
        Assert.assertEquals(msg, a, b);
      else {
        //they are effectively points or lines that are the same location
        Assert.assertTrue(msg, !a.hasArea());
        Assert.assertTrue(msg, !b.hasArea());

        Rectangle aBBox = a.getBoundingBox();
        Rectangle bBBox = b.getBoundingBox();
        if (aBBox.getHeight() == 0 && bBBox.getHeight() == 0
            && (aBBox.getMaxY() == 90 && bBBox.getMaxY() == 90
          || aBBox.getMinY() == -90 && bBBox.getMinY() == -90))
          ;//== a point at the pole
        else
          Assert.assertEquals(msg, aBBox, bBBox);
      }
    } else {
      Assert.assertEquals(msg, expected, sect);
    }
  }

