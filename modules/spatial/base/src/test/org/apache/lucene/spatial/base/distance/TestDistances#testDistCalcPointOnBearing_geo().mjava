  @Test
  public void testDistCalcPointOnBearing_geo() {
    //The haversine formula has a higher error if the points are near antipodal. We adjust EPS tolerance for this case.
    //TODO Eventually we should add the Vincenty formula for improved accuracy, or try some other cleverness.

    //test known high delta
//    {
//      Point c = ctx.makePoint(-103,-79);
//      double angRAD = Math.toRadians(236);
//      double dist = 20025;
//      Point p2 = dc().pointOnBearingRAD(c, dist, angRAD, ctx);
//      //Pt(x=76.61200011750923,y=79.04946929870962)
//      double calcDist = dc().distance(c, p2);
//      assertEqualsRatio(dist, calcDist);
//    }
    double maxDist = ctx.getUnits().earthCircumference() / 2;
    for(int i = 0; i < 1000; i++) {
      int dist = LuceneTestCase.random.nextInt((int) maxDist);
      EPS = (dist < maxDist*0.75 ? 10e-6 : 10e-3);
      testDistCalcPointOnBearing(dist);
    }
  }

