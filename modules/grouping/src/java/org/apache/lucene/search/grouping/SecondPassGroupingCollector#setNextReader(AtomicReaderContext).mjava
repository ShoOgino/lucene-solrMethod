  @Override
  public void setNextReader(AtomicReaderContext readerContext) throws IOException {
    //System.out.println("SP.setNextReader");
    for (SearchGroupDocs group : groupMap.values()) {
      group.collector.setNextReader(readerContext);
    }
    index = FieldCache.DEFAULT.getTermsIndex(readerContext.reader, groupField);

    // Rebuild ordSet
    ordSet.clear();
    for (SearchGroupDocs group : groupMap.values()) {
      //System.out.println("  group=" + (group.groupValue == null ? "null" : group.groupValue.utf8ToString()));
      int ord = group.groupValue == null ? 0 : index.binarySearchLookup(group.groupValue, spareBytesRef);
      if (ord >= 0) {
        groupDocs[ordSet.put(ord)] = group;
      }
    }
  }

