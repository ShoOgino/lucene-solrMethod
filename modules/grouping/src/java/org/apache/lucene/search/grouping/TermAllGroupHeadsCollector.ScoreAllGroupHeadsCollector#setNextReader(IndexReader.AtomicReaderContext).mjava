    public void setNextReader(IndexReader.AtomicReaderContext context) throws IOException {
      this.readerContext = context;
      groupIndex = FieldCache.DEFAULT.getTermsIndex(context.reader, groupField);

      // Clear ordSet and fill it with previous encountered groups that can occur in the current segment.
      ordSet.clear();
      segmentGroupHeads = new GroupHead[groupIndex.numOrd()];
      for (GroupHead collectedGroup : collectedGroups) {
        int ord = groupIndex.binarySearchLookup(collectedGroup.groupValue, scratchBytesRef);
        if (ord >= 0) {
          ordSet.put(ord);
          segmentGroupHeads[ord] = collectedGroup;
        }
      }
    }

