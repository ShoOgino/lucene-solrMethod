  @Override
  public long decode() throws IOException { 
    // If we've decoded 8 integers, read the next indicator.
    if ((ordinal & 0x7) == 0) {
      indicator = in.read();
      if (indicator < 0) {
        return EOS;
      }
      ordinal = 0;
    }

    if (decodeTable[indicator][ordinal++] == 0) {
      // decode the value from the stream.
      long decode = decoder.decode();
      return decode == EOS ? EOS : decode + 2;
    }

    return 1;
  }

