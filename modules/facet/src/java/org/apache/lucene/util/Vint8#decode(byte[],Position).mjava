  /** 
   * Decodes a 32-bit integer from {@code bytes}, beginning at offset {@code pos.pos}.
   * The decoded value is returned, and {@code pos.pos} is incremented by the number of
   * bytes processed.
   * @param bytes The byte array containing an encoded value.
   * @param pos On entry, the starting position in the array; on return, one greater
   * than the position of the last byte decoded in the call.
   * @return The decoded value.
   */
  public static int decode(byte[] bytes, Position pos) {
    int value = 0;
    while (true) {
      byte first = bytes[pos.pos];
      ++pos.pos;
      value |= first & 0x7F;
      if ((first & 0x80) == 0) {
        return value;
      }
      value <<= 7;
    }
  }

