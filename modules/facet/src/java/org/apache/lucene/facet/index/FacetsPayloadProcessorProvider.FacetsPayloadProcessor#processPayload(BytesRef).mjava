    @Override
    public void processPayload(BytesRef payload) throws IOException {
      InputStream is = new ByteArrayInputStream(payload.bytes, payload.offset, payload.length);
      decoder.reInit(is);
      os.reset();
      encoder.reInit(os);
      long ordinal;
      while ((ordinal = decoder.decode()) != IntDecoder.EOS) {
        int newOrdinal = ordinalMap[(int)ordinal];
        encoder.encode(newOrdinal);      
      }
      encoder.close();
      // TODO (Facet): avoid copy?
      byte out[] = os.toByteArray();
      payload.bytes = out;
      payload.offset = 0;
      payload.length = out.length;
    }

