  /** Returns the streamed bytes so far accumulated, as an array of bytes. */
  public byte[] convertStreamToByteArray() {
    try {
      encoder.close();
      return baos.toByteArray();
    } catch (IOException e) {
      // This cannot happen, because of BAOS (no I/O).
      return new byte[0];
    }
  }

