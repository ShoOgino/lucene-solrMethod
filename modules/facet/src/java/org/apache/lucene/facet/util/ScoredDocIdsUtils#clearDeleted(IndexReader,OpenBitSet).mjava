  /**
   * Clear all deleted documents from a given open-bit-set according to a given reader 
   */
  private static void clearDeleted(final IndexReader reader, 
      final OpenBitSet set) throws IOException {

    // If there are no deleted docs
    if (!reader.hasDeletions()) {
      return; // return immediately
    }
    
    Bits bits = MultiFields.getDeletedDocs(reader);

    DocIdSetIterator it = set.iterator();
    int doc = DocIdSetIterator.NO_MORE_DOCS;
    while ((doc = it.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
      if (bits.get(doc)) {
        set.fastClear(doc);
      }
    }
  }

