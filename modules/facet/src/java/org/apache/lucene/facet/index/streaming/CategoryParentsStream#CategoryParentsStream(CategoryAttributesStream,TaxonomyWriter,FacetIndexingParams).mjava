  /**
   * Constructor.
   * 
   * @param input
   *            The input stream to handle, must be derived from
   *            {@link CategoryAttributesStream}.
   * @param taxonomyWriter
   *            The taxonomy writer to use for adding categories and
   *            retrieving their ordinals.
   * @param indexingParams
   *            The indexing params used for filtering parents.
   */
  public CategoryParentsStream(CategoryAttributesStream input,
      TaxonomyWriter taxonomyWriter, FacetIndexingParams indexingParams) {
    super(input);
    this.categoryAttribute = this.addAttribute(CategoryAttribute.class);
    this.taxonomyWriter = taxonomyWriter;
    this.pathPolicy = indexingParams.getPathPolicy();
    this.ordinalPolicy = indexingParams.getOrdinalPolicy();
    this.ordinalPolicy.init(taxonomyWriter);
    this.ordinalProperty = new OrdinalProperty();
    
  }

