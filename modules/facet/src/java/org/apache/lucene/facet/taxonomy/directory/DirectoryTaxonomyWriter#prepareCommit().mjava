  /**
   * prepare most of the work needed for a two-phase commit.
   * See {@link IndexWriter#prepareCommit}.
   */
  @Override
  public synchronized void prepareCommit() throws CorruptIndexException, IOException {
    ensureOpen();
    if (taxoIndexCreateTime != null) {
      indexWriter.prepareCommit(combinedCommitData(null));
      taxoIndexCreateTime = null;
    } else {
      indexWriter.prepareCommit();
    }
  }

