  /**
   * A hook for extensions of this class to provide their own
   * {@link IndexWriter} implementation or instance. Extending classes can
   * instantiate and configure the {@link IndexWriter} as they see fit,
   * including setting a {@link org.apache.lucene.index.MergeScheduler}, or
   * {@link org.apache.lucene.index.IndexDeletionPolicy}, different RAM size
   * etc.<br>
   * <b>NOTE:</b> the instance this method returns will be closed upon calling
   * to {@link #close()}. If you wish to do something different, you should
   * override {@link #closeLuceneIndex()}.
   * 
   * @param directory the {@link Directory} on top of wich an
   *        {@link IndexWriter} should be opened.
   * @param openMode see {@link OpenMode}
   */
  protected void openLuceneIndex (Directory directory, OpenMode openMode) 
  throws CorruptIndexException, LockObtainFailedException, IOException {
    // Make sure we use a MergePolicy which merges segments in-order and thus
    // keeps the doc IDs ordered as well (this is crucial for the taxonomy
    // index).
    IndexWriterConfig config = new IndexWriterConfig(Version.LUCENE_30,
        new KeywordAnalyzer()).setOpenMode(openMode).setMergePolicy(
        new LogByteSizeMergePolicy());
    indexWriter = new IndexWriter(directory, config);
  }

