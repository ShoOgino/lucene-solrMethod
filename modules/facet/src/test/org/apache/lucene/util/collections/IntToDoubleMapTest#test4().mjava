  // now with random data.. and lots of it
  @Test
  public void test4() {
    IntToDoubleMap map = new IntToDoubleMap();
    int length = ArrayHashMapTest.RANDOM_TEST_NUM_ITERATIONS;
    // for a repeatable random sequence
    long seed = random.nextLong();
    Random random = new Random(seed);
    
    for (int i = 0; i < length; ++i) {
      int value = random.nextInt(Integer.MAX_VALUE);
      map.put(i*128, value);
    }

    assertEquals(length, map.size());

    // now repeat
    random.setSeed(seed);

    for (int i = 0; i < length; ++i) {
      int value = random.nextInt(Integer.MAX_VALUE);
      assertTrue(map.containsValue(value));
      assertTrue(map.containsKey(i*128));
      assertEquals(0, Double.compare(value, map.remove(i*128)));
    }
    assertEquals(0, map.size());
    assertTrue(map.isEmpty());
  }

