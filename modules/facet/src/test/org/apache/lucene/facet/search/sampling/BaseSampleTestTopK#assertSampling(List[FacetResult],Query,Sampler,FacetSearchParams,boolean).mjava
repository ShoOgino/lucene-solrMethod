  private void assertSampling(List<FacetResult> expected, Query q, Sampler sampler, FacetSearchParams params, boolean complement) throws Exception {
    // try several times in case of failure, because the test has a chance to fail 
    // if the top K facets are not sufficiently common with the sample set
    for (int n=RETRIES; n>0; n--) {
      FacetsCollector samplingFC = samplingCollector(false, sampler, params);
      
      searcher.search(q, samplingFC);
      List<FacetResult> sampledResults = samplingFC.getFacetResults();
      
      try {
        assertSameResults(expected, sampledResults);
        break; // succeeded
      } catch (Exception e) {
        if (n<=1) { // otherwise try again
          throw e; 
        }
      }
    }
  }

