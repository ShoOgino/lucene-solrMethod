  private void doTestCounts(boolean doComplement) throws Exception,
      IOException, IllegalAccessException, InstantiationException {
    for (int partitionSize : partitionSizes) {
      initIndex(partitionSize);
      
      List<FacetResult> facetResults = countFacets(partitionSize, 100000, doComplement);
      assertCountsAndCardinality(facetCountsTruth(), facetResults);
      
      closeAll();
    }
  }

