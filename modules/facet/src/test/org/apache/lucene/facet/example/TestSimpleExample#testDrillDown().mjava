  /**
   * In drill down test we are drilling down to a facet that appears in a single document.
   * As result, facets that without drill down got count of 2 will now get a count of 1. 
   */
  @Test
  public void testDrillDown () throws Exception {
    ExampleResult res = new SimpleMain().runDrillDown();
    assertNotNull("Null result!", res);
    assertNotNull("Null facet result!", res.getFacetResults());
    assertEquals("Wrong number of results!",1, res.getFacetResults().size());
    
    // drill down facet appears in only 1 doc, and that doc has only 2 facets  
    FacetResult facetResult = res.getFacetResults().get(0);
    assertEquals("Wrong number of facets!",2, facetResult.getNumValidDescendants());
    
    Iterator<? extends FacetResultNode> resIterator = facetResult.getFacetResultNode().getSubResults().iterator();
    assertTrue("Too few results", resIterator.hasNext());
    assertEquals("wrong count for first result out of 2", 1, (int)resIterator.next().getValue());
    assertTrue("Too few results", resIterator.hasNext());
    assertEquals("wrong count for second result out of 2", 1, (int)resIterator.next().getValue());
    assertFalse("Too many results!", resIterator.hasNext());
  }

