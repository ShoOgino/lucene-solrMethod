  public void testSingleInstanceLockFactoryDoubleObtain() throws Exception {
    LockFactory lf = new SingleInstanceLockFactory();
    Directory dir = newFSDirectory(createTempDir(), lf);
    Lock lock = dir.makeLock("foo");
    assertTrue(lock.obtain());
    try {
      lock.obtain();
      fail("did not hit double-obtain failure");
    } catch (LockObtainFailedException lofe) {
      // expected
    }
    lock.close();
    
    lock = dir.makeLock("foo");
    assertTrue(lock.obtain());
    lock.close();
    dir.close();
  }

