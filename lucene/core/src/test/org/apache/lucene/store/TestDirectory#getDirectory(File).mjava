  @Override
  protected Directory getDirectory(File path) throws IOException {
    if (random().nextBoolean()) {
      return newDirectory();
    } else {
      return newFSDirectory(path);
    }
  }

