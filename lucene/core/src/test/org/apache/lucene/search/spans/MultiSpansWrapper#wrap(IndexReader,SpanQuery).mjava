  public static Spans wrap(IndexReader reader, SpanQuery spanQuery) throws IOException {
    LeafReader lr = SlowCompositeReaderWrapper.wrap(reader); // slow, but ok for testing
    LeafReaderContext lrContext = lr.getContext();
    Query rewrittenQuery = spanQuery.rewrite(lr); // get the term contexts so getSpans can be called directly
    HashSet<Term> termSet = new HashSet<>();
    rewrittenQuery.extractTerms(termSet);
    Map<Term,TermContext> termContexts = new HashMap<>();
    for (Term term: termSet) {
      TermContext termContext = TermContext.build(lrContext, term);
      termContexts.put(term, termContext);
    }
    Spans actSpans = spanQuery.getSpans(lrContext, new Bits.MatchAllBits(lr.numDocs()), termContexts);
    return actSpans;
  }

