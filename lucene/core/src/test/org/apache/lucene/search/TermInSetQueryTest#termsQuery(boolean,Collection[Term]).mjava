  private TermInSetQuery termsQuery(boolean singleField, Collection<Term> termList) {
    if (!singleField) {
      return new TermInSetQuery(new ArrayList<>(termList));
    }
    final TermInSetQuery filter;
    List<BytesRef> bytes = new ArrayList<>();
    String field = null;
    for (Term term : termList) {
        bytes.add(term.bytes());
        if (field != null) {
          assertEquals(term.field(), field);
        }
        field = term.field();
    }
    assertNotNull(field);
    filter = new TermInSetQuery(field, bytes);
    return filter;
  }

