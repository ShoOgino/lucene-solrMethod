  private TopDocs doConcurrentSearchWithThreshold(int numResults, int threshold) throws IOException {
    Query q = new MatchAllDocsQuery();
    ExecutorService service = new ThreadPoolExecutor(4, 4, 0L, TimeUnit.MILLISECONDS,
        new LinkedBlockingQueue<Runnable>(),
        new NamedThreadFactory("TestTopDocsCollector"));
    IndexSearcher searcher = new IndexSearcher(reader, service);

    CollectorManager collectorManager = TopScoreDocCollector.createSharedManager(numResults,
        null, threshold);

    TopDocs tdc = (TopDocs) searcher.search(q, collectorManager);

    service.shutdown();

    return tdc;
  }

