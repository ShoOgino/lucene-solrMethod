  @Override
  public void setUp() throws Exception {
    super.setUp();
    directory = newDirectory();
    RandomIndexWriter writer = new RandomIndexWriter (random, directory, newIndexWriterConfig(TEST_VERSION_CURRENT, new MockAnalyzer(random)).setMergePolicy(newLogMergePolicy()));

    Document doc = new Document();
    doc.add (newField("field", "one two three four five", TextField.TYPE_STORED));
    doc.add (newField("sorter", "b", TextField.TYPE_STORED));
    writer.addDocument (doc);

    doc = new Document();
    doc.add (newField("field", "one two three four", TextField.TYPE_STORED));
    doc.add (newField("sorter", "d", TextField.TYPE_STORED));
    writer.addDocument (doc);

    doc = new Document();
    doc.add (newField("field", "one two three y", TextField.TYPE_STORED));
    doc.add (newField("sorter", "a", TextField.TYPE_STORED));
    writer.addDocument (doc);

    doc = new Document();
    doc.add (newField("field", "one two x", TextField.TYPE_STORED));
    doc.add (newField("sorter", "c", TextField.TYPE_STORED));
    writer.addDocument (doc);

    // tests here require single segment (eg try seed
    // 8239472272678419952L), because SingleDocTestFilter(x)
    // blindly accepts that docID in any sub-segment
    writer.forceMerge(1);

    reader = writer.getReader();
    writer.close ();

    searcher = newSearcher(reader);

    query = new TermQuery (new Term ("field", "three"));
    filter = newStaticFilterB();
  }

