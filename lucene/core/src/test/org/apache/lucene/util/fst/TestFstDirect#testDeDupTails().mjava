  public void testDeDupTails() throws Exception {
    List<BytesRef> entries = new ArrayList<>();
    for (int i = 0; i < 1000000; i += 4) {
      byte[] b = new byte[3];
      int val = i;
      for (int j = b.length - 1; j >= 0; --j) {
        b[j] = (byte) (val & 0xff);
        val >>= 8;
      }
      entries.add(new BytesRef(b));
    }
    long size = buildFST(entries).ramBytesUsed();
    // Size is 1664 when we use only list-encoding.  We were previously failing to ever de-dup
    // arrays-with-gaps, which led this case to blow up.
    assertTrue(size < 3000);
    //printf("fst size = %d bytes", size);
  }

