  private Path writeAll(String name, byte[][] data) throws IOException {
    Path file = Files.createTempFile(tempDir, name, "");
    ByteSequencesWriter w = new OfflineSorter.ByteSequencesWriter(file);
    for (byte [] datum : data) {
      w.write(datum);
    }
    w.close();
    return file;
  }

