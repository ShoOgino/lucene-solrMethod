  private PointWriter copyPoints(Directory dir, PointWriter points, int packedLength) throws IOException {
    BytesRef bytesRef = new BytesRef();

    try (PointWriter copy  = getRandomPointWriter(dir, points.count(), packedLength);
         PointReader reader = points.getReader(0, points.count())) {
      while (reader.next()) {
        reader.packedValue(bytesRef);
        copy.append(bytesRef, reader.docID());
      }
      return copy;
    }
  }

