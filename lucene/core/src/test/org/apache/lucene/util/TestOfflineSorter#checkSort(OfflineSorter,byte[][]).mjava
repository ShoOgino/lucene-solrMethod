  /**
   * Check sorting data on an instance of {@link OfflineSorter}.
   */
  private SortInfo checkSort(OfflineSorter sort, byte[][] data) throws IOException {
    Path unsorted = writeAll("unsorted", data);

    Arrays.sort(data, unsignedByteOrderComparator);
    Path golden = writeAll("golden", data);

    Path sorted = Files.createTempFile(OfflineSorter.getDefaultTempDir(), "sorted", "");
    SortInfo sortInfo;
    try {
      sortInfo = sort.sort(unsorted, sorted);
      //System.out.println("Input size [MB]: " + unsorted.length() / (1024 * 1024));
      //System.out.println(sortInfo);
      assertFilesIdentical(golden, sorted);
    } finally {
      IOUtils.rm(unsorted, golden, sorted);
    }

    return sortInfo;
  }

