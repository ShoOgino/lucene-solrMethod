  /**
   * Check sorting data on an instance of {@link OfflineSorter}.
   */
  private SortInfo checkSort(OfflineSorter sort, byte[][] data) throws IOException {
    Path unsorted = writeAll("unsorted", data);

    Arrays.sort(data, unsignedByteOrderComparator);
    Path golden = writeAll("golden", data);

    Path sorted = tempDir.resolve("sorted");
    SortInfo sortInfo = sort.sort(unsorted, sorted);
    //System.out.println("Input size [MB]: " + unsorted.length() / (1024 * 1024));
    //System.out.println(sortInfo);

    assertFilesIdentical(golden, sorted);
    return sortInfo;
  }

