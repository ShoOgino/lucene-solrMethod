  public void testOpenReaderAfterDelete() throws IOException {
    Path dirFile = createTempDir("deletetest");
    Directory dir = newFSDirectory(dirFile);
    if (TestUtil.hasVirusChecker(dir)) {
      dir.close();
      assumeTrue("test deletes files directly", false);
    }
    if (dir instanceof BaseDirectoryWrapper) {
      ((BaseDirectoryWrapper)dir).setCheckIndexOnClose(false); // we will hit NoSuchFileException in MDW since we nuked it!
    }
    try {
      DirectoryReader.open(dir);
      fail("expected FileNotFoundException/NoSuchFileException");
    } catch (FileNotFoundException | NoSuchFileException e) {
      // expected
    }

    IOUtils.rm(dirFile);

    // Make sure we still get a CorruptIndexException (not NPE):
    try {
      DirectoryReader.open(dir);
      fail("expected FileNotFoundException/NoSuchFileException");
    } catch (FileNotFoundException | NoSuchFileException e) {
      // expected
    }
    
    dir.close();
  }

