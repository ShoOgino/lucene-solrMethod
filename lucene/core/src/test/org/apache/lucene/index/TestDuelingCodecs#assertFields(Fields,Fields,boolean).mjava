  /** 
   * Fields api equivalency 
   */
  public void assertFields(Fields leftFields, Fields rightFields, boolean deep) throws Exception {
    // Fields could be null if there are no postings,
    // but then it must be null for both
    if (leftFields == null || rightFields == null) {
      assertNull(info, leftFields);
      assertNull(info, rightFields);
      return;
    }
    assertFieldStatistics(leftFields, rightFields);
    
    FieldsEnum leftEnum = leftFields.iterator();
    FieldsEnum rightEnum = rightFields.iterator();
    
    String field;
    while ((field = leftEnum.next()) != null) {
      assertEquals(info, field, rightEnum.next());
      assertTerms(leftEnum.terms(), rightEnum.terms(), deep);
    }
    assertNull(rightEnum.next());
  }

