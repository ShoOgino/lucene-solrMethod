  // closeSubreaders=true
  public void testReaderClosedListener2() throws Exception {
    Directory dir1 = getDir1(random());
    CompositeReader ir1 = DirectoryReader.open(dir1);
    
    // with overlapping
    ParallelCompositeReader pr = new ParallelCompositeReader(true,
     new CompositeReader[] {ir1},
     new CompositeReader[] {ir1});

    final int[] listenerClosedCount = new int[1];

    assertEquals(3, pr.leaves().size());

    for(AtomicReaderContext cxt : pr.leaves()) {
      cxt.reader().addReaderClosedListener(new ReaderClosedListener() {
          @Override
          public void onClose(IndexReader reader) {
            listenerClosedCount[0]++;
          }
        });
    }
    pr.close();
    assertEquals(3, listenerClosedCount[0]);
    dir1.close();
  }

