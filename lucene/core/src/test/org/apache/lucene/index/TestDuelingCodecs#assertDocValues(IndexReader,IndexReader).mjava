  /**
   * checks that docvalues across all fields are equivalent
   */
  public void assertDocValues(IndexReader leftReader, IndexReader rightReader) throws Exception {
    Set<String> leftValues = getDVFields(leftReader);
    Set<String> rightValues = getDVFields(rightReader);
    assertEquals(info, leftValues, rightValues);

    for (String field : leftValues) {
      // nocommit cutover to per-segment comparison
      DocValues leftDocValues = MultiDocValues.getDocValues(leftReader, field);
      DocValues rightDocValues = MultiDocValues.getDocValues(rightReader, field);
      if (leftDocValues != null && rightDocValues != null) {
        assertDocValues(leftDocValues, rightDocValues);
      } else {
        assertNull(leftDocValues);
        assertNull(rightDocValues);
      }
    }
  }

