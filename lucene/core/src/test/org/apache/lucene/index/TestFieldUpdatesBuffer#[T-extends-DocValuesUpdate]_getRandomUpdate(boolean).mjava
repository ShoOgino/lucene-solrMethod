  public <T extends DocValuesUpdate> T getRandomUpdate(boolean binary) {
    String termField = RandomPicks.randomFrom(random(), Arrays.asList("id", "_id", "some_other_field"));
    String docId = "" + random().nextInt(10);
    if (binary) {
      DocValuesUpdate.BinaryDocValuesUpdate value =  new DocValuesUpdate.BinaryDocValuesUpdate(new Term(termField, docId), "binary",
          rarely() ? null : new BytesRef(TestUtil.randomRealisticUnicodeString(random())));
      return (T) (rarely() ? value.prepareForApply(random().nextInt(100)) : value);
    } else {
      DocValuesUpdate.NumericDocValuesUpdate value = new DocValuesUpdate.NumericDocValuesUpdate(new Term(termField, docId), "numeric",
          rarely() ? null : Long.valueOf(random().nextInt(100)));

      return (T) (rarely() ? value.prepareForApply(random().nextInt(100)) : value);
    }
  }

