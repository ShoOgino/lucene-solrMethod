  private void deleteAndClose(Directory dir) throws IOException {
    String[] files = dir.listAll();
    for (String file: files) {
      dir.deleteFile(file);
    }
    dir.close();
  }

