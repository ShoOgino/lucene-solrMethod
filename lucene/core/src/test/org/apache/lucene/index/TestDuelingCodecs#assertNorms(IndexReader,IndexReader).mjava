  /** 
   * checks that norms are the same across all fields 
   */
  public void assertNorms(IndexReader leftReader, IndexReader rightReader) throws Exception {
    Assume.assumeTrue(_TestUtil.canUseSimpleNorms());
    Fields leftFields = MultiFields.getFields(leftReader);
    Fields rightFields = MultiFields.getFields(rightReader);
    // Fields could be null if there are no postings,
    // but then it must be null for both
    if (leftFields == null || rightFields == null) {
      assertNull(info, leftFields);
      assertNull(info, rightFields);
      return;
    }
    
    for (String field : leftFields) {
      // nocommit cutover to per-segment comparison
      NumericDocValues leftNorms = MultiSimpleDocValues.simpleNormValues(leftReader, field);
      NumericDocValues rightNorms = MultiSimpleDocValues.simpleNormValues(rightReader, field);
      if (leftNorms != null && rightNorms != null) {
        assertDocValues(leftReader.maxDoc(), leftNorms, rightNorms);
      } else {
        // nocommit: figure out WTF is going on here, maybe a bug in MultiSimpleDocValues?
        // ant test  -Dtestcase=TestDuelingCodecs -Dtests.method=testEquals -Dtests.seed=CCA808E6ADF64354 -Dtests.slow=true -Dtests.codec=Lucene41 -Dtests.locale=en_GB -Dtests.timezone=Asia/Pyongyang -Dtests.file.encoding=US-ASCII
        assertNull(leftNorms);
        assertNull(rightNorms);
      }
    }
  }

