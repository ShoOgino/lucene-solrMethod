  /** 
   * checks that norms are the same across all fields 
   */
  public void assertNorms(IndexReader leftReader, IndexReader rightReader) throws Exception {
    InvertedFields leftFields = MultiFields.getFields(leftReader);
    InvertedFields rightFields = MultiFields.getFields(rightReader);
    // InvertedFields could be null if there are no postings,
    // but then it must be null for both
    if (leftFields == null || rightFields == null) {
      assertNull(info, leftFields);
      assertNull(info, rightFields);
      return;
    }
    
    FieldsEnum fieldsEnum = leftFields.iterator();
    String field;
    while ((field = fieldsEnum.next()) != null) {
      DocValues leftNorms = MultiDocValues.getNormDocValues(leftReader, field);
      DocValues rightNorms = MultiDocValues.getNormDocValues(rightReader, field);
      if (leftNorms != null && rightNorms != null) {
        assertDocValues(leftNorms, rightNorms);
      } else {
        assertNull(leftNorms);
        assertNull(rightNorms);
      }
    }
  }

