  static void assertReaderClosed(IndexReader reader, boolean checkSubReaders, boolean checkNormsClosed) {
    assertEquals(0, reader.getRefCount());
    
    if (checkNormsClosed && reader instanceof AtomicReader) {
      // TODO: should we really assert something here? we check for open files and this is obselete...
      // assertTrue(((SegmentReader) reader).normsClosed());
    }
    
    if (checkSubReaders && reader instanceof CompositeReader) {
      List<? extends IndexReader> subReaders = ((CompositeReader) reader).getSequentialSubReaders();
      for (IndexReader r : subReaders) {
        assertReaderClosed(r, checkSubReaders, checkNormsClosed);
      }
    }
  }

