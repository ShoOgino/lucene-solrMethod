  public void setUp() throws Exception {
    super.setUp();
    // Currently only SimpleText and Lucene40 can index offsets into postings:
    assumeTrue("codec does not support offsets", Codec.getDefault().getName().equals("SimpleText") || Codec.getDefault().getName().equals("Lucene40"));
    iwc = newIndexWriterConfig(TEST_VERSION_CURRENT, new MockAnalyzer(random()));
    
    if (Codec.getDefault().getName().equals("Lucene40")) {
      // sep etc are not implemented
      switch(random().nextInt(4)) {
        case 0: iwc.setCodec(_TestUtil.alwaysPostingsFormat(new Lucene40PostingsFormat())); break;
        case 1: iwc.setCodec(_TestUtil.alwaysPostingsFormat(new MemoryPostingsFormat())); break;
        case 2: iwc.setCodec(_TestUtil.alwaysPostingsFormat(
            new Pulsing40PostingsFormat(_TestUtil.nextInt(random(), 1, 3)))); break;
        case 3: iwc.setCodec(_TestUtil.alwaysPostingsFormat(new NestedPulsingPostingsFormat())); break;
      }
    }
  }

