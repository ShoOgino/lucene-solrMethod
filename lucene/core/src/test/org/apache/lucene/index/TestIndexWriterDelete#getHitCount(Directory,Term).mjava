  private int getHitCount(Directory dir, Term term) throws IOException {
    IndexReader reader = DirectoryReader.open(dir);
    IndexSearcher searcher = newSearcher(reader);
    int hitCount = searcher.search(new TermQuery(term), 1000).totalHits;
    reader.close();
    return hitCount;
  }

