  private static Bits getSoftDeletesLiveDocs(LeafReader reader, String field) {
    try {
      NumericDocValues softDelete = reader.getNumericDocValues(field);
      if (softDelete != null) {
        BitSet bitSet = BitSet.of(softDelete, reader.maxDoc());
        Bits inLiveDocs = reader.getLiveDocs() == null ? new Bits.MatchAllBits(reader.maxDoc()) : reader.getLiveDocs();
        Bits newliveDocs = new Bits() {
          @Override
          public boolean get(int index) {
            return inLiveDocs.get(index) && bitSet.get(index) == false;
          }

          @Override
          public int length() {
            return inLiveDocs.length();
          }
        };
        return newliveDocs;

      } else {
        return reader.getLiveDocs();
      }
    } catch (IOException e) {
      throw new UncheckedIOException(e);
    }
  }

