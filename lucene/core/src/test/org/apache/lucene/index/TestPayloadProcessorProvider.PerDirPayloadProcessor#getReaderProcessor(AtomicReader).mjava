    @Override
    public ReaderPayloadProcessor getReaderProcessor(AtomicReader reader) throws IOException {
      if (reader instanceof SegmentReader) {
        return processors.get(((SegmentReader) reader).directory());
      } else {
        throw new UnsupportedOperationException("This shouldnot happen in this test: Reader is no SegmentReader");
      }
    }

