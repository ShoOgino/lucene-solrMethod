  // Segment size in bytes, pro-rated by % deleted
  private long size(SegmentInfoPerCommit info) throws IOException {
    final long byteSize = info.info.sizeInBytes();    
    final int delCount = writer.get().numDeletedDocs(info);
    final double delRatio = (info.info.docCount <= 0 ? 0.0f : ((double)delCount / (double)info.info.docCount));    
    assert delRatio <= 1.0;
    return (long) (byteSize * (1.0-delRatio));
  }

