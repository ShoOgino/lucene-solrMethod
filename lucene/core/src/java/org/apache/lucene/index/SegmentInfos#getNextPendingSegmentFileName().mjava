  /**
   * Get the next pending_segments_N filename that will be written.
   */
  public String getNextPendingSegmentFileName() {
    long nextGeneration;

    if (generation == -1) {
      nextGeneration = 1;
    } else {
      nextGeneration = generation+1;
    }
    return IndexFileNames.fileNameFromGeneration(IndexFileNames.PENDING_SEGMENTS,
                                                 "",
                                                 nextGeneration);
  }

