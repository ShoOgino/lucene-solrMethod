  private final void maybeMerge(int maxNumSegments) throws IOException {
    ensureOpen(false);
    updatePendingMerges(maxNumSegments);
    mergeScheduler.merge(this);
  }

