    /** Sole constructor.
     * @param segments List of {@link SegmentInfoPerCommit}s
     *        to be merged. */
    public OneMerge(List<SegmentInfoPerCommit> segments) {
      if (0 == segments.size())
        throw new RuntimeException("segments must include at least one segment");
      // clone the list, as the in list may be based off original SegmentInfos and may be modified
      this.segments = new ArrayList<SegmentInfoPerCommit>(segments);
      int count = 0;
      for(SegmentInfoPerCommit info : segments) {
        count += info.info.getDocCount();
      }
      totalDocCount = count;
    }

