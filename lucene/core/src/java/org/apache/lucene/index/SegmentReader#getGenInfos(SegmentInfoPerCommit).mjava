  // returns a gen->List<FieldInfo> mapping. Fields without DV updates have gen=-1
  private Map<Long,List<FieldInfo>> getGenInfos(SegmentInfoPerCommit si) {
    final Map<Long,List<FieldInfo>> genInfos = new HashMap<Long,List<FieldInfo>>();
    for (FieldInfo fi : core.fieldInfos) {
      if (fi.getDocValuesType() == null) {
        continue;
      }
      long gen = si.getDocValuesGen(fi.number);
      List<FieldInfo> infos = genInfos.get(gen);
      if (infos == null) {
        infos = new ArrayList<FieldInfo>();
        genInfos.put(gen, infos);
      }
      infos.add(fi);
    }
    return genInfos;
  }

