  /**
   * Set the {@link Sort} order to use when merging segments.  Note that newly flushed segments will remain unsorted.
   */
  public IndexWriterConfig setIndexSort(Sort sort) {
    for(SortField sortField : sort.getSort()) {
      if (ALLOWED_INDEX_SORT_TYPES.contains(sortField.getType()) == false) {
        throw new IllegalArgumentException("invalid SortField type: must be one of " + ALLOWED_INDEX_SORT_TYPES + " but got: " + sortField);
      }
    }
    this.indexSort = sort;
    return this;
  }

