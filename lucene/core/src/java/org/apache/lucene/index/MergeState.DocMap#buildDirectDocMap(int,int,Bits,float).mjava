    static DocMap buildDirectDocMap(int maxDoc, int numDocs, Bits liveDocs, float acceptableOverheadRatio) {
      PackedInts.Mutable docIds = PackedInts.getMutable(maxDoc,
          PackedInts.bitsRequired(Math.max(0, numDocs - 1)), acceptableOverheadRatio);
      int del = 0;
      for (int i = 0; i < maxDoc; ++i) {
        if (liveDocs.get(i)) {
          docIds.set(i, i - del);
        } else {
          ++del;
        }
      }
      assert numDocs + del == maxDoc : "maxDoc=" + maxDoc + ", del=" + del + ", numDocs=" + numDocs;
      return new DirectDocMap(liveDocs, docIds, del);
    }

