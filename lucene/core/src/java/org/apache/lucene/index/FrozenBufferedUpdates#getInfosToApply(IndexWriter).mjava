  /** Returns the {@link SegmentCommitInfo} that this packet is supposed to apply its deletes to, or null
   *  if the private segment was already merged away. */
  private List<SegmentCommitInfo> getInfosToApply(IndexWriter writer) {
    assert Thread.holdsLock(writer);
    List<SegmentCommitInfo> infos;
    if (privateSegment != null) {
      if (writer.segmentInfos.indexOf(privateSegment) == -1) {
        if (infoStream.isEnabled("BD")) {
          infoStream.message("BD", "private segment already gone; skip processing updates");
        }
        return null;
      } else {
        infos = Collections.singletonList(privateSegment);
      }
    } else {
      infos = writer.segmentInfos.asList();
    }
    return infos;
  }

