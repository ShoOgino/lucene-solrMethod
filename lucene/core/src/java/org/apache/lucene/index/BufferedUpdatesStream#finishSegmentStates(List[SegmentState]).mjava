  private void finishSegmentStates(List<SegmentState> segStates) throws IOException {
    IOUtils.applyToAll(segStates, s -> {
      ReadersAndUpdates rld = s.rld;
      try {
        rld.release(s.reader);
      } finally {
        writer.release(s.rld);
      }
    });
  }

