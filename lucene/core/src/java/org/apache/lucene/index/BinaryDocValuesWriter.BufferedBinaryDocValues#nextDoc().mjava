    @Override
    public int nextDoc() throws IOException {
      if (docID == size-1) {
        docID = NO_MORE_DOCS;
      } else {
        int next = docsWithField.nextSetBit(docID+1);
        if (next == NO_MORE_DOCS) {
          docID = NO_MORE_DOCS;
        } else {

          int length = 0;

          // skip missing values:
          while (docID < next) {
            docID++;
            length = (int) lengthsIterator.next();
            assert docID == next || length == 0;
          }
          value.grow(length);
          value.setLength(length);
          bytesIterator.readBytes(value.bytes(), 0, length);
        }
      }
      return docID;
    }

