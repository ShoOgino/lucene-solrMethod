  /**
   * Loads or returns the already loaded the global field number map for this {@link SegmentInfos}.
   * If this {@link SegmentInfos} has no global field number map the returned instance is empty
   */
  private FieldNumberBiMap getFieldNumberMap() throws IOException {
    final FieldNumberBiMap map  = new FieldNumberBiMap();

    SegmentInfo biggest = null;
    for(SegmentInfo info : segmentInfos) {
      if (biggest == null || (info.docCount-info.getDelCount()) > (biggest.docCount-biggest.getDelCount())) {
        biggest = info;
      }
    }

    if (biggest != null) {
      for(FieldInfo fi : getFieldInfos(biggest)) {
        map.addOrGet(fi.name, fi.number);
      }
    }

    // nocommit we can also pull the DV types of the
    // fields... and catch DV type change on addDoc
    // instead of much later in merge
    //}

    return map;
  }

