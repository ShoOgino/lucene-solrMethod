  /**
   * Loads or returns the already loaded the global field number map for this {@link SegmentInfos}.
   * If this {@link SegmentInfos} has no global field number map the returned instance is empty
   */
  private FieldNumbers getFieldNumberMap() throws IOException {
    final FieldNumbers map  = new FieldNumbers();

    SegmentInfoPerCommit biggest = null;
    for(SegmentInfoPerCommit info : segmentInfos) {
      if (biggest == null || (info.info.getDocCount()-info.getDelCount()) > (biggest.info.getDocCount()-biggest.getDelCount())) {
        biggest = info;
      }
    }

    if (biggest != null) {
      for(FieldInfo fi : getFieldInfos(biggest)) {
        map.addOrGet(fi.name, fi.number);
      }
    }

    // nocommit we can also pull the DV types of the
    // fields... and catch DV type change on addDoc
    // instead of much later in merge
    //}

    return map;
  }

