  private void processEvents(boolean triggerMerge) throws IOException {
    if (tragedy.get() == null) {
      Event event;
      while ((event = eventQueue.poll()) != null)  {
        event.process(this);
      }
    }
    if (triggerMerge) {
      maybeMerge(getConfig().getMergePolicy(), MergeTrigger.SEGMENT_FLUSH, UNBOUNDED_MAX_MERGE_SEGMENTS);
    }
  }

