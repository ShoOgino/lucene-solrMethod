  @Override
  void initTermVectorsWriter() throws IOException {
    if (writer == null) {
      IOContext context = new IOContext(new FlushInfo(lastDocID, bytesUsed.get()));
      tmpDirectory = new TrackingTmpOutputDirectoryWrapper(directory);
      writer = codec.termVectorsFormat().vectorsWriter(tmpDirectory, info, context);
      lastDocID = 0;
    }
  }

