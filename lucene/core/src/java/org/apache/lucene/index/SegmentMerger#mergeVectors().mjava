  /**
   * Merge the TermVectors from each of the segments into the new one.
   * @throws IOException if there is a low-level IO error
   */
  private int mergeVectors() throws IOException {
    final TermVectorsWriter termVectorsWriter = codec.termVectorsFormat().vectorsWriter(directory, mergeState.segmentInfo, context);
    
    boolean success = false;
    int numDocs;
    try {
      numDocs = termVectorsWriter.merge(mergeState);
      success = true;
    } finally {
      if (success) {
        IOUtils.close(termVectorsWriter);
      } else {
        IOUtils.closeWhileHandlingException(termVectorsWriter);
      }
    }
    return numDocs;
  }

