  /**
   * Returns SortedNumericDocValues for the reader, or {@link #emptySortedNumeric} if it has none. 
   */
  public static SortedNumericDocValues getSortedNumeric(AtomicReader in, String field) throws IOException {
    SortedNumericDocValues dv = in.getSortedNumericDocValues(field);
    if (dv == null) {
      NumericDocValues single = in.getNumericDocValues(field);
      if (single == null) {
        return emptySortedNumeric(in.maxDoc());
      }
      Bits bits = in.getDocsWithField(field);
      return singleton(single, bits);
    }
    return dv;
  }

