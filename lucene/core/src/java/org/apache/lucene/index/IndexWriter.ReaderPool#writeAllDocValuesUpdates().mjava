    void writeAllDocValuesUpdates() throws IOException {
      Collection<ReadersAndUpdates> copy;
      synchronized (this) {
        copy = new HashSet<>(readerMap.values());
      }
      boolean any = false;
      for (ReadersAndUpdates rld : copy) {
        any |= rld.writeFieldUpdates(directory, bufferedUpdatesStream.getCompletedDelGen(), infoStream);
      }
      if (any) {
        checkpoint();
      }
    }

