  private boolean assertActiveDeleteQueue(DocumentsWriterDeleteQueue queue) {
    final Iterator<ThreadState> allActiveThreads = perThreadPool.getActivePerThreadsIterator();
    while (allActiveThreads.hasNext()) {
      final ThreadState next = allActiveThreads.next();
      next.lock();
      try {
        assert !next.isActive() || next.perThread.deleteQueue == queue;
      } finally {
        next.unlock();
      }
    }
    return true;
  }

