  /**
   * Returns the number of deletes a merge would claim back if the given segment is merged.
   * @see MergePolicy#numDeletesToMerge(SegmentCommitInfo, int, org.apache.lucene.util.IOSupplier)
   * @param info the segment to get the number of deletes for
   * @lucene.experimental
   */
  public final int numDeletesToMerge(SegmentCommitInfo info) throws IOException {
    MergePolicy mergePolicy = config.getMergePolicy();
    final ReadersAndUpdates rld = readerPool.get(info, true);
    try {
      int numDeletesToMerge = rld.numDeletesToMerge(mergePolicy);
      assert numDeletesToMerge <= info.info.maxDoc() :
          "numDeletesToMerge: " + numDeletesToMerge + " > maxDoc: " + info.info.maxDoc();
      return numDeletesToMerge;
    } finally {
      readerPool.release(rld);
    }

  }

