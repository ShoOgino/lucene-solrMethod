  private Map<SegmentCommitInfo,Long> getSegmentSizes(IndexWriter writer, Collection<SegmentCommitInfo> infos) throws IOException {
    Map<SegmentCommitInfo,Long> sizeInBytes = new HashMap<>();
    for (SegmentCommitInfo info : infos) {
      sizeInBytes.put(info, size(info, writer));
    }
    return sizeInBytes;
  }

