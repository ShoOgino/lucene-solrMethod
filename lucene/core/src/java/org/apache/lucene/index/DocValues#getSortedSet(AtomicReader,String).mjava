  /**
   * Returns SortedSetDocValues for the reader, or {@link #EMPTY_SORTED_SET} if it has none. 
   */
  public static SortedSetDocValues getSortedSet(AtomicReader in, String field) throws IOException {
    SortedSetDocValues dv = in.getSortedSetDocValues(field);
    if (dv == null) {
      SortedDocValues sorted = in.getSortedDocValues(field);
      if (sorted == null) {
        return EMPTY_SORTED_SET;
      }
      return singleton(sorted);
    }
    return dv;
  }

