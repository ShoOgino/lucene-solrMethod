    protected void publish(DocumentsWriter writer) throws IOException {
      assert !published : "ticket was already publised - can not publish twice";
      published = true;
      writer.finishFlush(segment, frozenDeletes);
    }

