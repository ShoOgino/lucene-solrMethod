  /**
   * Returns BinaryDocValues for the reader, or {@link #EMPTY_BINARY} if it has none. 
   */
  public static BinaryDocValues getBinary(AtomicReader in, String field) throws IOException {
    BinaryDocValues dv = in.getBinaryDocValues(field);
    if (dv == null) {
      dv = in.getSortedDocValues(field);
      if (dv == null) {
        return EMPTY_BINARY;
      }
    }
    return dv;
  }

