  private boolean isMerged(SegmentInfoPerCommit info) {
    IndexWriter w = writer.get();
    assert w != null;
    boolean hasDeletions = w.numDeletedDocs(info) > 0;
    return !hasDeletions &&
      info.info.dir == w.getDirectory() &&
      (info.info.getUseCompoundFile() == useCompoundFile || noCFSRatio < 1.0);
  }

