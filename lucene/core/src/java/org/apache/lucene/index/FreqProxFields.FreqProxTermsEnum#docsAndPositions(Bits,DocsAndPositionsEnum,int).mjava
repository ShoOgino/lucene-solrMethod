    @Override
    public DocsAndPositionsEnum docsAndPositions(Bits liveDocsIn, DocsAndPositionsEnum reuse, int flags) {
      if (liveDocsIn != null) {
        throw new IllegalArgumentException("liveDocs must be null");
      }
      FreqProxDocsAndPositionsEnum posEnum;

      if (!terms.hasProx) {
        // Caller wants positions but we didn't index them;
        // don't lie:
        throw new IllegalArgumentException("did not index positions");
      }

      if (!terms.hasOffsets && (flags & DocsAndPositionsEnum.FLAG_OFFSETS) != 0) {
        // Caller wants offsets but we didn't index them;
        // don't lie:
        throw new IllegalArgumentException("did not index offsets");
      }

      if (reuse instanceof FreqProxDocsAndPositionsEnum) {
        posEnum = (FreqProxDocsAndPositionsEnum) reuse;
        if (posEnum.postingsArray != postingsArray) {
          posEnum = new FreqProxDocsAndPositionsEnum(terms, postingsArray, liveDocs);
        } else {
          assert posEnum.liveDocs == liveDocs;
        }
      } else {
        posEnum = new FreqProxDocsAndPositionsEnum(terms, postingsArray, liveDocs);
      }
      posEnum.reset(sortedTermIDs[ord]);
      return posEnum;
    }

