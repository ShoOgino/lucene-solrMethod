  final boolean isFullyDeleted(ReadersAndUpdates readersAndUpdates) throws IOException {
    if (readersAndUpdates.isFullyDeleted()) {
      SegmentReader reader = readersAndUpdates.getReader(IOContext.READ);
      try {
        return config.mergePolicy.keepFullyDeletedSegment(reader) == false;
      } finally {
        readersAndUpdates.release(reader);
      }
    }
    return false;
  }

