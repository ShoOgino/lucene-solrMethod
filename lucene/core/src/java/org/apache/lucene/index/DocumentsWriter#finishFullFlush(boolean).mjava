  final void finishFullFlush(boolean success) {
    try {
      if (infoStream.isEnabled("DW")) {
        infoStream.message("DW", Thread.currentThread().getName() + " finishFullFlush success=" + success);
      }
      assert setFlushingDeleteQueue(null);
      if (success) {
        // Release the flush lock
        flushControl.finishFullFlush();
      } else {
        Set<String> newFilesSet = new HashSet<>();
        flushControl.abortFullFlushes(newFilesSet);
        putEvent(new DeleteNewFilesEvent(newFilesSet));

      }
    } finally {
      pendingChangesInCurrentFullFlush = false;
    }
    
  }

