  public void addValue(int docID, BytesRef value) {
    final int oldBytesUsed = bytesUsed;
    if (value == null) {
      // nocommit improve message
      throw new IllegalArgumentException("null binaryValue not allowed (field=" + fieldInfo.name + ")");
    }
    mergeLength(value.length);
    // Fill in any holes:
    while(pending.size() < docID) {
      pending.add(BytesRef.EMPTY_BYTES);
      bytesUsed += RamUsageEstimator.NUM_BYTES_OBJECT_REF;
      mergeLength(0);
    }
    byte[] bytes = new byte[value.length];
    System.arraycopy(value.bytes, value.offset, bytes, 0, value.length);
    pending.add(bytes);

    // estimate 25% overhead for ArrayList:
    bytesUsed += (int) (bytes.length + RamUsageEstimator.NUM_BYTES_ARRAY_HEADER + (RamUsageEstimator.NUM_BYTES_OBJECT_REF * 1.25));
    iwBytesUsed.addAndGet(bytesUsed - oldBytesUsed);
    //System.out.println("ADD: " + value);
  }

