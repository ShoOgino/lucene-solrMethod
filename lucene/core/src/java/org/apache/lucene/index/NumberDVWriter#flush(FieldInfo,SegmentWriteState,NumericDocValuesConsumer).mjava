  public void flush(FieldInfo fieldInfo, SegmentWriteState state, NumericDocValuesConsumer consumer) throws IOException {
    final int bufferedDocCount = pending.size();

    AppendingLongBuffer.Iterator it = pending.iterator();
    for(int docID=0;docID<bufferedDocCount;docID++) {
      assert it.hasNext();
      consumer.add(it.next());
    }
    assert !it.hasNext();
    final int maxDoc = state.segmentInfo.getDocCount();
    for(int docID=bufferedDocCount;docID<maxDoc;docID++) {
      consumer.add(0);
    }
    consumer.finish();
    reset();
    //System.out.println("FLUSH");
  }

