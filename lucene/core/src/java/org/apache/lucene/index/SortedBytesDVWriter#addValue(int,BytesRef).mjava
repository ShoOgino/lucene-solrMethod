  public void addValue(int docID, BytesRef value) {
    final int oldBytesUsed = bytesUsed;
    if (value == null) {
      // nocommit improve message
      throw new IllegalArgumentException("null sortedValue not allowed (field=" + fieldInfo.name + ")");
    }

    // Fill in any holes:
    while(pending.size() < docID) {
      addOneValue(EMPTY);
    }

    addOneValue(value);
    iwBytesUsed.addAndGet(bytesUsed - oldBytesUsed);
  }

