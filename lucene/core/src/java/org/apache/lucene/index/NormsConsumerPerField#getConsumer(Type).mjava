  private DocValuesConsumer getConsumer(Type type) throws IOException {
    if (consumer == null) {
      assert fieldInfo.getNormType() == null || fieldInfo.getNormType() == type;
      fieldInfo.setNormValueType(type);
      consumer = parent.newConsumer(docState.docWriter.newPerDocWriteState(""), fieldInfo, type);
      this.initType = type;
    }
    if (initType != type) {
      throw new IllegalArgumentException("NormTypes for field: " + fieldInfo.name + " doesn't match " + initType + " != " + type);
    }
    return consumer;
  }

