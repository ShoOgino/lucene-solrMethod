  @Override
  public boolean next() {
    if (termQueue.size() == 0) {
      // Current field is done:
      if (fieldQueue.size() == 0) {
        // No more fields:
        field = null;
        return true;
      }

      // Transfer all iterators on the next field into the term queue:
      TermIterator top = fieldQueue.pop();
      termQueue.add(top);
      assert top.field() != null;

      while (fieldQueue.size() != 0 && fieldQueue.top().field.equals(top.field)) {
        termQueue.add(fieldQueue.pop());
      }

      field = top.field;
      return true;
    } else {
      TermIterator top = termQueue.top();
      if (top.next()) {
        // New field
        termQueue.pop();
        if (top.field() != null) {
          fieldQueue.add(top);
        }
      } else {
        termQueue.updateTop();
      }

      if (termQueue.size() != 0) {
        // Still terms left in this field
        return false;
      } else {
        // Recurse (just once) to go to next field:                                                                                                                                        
        return next();
      }
    }
  }

