  /**
   * Indicates whether this segment is currently being merged. Call this just
   * before the segment is being merged with {@code true} and when the merge has
   * finished and all updates have been applied to the merged segment, call this
   * with {@code false}.
   */
  public synchronized void setMerging(boolean isMerging) {
    this.isMerging = isMerging;
    if (!isMerging) {
      mergingUpdates.clear();
    }
  }

