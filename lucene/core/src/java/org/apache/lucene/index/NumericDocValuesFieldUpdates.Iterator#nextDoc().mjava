    @Override
    int nextDoc() {
      if (idx >= size) {
        value = null;
        return doc = DocIdSetIterator.NO_MORE_DOCS;
      }
      doc = (int) docs.get(idx);
      ++idx;
      while (idx < size && docs.get(idx) == doc) {
        ++idx;
      }
      if (!docsWithField.get((int) (idx - 1))) {
        value = null;
      } else {
        // idx points to the "next" element
        value = Long.valueOf(values.get(idx - 1));
      }
      return doc;
    }

