  @Override
  void finish() throws IOException {
    if (fieldInfo.isIndexed() && !fieldInfo.omitsNorms()) {
      if (consumer == null) {
        // nocommit wrongish?  what about the
        // only-doc-with-norms-enabled-hits-exc case?
        fieldInfo.setNormValueType(FieldInfo.DocValuesType.NUMERIC);
        consumer = new NumberDVWriter(fieldInfo, docState.docWriter.bytesUsed);
      }
      consumer.addValue(docState.docID, similarity.computeNorm(fieldState));
    }
  }

