    @Override
    public void process(IndexWriter writer, boolean triggerMerge, boolean forcePurge) throws IOException {
      try {
        packet.apply(writer);
      } catch (Throwable t) {
        writer.tragicEvent(t, "applyUpdatesPacket");
      }
      writer.flushDeletesCount.incrementAndGet();
    }

