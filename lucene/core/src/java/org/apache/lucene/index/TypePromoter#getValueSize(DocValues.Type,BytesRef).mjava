  public static int getValueSize(DocValues.Type type, BytesRef ref) {
    switch (type) {
      case VAR_INTS:
      case BYTES_VAR_DEREF:
      case BYTES_VAR_SORTED:
      case BYTES_VAR_STRAIGHT:
        return -1;
      case BYTES_FIXED_DEREF:
      case BYTES_FIXED_SORTED:
      case BYTES_FIXED_STRAIGHT:
        assert ref != null;
        return ref.length;
      case FIXED_INTS_16:
        return 2;
      case FLOAT_32:
      case FIXED_INTS_32:
        return 4;
      case FLOAT_64:
      case FIXED_INTS_64:
        return 8;
      case FIXED_INTS_8:
        return 1;
      default:
        throw new IllegalArgumentException("unknonw docvalues type: "
            + type.name());
    }
  }

