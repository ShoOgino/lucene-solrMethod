  // nocommit move elsewhere?  IndexFileNames?
  public static List<String> findMatchingFiles(Directory dir, Set<String> namesOrPatterns) {
    // nocommit need more efficient way to do this?
    List<String> files = new ArrayList<String>();
    final String[] existingFiles;
    try {
      existingFiles = dir.listAll();
    } catch (IOException ioe) {
      // nocommit maybe just throw IOE...? not sure how far up we'd have to change sigs...
      throw new RuntimeException(ioe);
    }
    for(String nameOrPattern : namesOrPatterns) {
      boolean exists = false;
      try {
        exists = dir.fileExists(nameOrPattern);
      } catch (IOException ioe) {
        // nocommit maybe just throw IOE...?
        // Ignore
      }
      if (exists) {
        files.add(nameOrPattern);
      } else {
        for(String file : existingFiles) {
          if (Pattern.matches(nameOrPattern, file)) {
            files.add(file);
          }
        }
      }
    }

    return files;
  }

