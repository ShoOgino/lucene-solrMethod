  /** Calls StoredFieldsWriter.startDocument, aborting the
   *  segment if it hits any exception. */
  private void startStoredFields() throws IOException {
    boolean success = false;
    try {
      initStoredFieldsWriter();
      storedFieldsWriter.startDocument();
      success = true;
    } finally {
      if (success == false) {
        docWriter.setAborting();        
      }
    }
    lastStoredDocID++;
  }

