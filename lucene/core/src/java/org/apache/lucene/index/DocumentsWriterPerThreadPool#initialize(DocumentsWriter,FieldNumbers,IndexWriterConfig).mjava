  void initialize(DocumentsWriter documentsWriter, FieldNumbers globalFieldMap, IndexWriterConfig config) {
    this.documentsWriter.set(documentsWriter); // thread pool is bound to DW
    this.globalFieldMap.set(globalFieldMap);
    for (int i = 0; i < threadStates.length; i++) {
      final FieldInfos.Builder infos = new FieldInfos.Builder(globalFieldMap);
      threadStates[i] = new ThreadState(new DocumentsWriterPerThread(documentsWriter.directory, documentsWriter, infos, documentsWriter.chain));
    }
  }

