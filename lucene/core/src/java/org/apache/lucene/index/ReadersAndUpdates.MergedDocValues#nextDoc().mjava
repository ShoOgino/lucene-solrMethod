    @Override
    public int nextDoc() throws IOException {
      if (docIDOnDisk == docIDOut) {
        if (onDiskDocValues == null) {
          docIDOnDisk = NO_MORE_DOCS;
        } else {
          docIDOnDisk = onDiskDocValues.nextDoc();
        }
      }
      if (updateDocID == docIDOut) {
        updateDocID = updateDocValues.nextDoc();
      }
      if (docIDOnDisk < updateDocID) {
        // no update to this doc - we use the on-disk values
        docIDOut = docIDOnDisk;
        currentValuesSupplier = onDiskDocValues;
      } else {
        docIDOut = updateDocID;
        if (docIDOut != NO_MORE_DOCS) {
          currentValuesSupplier = updateDocValues;
        }
      }
      return docIDOut;
    }

