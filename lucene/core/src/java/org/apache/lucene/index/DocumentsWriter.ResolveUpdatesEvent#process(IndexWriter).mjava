    @Override
    public void process(IndexWriter writer) throws IOException {
      try {
        packet.apply(writer);
      } catch (Throwable t) {
        try {
          writer.onTragicEvent(t, "applyUpdatesPacket");
        } finally {
          throw t;
        }
      }
      writer.flushDeletesCount.incrementAndGet();
    }

