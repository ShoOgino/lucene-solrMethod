  private final void abortThreadState(final ThreadState perThread) {
    assert perThread.isHeldByCurrentThread();
    if (perThread.isActive()) { // we might be closed
      if (perThread.isInitialized()) { 
        try {
          subtractFlushedNumDocs(perThread.dwpt.getNumDocsInRAM());
          perThread.dwpt.abort();
        } finally {
          flushControl.doOnAbort(perThread);
        }
      } else {
        flushControl.doOnAbort(perThread);
      }
    } else {
      assert closed;
    }
  }

