  @Override
  DocumentsWriterPerThread reset(ThreadState threadState, boolean closed) {
    // Remove all previous bindings to this ThreadState on flush:
    Iterator<Map.Entry<Thread,ThreadState>> it = threadBindings.entrySet().iterator();
    while (it.hasNext()) {
      Map.Entry<Thread,ThreadState> ent = it.next();
      if (ent.getValue() == threadState) {
        it.remove();
      }
    }
    return super.reset(threadState, closed);
  }

