  /**
   * Called from IndexWriter after applying deletes to the merged segment, while
   * it was being merged.
   */
  public synchronized void setMergingUpdates(Map<Integer,Map<String,Long>> updates) {
    for (Entry<Integer,Map<String,Long>> e : updates.entrySet()) {
      int doc = e.getKey().intValue();
      for (Entry<String,Long> docUpdates : e.getValue().entrySet()) {
        String field = docUpdates.getKey();
        Long value = docUpdates.getValue();
        Map<Integer,Long> fieldUpdates = numericUpdates.get(field);
        if (fieldUpdates == null) {
          fieldUpdates = new HashMap<Integer,Long>();
          numericUpdates.put(field, fieldUpdates);
        }
        fieldUpdates.put(doc, value);
      }
    }
  }

