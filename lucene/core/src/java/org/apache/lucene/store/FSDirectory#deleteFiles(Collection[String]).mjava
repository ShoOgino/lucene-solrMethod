  @Override
  public void deleteFiles(Collection<String> names) throws IOException {
    ensureOpen();
    // nocommit isn't it an error if they were already pending delete?
    pendingDeletes.addAll(names);
    deletePendingFiles();
  }

