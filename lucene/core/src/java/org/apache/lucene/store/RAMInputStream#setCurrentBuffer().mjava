  private final void setCurrentBuffer() throws IOException {
    if (currentBufferIndex < file.numBuffers()) {
      currentBuffer = file.getBuffer(currentBufferIndex);
      assert currentBuffer != null;
      long bufferStart = (long) BUFFER_SIZE * (long) currentBufferIndex;
      bufferLength = (int) Math.min(BUFFER_SIZE, length - bufferStart);
    } else {
      currentBuffer = null;
    }
  }

