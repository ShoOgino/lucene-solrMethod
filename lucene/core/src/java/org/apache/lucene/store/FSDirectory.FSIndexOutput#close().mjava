    @Override
    public void close() throws IOException {
      parent.onIndexOutputClosed(name);
      // only close the file if it has not been closed yet
      if (isOpen) {
        boolean success = false;
        try {
          super.close();
          success = true;
        } finally {
          isOpen = false;
          if (success) {
            IOUtils.close(file);
          } else {
            IOUtils.closeWhileHandlingException(file);
          }
        }
      }
    }

