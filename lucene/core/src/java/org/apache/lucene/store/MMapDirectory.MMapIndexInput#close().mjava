    @Override
    public void close() throws IOException {
      try {
        if (isClone || buffers == null) return;
        
        // make local copy, then un-set early
        final ByteBuffer[] bufs = buffers;
        unsetBuffers();
        
        // for extra safety unset also all clones' buffers:
        for (Iterator<MMapIndexInput> it = this.clones.keyIterator(); it.hasNext();) {
          final MMapIndexInput clone = it.next();
          assert clone.isClone;
          clone.unsetBuffers();
        }
        this.clones.clear();
        
        for (final ByteBuffer b : bufs) {
          cleanMapping(b);
        }
      } finally {
        unsetBuffers();
      }
    }

