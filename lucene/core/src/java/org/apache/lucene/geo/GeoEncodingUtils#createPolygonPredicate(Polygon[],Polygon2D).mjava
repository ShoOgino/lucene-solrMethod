  /** Create a predicate that checks whether points are within a polygon.
   *  It works the same way as {@link #createDistancePredicate}.
   *  @lucene.internal */
  public static PolygonPredicate createPolygonPredicate(Polygon[] polygons, Polygon2D tree) {
    final Rectangle boundingBox = Rectangle.fromPolygon(polygons);
    final Function<Rectangle, Relation> boxToRelation = box -> tree.relate(
        box.minLat, box.maxLat, box.minLon, box.maxLon);
    final Grid subBoxes = createSubBoxes(boundingBox, boxToRelation);

    return new PolygonPredicate(
        subBoxes.latShift, subBoxes.lonShift,
        subBoxes.latBase, subBoxes.lonBase,
        subBoxes.maxLatDelta, subBoxes.maxLonDelta,
        subBoxes.relations,
        tree);
  }

