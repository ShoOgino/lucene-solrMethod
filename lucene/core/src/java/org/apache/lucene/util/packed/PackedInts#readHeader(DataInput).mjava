  /**
   * Expert: reads only the metadata from a stream. This is useful to later
   * restore a stream or open a direct reader via 
   * {@link #getReaderNoHeader(DataInput, Header)}
   * or {@link #getDirectReaderNoHeader(IndexInput, Header)}.
   * @param    in the stream to read data
   * @return   packed integer metadata.
   * @throws   IOException If there is a low-level I/O error
   * @see #getReaderNoHeader(DataInput, Header)
   * @see #getDirectReaderNoHeader(IndexInput, Header)
   */
  public static Header readHeader(DataInput in) throws IOException {
    final int version = CodecUtil.checkHeader(in, CODEC_NAME, VERSION_START, VERSION_CURRENT);
    final int bitsPerValue = in.readVInt();
    assert bitsPerValue > 0 && bitsPerValue <= 64: "bitsPerValue=" + bitsPerValue;
    final int valueCount = in.readVInt();
    final Format format = Format.byId(in.readVInt());
    return new Header(format, valueCount, bitsPerValue, version);
  }

