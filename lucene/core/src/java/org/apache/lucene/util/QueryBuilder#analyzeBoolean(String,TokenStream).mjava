  /** 
   * Creates simple boolean query from the cached tokenstream contents 
   */
  private Query analyzeBoolean(String field, TokenStream stream) throws IOException {
    BooleanQuery.Builder q = new BooleanQuery.Builder();
    q.setDisableCoord(true);

    TermToBytesRefAttribute termAtt = stream.getAttribute(TermToBytesRefAttribute.class);
    
    stream.reset();
    while (stream.incrementToken()) {
      Query currentQuery = newTermQuery(new Term(field, BytesRef.deepCopyOf(termAtt.getBytesRef())));
      q.add(currentQuery, BooleanClause.Occur.SHOULD);
    }
    
    return q.build();
  }

