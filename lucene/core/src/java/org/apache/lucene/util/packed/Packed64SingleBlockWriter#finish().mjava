  @Override
  public void finish() throws IOException {
    while (written < valueCount) {
      add(0L); // Auto flush
    }

    if (shift > 0) {
      // add was called at least once
      out.writeLong(pending);
    }
  }

