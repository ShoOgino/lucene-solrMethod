  PackedReaderIterator(PackedInts.Format format, int valueCount, int bitsPerValue, DataInput in, int mem) {
    super(valueCount, bitsPerValue, in);
    this.format = format;
    bulkOperation = BulkOperation.of(format, bitsPerValue);
    iterations = bulkOperation.computeIterations(valueCount, mem);
    assert valueCount == 0 || iterations > 0;
    nextBlocks = new long[iterations * bulkOperation.blockCount()];
    nextValues = new LongsRef(new long[iterations * bulkOperation.valueCount()], 0, 0);
    assert iterations * bulkOperation.valueCount() == nextValues.longs.length;
    assert iterations * bulkOperation.blockCount() == nextBlocks.length;
    nextValues.offset = nextValues.longs.length;
    position = -1;
  }

