  PagedGrowableWriter(long size, int pageSize,int startBitsPerValue, float acceptableOverheadRatio, boolean fillPages) {
    this.size = size;
    this.startBitsPerValue = startBitsPerValue;
    this.acceptableOverheadRatio = acceptableOverheadRatio;
    pageShift = checkBlockSize(pageSize, MIN_BLOCK_SIZE, MAX_BLOCK_SIZE);
    pageMask = pageSize - 1;
    final int numPages = numBlocks(size, pageSize);
    subWriters = new GrowableWriter[numPages];
    if (fillPages) {
      for (int i = 0; i < numPages; ++i) {
        // do not allocate for more entries than necessary on the last page
        final int valueCount = i == numPages - 1 ? lastPageSize(size) : pageSize;
        subWriters[i] = new GrowableWriter(startBitsPerValue, valueCount, acceptableOverheadRatio);
      }
    }
  }

