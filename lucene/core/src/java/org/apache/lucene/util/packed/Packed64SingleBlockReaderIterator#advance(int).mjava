  @Override
  public long advance(int ord) throws IOException {
    assert ord < valueCount : "ord must be less than valueCount";
    assert ord > position : "ord must be greater than the current position";

    final int valuesPerBlock = 64 / bitsPerValue;
    final long nextBlock = (position + valuesPerBlock) / valuesPerBlock;
    final long targetBlock = ord / valuesPerBlock;
    final long blocksToSkip = targetBlock - nextBlock;
    if (blocksToSkip > 0) {
      final long skip = blocksToSkip << 3;
      final long filePointer = in.getFilePointer();

      in.seek(filePointer + skip);
      shift = 64;

      final int offsetInBlock = ord % valuesPerBlock;
      for (int i = 0; i < offsetInBlock; ++i) {
        next();
      }
    } else {
      for (int i = position; i < ord - 1; ++i) {
        next();
      }
    }

    position = ord - 1;
    return next();
  }

