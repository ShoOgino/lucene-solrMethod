  @Override
  public void destroy() throws IOException {
    if (sharedReader != null) {
      // At this point, the shared reader should have done a full sweep of the file:
      assert nextSharedRead == count;
      sharedReader.close();
      sharedReader = null;
    }
    tempDir.deleteFile(out.getName());
  }

