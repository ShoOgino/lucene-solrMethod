  /**
   * Return the number of bytes used by this instance.
   */
  public long ramBytesUsed() {
    long bytesUsed = RamUsageEstimator.alignObjectSize(
        RamUsageEstimator.NUM_BYTES_OBJECT_HEADER
        + 3 * RamUsageEstimator.NUM_BYTES_OBJECT_REF // the 3 arrays
        + 2 * RamUsageEstimator.NUM_BYTES_INT) // the 2 offsets
        + RamUsageEstimator.sizeOf(pending)
        + RamUsageEstimator.sizeOf(minValues)
        + RamUsageEstimator.alignObjectSize(RamUsageEstimator.NUM_BYTES_ARRAY_HEADER + (long) RamUsageEstimator.NUM_BYTES_OBJECT_REF * values.length); // values

    for (int i = 0; i < valuesOff; ++i) {
      bytesUsed += values[i].ramBytesUsed();
    }
    return bytesUsed;
  }

