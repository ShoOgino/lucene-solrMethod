  @Override
  public void close() throws IOException {
    if (closed == false) {
      assert sharedReader == null;
      try {
        CodecUtil.writeFooter(out);
      } finally {
        out.close();
        closed = true;
      }
    }
  }

