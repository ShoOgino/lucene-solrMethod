  /**
   * Counts all bits set in the provided longs.
   *
   * @param bits     The bits stored in an array of long for efficiency.
   * @param numLongs The number of longs in {@code bits} to consider.
   */
  public static int countBits(long[] bits, int numLongs) {
    assert numLongs >= 0 && numLongs <= bits.length
        : "numLongs=" + numLongs + " bits.length=" + bits.length;
    int bitCount = 0;
    for (int i = 0; i < numLongs; i++) {
      bitCount += Long.bitCount(bits[i]);
    }
    return bitCount;
  }

