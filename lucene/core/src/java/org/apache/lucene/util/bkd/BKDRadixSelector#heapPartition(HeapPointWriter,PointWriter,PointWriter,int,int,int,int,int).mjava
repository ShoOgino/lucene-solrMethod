  private byte[] heapPartition(HeapPointWriter points, PointWriter left, PointWriter right, int dim, int from, int to, int partitionPoint, int commonPrefix) throws IOException {

    byte[] partition = heapRadixSelect(points, dim, from, to, partitionPoint, commonPrefix);

    for (int i = from; i < to; i++) {
      points.getPackedValueSlice(i, bytesRef1);
      int docID = points.docIDs[i];
      if (i < partitionPoint) {
        left.append(bytesRef1, docID);
      } else {
        right.append(bytesRef1, docID);
      }
    }

    return partition;
  }

