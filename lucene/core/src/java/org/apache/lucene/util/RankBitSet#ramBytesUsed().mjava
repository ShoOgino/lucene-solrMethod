  @Override
  public long ramBytesUsed() {
    return RamUsageEstimator.alignObjectSize(RamUsageEstimator.NUM_BYTES_OBJECT_REF*2 +
        Integer.BYTES + Long.BYTES) +
        inner.ramBytesUsed() +
        (rankCache == null ? 0 :
            RamUsageEstimator.NUM_BYTES_ARRAY_HEADER + Long.BYTES*rankCache.length);
  }

