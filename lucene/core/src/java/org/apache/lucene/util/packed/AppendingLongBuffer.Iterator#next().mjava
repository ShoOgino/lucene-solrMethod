    /** Return the next long in the buffer. */
    public long next() {
      assert hasNext();
      long result = currentValues[pOff++];
      if (pOff == MAX_PENDING_COUNT) {
        vOff += 1;
        pOff = 0;
        if (vOff <= valuesOff) {
          fillValues();
        }
      }
      return result;
    }

