  private void upgradeToBitSet() {
    assert bitSet == null;
    bitSet = new FixedBitSet(maxDoc);
    for (int i = 0; i < bufferSize; ++i) {
      bitSet.set(buffer[i]);
    }
    counter = this.bufferSize;
    this.buffer = null;
    this.bufferSize = 0;
    this.adder = new FixedBitSetAdder(bitSet);
  }

