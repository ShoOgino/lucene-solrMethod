  /** Append a value to this buffer. */
  public final void add(long l) {
    if (pendingOff == MAX_PENDING_COUNT) {
      // check size
      if (deltas.length == valuesOff) {
        final int newLength = ArrayUtil.oversize(valuesOff + 1, 8);
        grow(newLength);
      }
      packPendingValues();
      if (deltas[valuesOff] != null) {
        deltasBytes += deltas[valuesOff].ramBytesUsed();
      }
      ++valuesOff;
      // reset pending buffer
      pendingOff = 0;
    }
    pending[pendingOff++] = l;
  }

