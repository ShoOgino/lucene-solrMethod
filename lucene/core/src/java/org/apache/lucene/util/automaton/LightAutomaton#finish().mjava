  public void finish() {
    if (curState != -1) {
      //System.out.println("finish: finish current state " + curState);
      finishCurrentState();
      curState = -1;
    }
    // nocommit downsize the arrays?
    //assert getNumStates() > 0;
  }

