  /** 
   * Creates simple term query from the cached tokenstream contents 
   */
  private Query analyzeTerm(String field, TokenStream stream) throws IOException {
    TermToBytesRefAttribute termAtt = stream.getAttribute(TermToBytesRefAttribute.class);
    
    stream.reset();
    if (!stream.incrementToken()) {
      throw new AssertionError();
    }
    
    return newTermQuery(new Term(field, BytesRef.deepCopyOf(termAtt.getBytesRef())));
  }

