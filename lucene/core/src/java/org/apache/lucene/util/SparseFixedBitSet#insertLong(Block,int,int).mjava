  private void insertLong(Block block, int i64, int i) {
    block.index |= 1L << i64; // shifts are mod 64 in java
    // we count the number of bits that are set on the right of i64
    // this gives us the index at which to perform the insertion
    final int o = Long.bitCount(block.index & ((1L << i64) - 1));
    if (block.bits[block.bits.length - 1] == 0) {
      // since we only store non-zero longs, if the last value is 0, it means
      // that we alreay have extra space, make use of it
      System.arraycopy(block.bits, o, block.bits, o + 1, block.bits.length - o - 1);
      block.bits[o] = 1L << i;
    } else {
      // we don't have extra space so we need to resize to insert the new long
      final int newSize = oversize(block.bits.length + 1);
      final long[] newBitArray = new long[newSize];
      System.arraycopy(block.bits, 0, newBitArray, 0, o);
      newBitArray[o] = 1L << i;
      System.arraycopy(block.bits, o, newBitArray, o + 1, block.bits.length - o);
      block.bits = newBitArray;
      ramBytesUsed += (newSize - block.bits.length) * RamUsageEstimator.NUM_BYTES_LONG;
    }
    ++nonZeroLongCount;
  }

