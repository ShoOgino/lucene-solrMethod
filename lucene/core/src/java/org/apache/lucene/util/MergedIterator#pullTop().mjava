  private void pullTop() {
    // extract all subs from the queue that have the same top element
    assert numTop == 0;
    while (true) {
      top[numTop++] = queue.pop();
      if (queue.size() == 0
          || !(queue.top()).current.equals(top[0].current)) {
        break;
      }
    }
    current = top[0].current;
  }

