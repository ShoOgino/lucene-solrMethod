  private static Writer getWriterByFormat(DataOutput out,
      int valueCount, int bitsPerValue, int format) throws IOException {
    switch (format) {
      case PACKED:
        return new PackedWriter(out, valueCount, bitsPerValue);
      case PACKED_SINGLE_BLOCK:
        return new Packed64SingleBlockWriter(out, valueCount, bitsPerValue);
      default:
        throw new IllegalArgumentException("Unknown format " + format);
    }
  }

