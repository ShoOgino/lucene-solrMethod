  //return a new point writer sort by the provided dimension from start to start + pointCount
  private PointWriter sort(int dim, PointWriter writer, final long start, final long pointCount) throws IOException {
    assert dim >= 0 && dim < numDataDims;

    if (writer instanceof HeapPointWriter) {
      HeapPointWriter heapPointWriter = createHeapPointWriterCopy((HeapPointWriter) writer, start, pointCount);
      sortHeapPointWriter(heapPointWriter, Math.toIntExact(pointCount), dim);
      return heapPointWriter;
    } else {
      OfflinePointWriter offlinePointWriter = (OfflinePointWriter) writer;
      return sortOffLine(dim, offlinePointWriter.name, start, pointCount);
    }
  }

