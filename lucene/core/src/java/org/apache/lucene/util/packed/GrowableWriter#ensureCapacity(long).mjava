  private void ensureCapacity(long value) {
    assert value >= 0;
    if (value <= currentMaxValue) {
      return;
    }
    final int bitsRequired = PackedInts.bitsRequired(value);
    final int valueCount = size();
    PackedInts.Mutable next = PackedInts.getMutable(valueCount, bitsRequired, acceptableOverheadRatio);
    PackedInts.copy(current, 0, next, 0, valueCount, PackedInts.DEFAULT_BUFFER_SIZE);
    current = next;
    currentMaxValue = PackedInts.maxValue(current.getBitsPerValue());
  }

