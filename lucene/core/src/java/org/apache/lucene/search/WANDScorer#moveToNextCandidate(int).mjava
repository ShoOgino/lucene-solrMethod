  /** Set 'doc' to the next potential match, and move all disis of 'head' that
   *  are on this doc into 'lead'. */
  private void moveToNextCandidate(int target) throws IOException {
    // Update score bounds if necessary so
    updateMaxScoresIfNecessary(target);
    assert upTo >= target;

    // If the head is empty, it means that the sum of all max scores is not
    // enough to produce a competitive score. So we jump to the next block.
    while (head.size() == 0) {
      if (upTo == DocIdSetIterator.NO_MORE_DOCS) {
        doc = DocIdSetIterator.NO_MORE_DOCS;
        return;
      }
      updateMaxScores(upTo + 1);
    }

    // The top of `head` defines the next potential match
    // pop all documents which are on this doc
    lead = head.pop();
    lead.next = null;
    leadMaxScore = lead.maxScore;
    doc = lead.doc;
    while (head.size() > 0 && head.top().doc == doc) {
      addLead(head.pop());
    }
  }

