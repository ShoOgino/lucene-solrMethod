    @Override
    public int compareTop(int doc) {

      int ord = termsIndex.getOrd(doc);

      if (topSameReader) {
        // ord is precisely comparable, even in the equal case
        return topOrd - ord;
      } else if (ord <= topOrd) {
        // the equals case always means doc is < value
        // (because we set lastOrd to the lower bound)
        return 1;
      } else {
        return -1;
      }
    }

