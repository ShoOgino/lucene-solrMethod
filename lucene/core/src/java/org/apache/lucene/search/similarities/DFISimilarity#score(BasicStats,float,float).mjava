  @Override
  protected float score(BasicStats stats, float freq, float docLen) {

    final float expected = (stats.getTotalTermFreq() + 1) * docLen / (stats.getNumberOfFieldTokens() + 1);

    // if the observed frequency is less than or equal to the expected value, then return zero.
    if (freq <= expected) return 0;

    final float measure = independence.score(freq, expected);

    return stats.getBoost() * (float) log2(measure + 1);
  }

