    @Override
    public Scorer scorer(LeafReaderContext context, Bits acceptDocs) throws IOException {
      assert termStates.topReaderContext == ReaderUtil.getTopLevelContext(context) : "The top-reader used to create Weight (" + termStates.topReaderContext + ") is not the same as the current reader's top-reader (" + ReaderUtil.getTopLevelContext(context);
      final TermsEnum termsEnum = getTermsEnum(context);
      if (termsEnum == null) {
        return null;
      }
      PostingsEnum docs = termsEnum.postings(acceptDocs, null, needsScores ? PostingsEnum.FREQS : PostingsEnum.NONE);
      assert docs != null;
      final Similarity.SimScorer simScorer;
      if (needsScores) {
        simScorer = similarity.simScorer(stats, context);
      } else {
        // avoids loading other scoring factors such as norms
        simScorer = NON_SCORING_SIM_SCORER;
      }
      return new TermScorer(this, docs, simScorer);
    }

