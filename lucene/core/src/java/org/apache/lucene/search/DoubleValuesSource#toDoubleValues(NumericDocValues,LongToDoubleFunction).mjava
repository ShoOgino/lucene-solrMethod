  private static DoubleValues toDoubleValues(NumericDocValues in, LongToDoubleFunction map) {
    return new DoubleValues() {
      @Override
      public double doubleValue() throws IOException {
        return map.applyAsDouble(in.longValue());
      }

      @Override
      public boolean advanceExact(int target) throws IOException {
        return in.advanceExact(target);
      }

    };
  }

