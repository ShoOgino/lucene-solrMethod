  @Override
  public final int advance(int target) throws IOException {
    assert doc != NO_MORE_DOCS;

    ScorerWrapper top = subScorers.top();
    while (top.doc < target) {
      top.doc = top.scorer.advance(target);
      if (top.doc == NO_MORE_DOCS) {
        subScorers.pop();
        if (subScorers.size() == 0) {
          return this.doc = NO_MORE_DOCS;
        }
        top = subScorers.top();
      } else {
        top = subScorers.updateTop();
      }
    }

    freq = -1;
    return this.doc = top.doc;
  }

