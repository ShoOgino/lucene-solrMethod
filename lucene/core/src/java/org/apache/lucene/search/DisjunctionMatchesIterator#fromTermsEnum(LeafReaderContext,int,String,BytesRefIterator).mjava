  /**
   * Create a {@link DisjunctionMatchesIterator} over a list of terms extracted from a {@link BytesRefIterator}
   *
   * Only terms that have at least one match in the given document will be included
   */
  static MatchesIterator fromTermsEnum(LeafReaderContext context, int doc, String field, BytesRefIterator terms) throws IOException {
    Objects.requireNonNull(field);
    List<MatchesIterator> mis = new ArrayList<>();
    Terms t = context.reader().terms(field);
    if (t == null)
      return null;
    TermsEnum te = t.iterator();
    PostingsEnum reuse = null;
    for (BytesRef term = terms.next(); term != null; term = terms.next()) {
      if (te.seekExact(term)) {
        PostingsEnum pe = te.postings(reuse, PostingsEnum.OFFSETS);
        if (pe.advance(doc) == doc) {
          // TODO do we want to use the copied term here, or instead create a label that associates all of the TMIs with a single term?
          mis.add(new TermMatchesIterator(BytesRef.deepCopyOf(term), pe));
          reuse = null;
        }
        else {
          reuse = pe;
        }
      }
    }
    if (mis.size() == 0)
      return null;
    if (mis.size() == 1)
      return mis.get(0);
    return new DisjunctionMatchesIterator(mis);
  }

