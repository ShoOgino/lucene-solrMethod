    /**
     * Create a {@link CacheOnLargeSegments} instance that only caches on a
     * given segment if the total number of documents in the index is greater
     * than {@code minIndexSize} and the number of documents in the segment
     * divided by the total number of documents in the index is greater than
     * or equal to {@code minSizeRatio}.
     */
    public CacheOnLargeSegments(int minIndexSize, float minSizeRatio) {
      if (minSizeRatio <= 0 || minSizeRatio >= 1) {
        throw new IllegalArgumentException("minSizeRatio must be in ]0, 1[, got " + minSizeRatio);
      }
      this.minIndexSize = minIndexSize;
      this.minSizeRatio = minSizeRatio;
    }

