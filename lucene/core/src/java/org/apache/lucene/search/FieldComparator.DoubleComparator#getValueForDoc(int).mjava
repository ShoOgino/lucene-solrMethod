    private double getValueForDoc(int doc) throws IOException {
      int curDocID = currentReaderValues.docID();
      if (doc > curDocID) {
        curDocID = currentReaderValues.advance(doc);
      }
      if (doc == curDocID) {
        return Double.longBitsToDouble(currentReaderValues.longValue());
      } else {
        return missingValue;
      }
    }

