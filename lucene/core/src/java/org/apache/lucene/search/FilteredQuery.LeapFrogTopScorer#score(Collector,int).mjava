    @Override
    public boolean score(Collector collector, int maxDoc) throws IOException {
      // the normalization trick already applies the boost of this query,
      // so we can use the wrapped scorer directly:
      collector.setScorer(scorer);
      int primDoc, secDoc;
      if (primary.docID() == -1) {
        primDoc = primary.nextDoc();
        secDoc = secondary.advance(primDoc);
      } else {
        primDoc = primary.docID();
        secDoc = secondary.docID();
      }
      for (;;) {
        if (primDoc == secDoc) {
          // Check if scorer has exhausted, only before collecting.
          if (primDoc >= maxDoc) {
            return primDoc < Scorer.NO_MORE_DOCS;
          }
          collector.collect(primDoc);
          primDoc = primary.nextDoc();
          secDoc = secondary.advance(primDoc);
        } else if (secDoc > primDoc) {
          primDoc = primary.advance(secDoc);
        } else {
          secDoc = secondary.advance(primDoc);
        }
      }
    }

