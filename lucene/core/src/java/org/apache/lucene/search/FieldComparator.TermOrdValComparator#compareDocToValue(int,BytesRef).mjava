    @Override
    public int compareDocToValue(int doc, BytesRef value) {
      int ord = termsIndex.getOrd(doc);
      if (ord == -1) {
        if (value == null) {
          return 0;
        }
        return -1;
      } else if (value == null) {
        return 1;
      }
      termsIndex.lookupOrd(ord, tempBR);
      return tempBR.compareTo(value);
    }

