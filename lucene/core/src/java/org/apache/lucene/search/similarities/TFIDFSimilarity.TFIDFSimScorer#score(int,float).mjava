    @Override
    public float score(int doc, float freq) throws IOException {
      final float raw = tf(freq) * weightValue; // compute tf(f)*weight

      if (norms == null) {
        return raw;
      } else {
        long normValue;
        int normsDocID = norms.docID();
        if (normsDocID < doc) {
          normsDocID = norms.advance(doc);
        }
        if (normsDocID == doc) {
          normValue = norms.longValue();
        } else {
          normValue = 0;
        }
        return raw * decodeNormValue(normValue);  // normalize for field
      }
    }

