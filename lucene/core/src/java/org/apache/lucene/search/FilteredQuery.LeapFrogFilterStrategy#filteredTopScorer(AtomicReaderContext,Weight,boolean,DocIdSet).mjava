    @Override
    public TopScorer filteredTopScorer(AtomicReaderContext context,
        Weight weight, boolean scoreDocsInOrder, DocIdSet docIdSet) throws IOException {
      final DocIdSetIterator filterIter = docIdSet.iterator();
      if (filterIter == null) {
        // this means the filter does not accept any documents.
        return null;
      }
      // we pass null as acceptDocs, as our filter has already respected acceptDocs, no need to do twice
      final Scorer scorer = weight.scorer(context, null);
      if (scorer == null) {
        return null;
      }
      if (scorerFirst) {
        return new LeapFrogTopScorer(scorer, filterIter, scorer);  
      } else {
        return new LeapFrogTopScorer(filterIter, scorer, scorer);  
      }
    }

