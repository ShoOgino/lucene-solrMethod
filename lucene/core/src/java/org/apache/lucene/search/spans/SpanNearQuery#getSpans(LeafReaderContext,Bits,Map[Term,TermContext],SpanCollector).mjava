  @Override
  public Spans getSpans(final LeafReaderContext context, Bits acceptDocs, Map<Term,TermContext> termContexts, SpanCollector collector) throws IOException {

    Terms terms = context.reader().terms(field);
    if (terms == null) {
      return null; // field does not exist
    }

    ArrayList<Spans> subSpans = new ArrayList<>(clauses.size());
    SpanCollector subSpanCollector = inOrder ? collector.bufferedCollector() : collector;
    for (SpanQuery seq : clauses) {
      Spans subSpan = seq.getSpans(context, acceptDocs, termContexts, subSpanCollector);
      if (subSpan != null) {
        subSpans.add(subSpan);
      } else {
        return null; // all required
      }
    }

    
    // all NearSpans require at least two subSpans
    return (! inOrder) ? new NearSpansUnordered(this, subSpans) : new NearSpansOrdered(this, subSpans, collector);
  }

