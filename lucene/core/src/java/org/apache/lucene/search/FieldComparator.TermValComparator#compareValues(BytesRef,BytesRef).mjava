    @Override
    public int compareValues(BytesRef val1, BytesRef val2) {
      // missing always sorts first:
      if (val1.bytes == MISSING_BYTES) {
        if (val2.bytes == MISSING_BYTES) {
          return 0;
        }
        return -1;
      } else if (val2.bytes == MISSING_BYTES) {
        return 1;
      }
      return val1.compareTo(val2);
    }

