  protected void updateMinCompetitiveScore(Scorable scorer) throws IOException {
    if (hitsThresholdChecker.isThresholdReached()
          && ((bottomValueChecker != null && bottomValueChecker.getBottomValue() > 0)
          || (pqTop != null && pqTop.score != Float.NEGATIVE_INFINITY))) { // -Infinity is the score of sentinels
      float bottomScore = 0f;

      if (pqTop != null && pqTop.score != Float.NEGATIVE_INFINITY) {
        // since we tie-break on doc id and collect in doc id order, we can require
        // the next float
        bottomScore = Math.nextUp(pqTop.score);

        if (bottomValueChecker != null) {
          bottomValueChecker.updateThreadLocalBottomValue(pqTop.score);
        }
      }

      // Global bottom can only be greater than or equal to the local bottom score
      // The updating of global bottom score for this hit before getting here should
      // ensure that
      if (bottomValueChecker != null && bottomValueChecker.getBottomValue() > bottomScore) {
        bottomScore = bottomValueChecker.getBottomValue();
      }

      scorer.setMinCompetitiveScore(bottomScore);
      totalHitsRelation = TotalHits.Relation.GREATER_THAN_OR_EQUAL_TO;
    }
  }

