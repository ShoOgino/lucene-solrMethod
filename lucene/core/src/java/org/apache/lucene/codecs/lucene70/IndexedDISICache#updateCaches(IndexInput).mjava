  private void updateCaches(IndexInput slice) throws IOException {
    final long startOffset = slice.getFilePointer();

    final long startTime = System.nanoTime();
    AtomicInteger statBlockALL = new AtomicInteger(0);
    AtomicInteger statBlockDENSE = new AtomicInteger(0);
    AtomicInteger statBlockSPARSE = new AtomicInteger(0);

    // Fill phase
    int largestBlock = fillCache(slice, statBlockALL, statBlockDENSE, statBlockSPARSE);
    freezeCaches(largestBlock);

    slice.seek(startOffset); // Leave it as we found it
    creationStats = String.format(Locale.ENGLISH,
        "name=%s, blocks=%d (ALL=%d, DENSE=%d, SPARSE=%d, EMPTY=%d), time=%dms, block=%d bytes",
        name,
        largestBlock+1, statBlockALL.get(), statBlockDENSE.get(), statBlockSPARSE.get(),
        (largestBlock+1-statBlockALL.get()-statBlockDENSE.get()-statBlockSPARSE.get()),
        (System.nanoTime()-startTime)/1000000,
        blockCache == null ? 0 : blockCache.length*Long.BYTES);
  }

