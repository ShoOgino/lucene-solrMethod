  @Override
  public long ramBytesUsed() {
    return (blockCache == null ? 0 : RamUsageEstimator.sizeOf(blockCache)) +
        (rank == null ? 0 : rank.ramBytesUsed()) +
        RamUsageEstimator.NUM_BYTES_OBJECT_REF*3 +
        RamUsageEstimator.NUM_BYTES_OBJECT_HEADER + creationStats.length()*2;
  }

