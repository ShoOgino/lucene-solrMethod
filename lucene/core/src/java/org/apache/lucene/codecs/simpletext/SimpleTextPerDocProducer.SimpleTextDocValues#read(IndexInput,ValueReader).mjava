    private Source read(IndexInput in, ValueReader reader) throws IOException {
      BytesRef scratch = new BytesRef();
      for (int i = 0; i < docCount; i++) {
        SimpleTextUtil.readLine(in, scratch);

        assert StringHelper.startsWith(scratch, DOC) : scratch.utf8ToString();
        SimpleTextUtil.readLine(in, scratch);
        assert StringHelper.startsWith(scratch, VALUE);
        reader.fromString(i, scratch, scratch.offset + VALUE.length);
      }
      SimpleTextUtil.readLine(in, scratch);
      assert scratch.equals(END);
      return reader.getSource();
    }

