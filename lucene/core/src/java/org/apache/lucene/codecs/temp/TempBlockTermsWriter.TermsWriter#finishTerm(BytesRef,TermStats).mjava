    @Override
    public void finishTerm(BytesRef text, TermStats stats) throws IOException {

      assert stats.docFreq > 0;
      //if (DEBUG) System.out.println("BTTW.finishTerm term=" + fieldInfo.name + ":" + toString(text) + " seg=" + segment + " df=" + stats.docFreq);

      blockBuilder.add(Util.toIntsRef(text, scratchIntsRef), noOutputs.getNoOutput());

      long[] longs = new long[postingsWriter.longsSize()];
      postingsWriter.finishTerm(longs, metaWriter, stats);
      byte[] bytes = new byte[(int)metaWriter.getFilePointer()];
      metaWriter.writeTo(bytes, 0);
      metaWriter.reset();

      PendingTerm term = new PendingTerm(BytesRef.deepCopyOf(text), stats, longs, bytes);
      pending.add(term);
      numTerms++;
    }

