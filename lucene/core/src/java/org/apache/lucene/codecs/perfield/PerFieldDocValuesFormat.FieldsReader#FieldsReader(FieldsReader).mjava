    private FieldsReader(FieldsReader other) {

      Map<SimpleDVProducer,SimpleDVProducer> oldToNew = new IdentityHashMap<SimpleDVProducer,SimpleDVProducer>();
      // First clone all formats
      for(Map.Entry<String,SimpleDVProducer> ent : other.formats.entrySet()) {
        SimpleDVProducer values = ent.getValue().clone();
        formats.put(ent.getKey(), values);
        oldToNew.put(ent.getValue(), values);
      }

      // Then rebuild fields:
      for(Map.Entry<String,SimpleDVProducer> ent : other.fields.entrySet()) {
        SimpleDVProducer producer = oldToNew.get(ent.getValue());
        assert producer != null;
        fields.put(ent.getKey(), producer);
      }
    }

