    /**
     * Check integrity of the data. The iterator is not usable after this method has been called.
     */
    void checkIntegrity() throws IOException {
      fieldsStream.seek(fieldsStream.length() - CodecUtil.footerLength());
      CodecUtil.checkFooter(fieldsStream);
    }

