  @Override
  public void close() throws IOException {
    // nocommit: just write this to a RAMfile or something and flush it here, with #fields first.
    // this meta is a tiny file so this hurts nobody
    boolean success = false;
    try {
      if (meta != null) {
        meta.writeVInt(-1);
      }
      success = true;
    } finally {
      if (success) {
        IOUtils.close(data, meta);
      } else {
        IOUtils.closeWhileHandlingException(data, meta);
      }
    }
  }

