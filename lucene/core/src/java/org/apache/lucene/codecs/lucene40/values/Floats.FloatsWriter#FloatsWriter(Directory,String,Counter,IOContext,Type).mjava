    public FloatsWriter(Directory dir, String id, Counter bytesUsed,
        IOContext context, Type type) throws IOException {
      super(dir, id, CODEC_NAME, VERSION_CURRENT, bytesUsed, context);
      size = typeToSize(type);
      this.bytesRef = new BytesRef(size);
      bytesRef.length = size;
      template = DocValuesArraySource.forType(type);
      assert template != null;
    }

