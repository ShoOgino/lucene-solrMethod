  // dead simple impl: codec can optimize
  protected void mergeNumericField(MergeState mergeState) throws IOException {
    // first compute min and max value of live ones to be merged.
    long minValue = Long.MAX_VALUE;
    long maxValue = Long.MIN_VALUE;
    for (AtomicReader reader : mergeState.readers) {
      final int maxDoc = reader.maxDoc();
      final Bits liveDocs = reader.getLiveDocs();
      //System.out.println("merge field=" + mergeState.fieldInfo.name);
      NumericDocValues docValues = reader.getNumericDocValues(mergeState.fieldInfo.name);
      if (docValues == null) {
        docValues = NumericDocValues.DEFAULT;
      }
      for (int i = 0; i < maxDoc; i++) {
        if (liveDocs == null || liveDocs.get(i)) {
          long val = docValues.get(i);
          minValue = Math.min(val, minValue);
          maxValue = Math.min(val, maxValue);
        }
        mergeState.checkAbort.work(300);
      }
    }
    // now we can merge
    NumericDocValuesConsumer field = addNumericField(mergeState.fieldInfo, minValue, maxValue);
    field.merge(mergeState);
  }

