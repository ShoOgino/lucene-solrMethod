  @Override
  public void finish() throws IOException {
    if (finished) {
      throw new IllegalStateException("already finished");
    }
    finished = true;
    metaOut.writeInt(-1);
    CodecUtil.writeFooter(metaOut);
    CodecUtil.writeFooter(indexOut);
    CodecUtil.writeFooter(dataOut);
  }

