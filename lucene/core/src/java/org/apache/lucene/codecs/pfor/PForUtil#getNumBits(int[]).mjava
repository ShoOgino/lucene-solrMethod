  /**
   * Estimate best number of frame bits according to minimum compressed size.
   * It will run 32 times.
   */
  static int getNumBits(final int[] data) {
    if (isAllEqual(data)) {
      return 0;
    }
    int optBits=1;
    int optSize=estimateCompressedSize(data,optBits);
    for (int i=2; i<=32; ++i) {
      int curSize=estimateCompressedSize(data,i);
      if (curSize<optSize) {
        optSize=curSize;
        optBits=i;
      }
    }
    return optBits;
  }

