  @Override
  public void read(Directory directory, String segmentsFileName, ChecksumIndexInput input, SegmentInfos infos, IOContext context) throws IOException { 
    infos.version = input.readLong(); // read version
    infos.counter = input.readInt(); // read counter
    final int format = infos.getFormat();
    assert format <= SegmentInfos.FORMAT_4_0;
    for (int i = input.readInt(); i > 0; i--) { // read segmentInfos
      SegmentInfo si = readSegmentInfo(directory, format, input);
      assert si.getVersion() != null;
      infos.add(si);
    }
      
    infos.userData = input.readStringStringMap();
  }

