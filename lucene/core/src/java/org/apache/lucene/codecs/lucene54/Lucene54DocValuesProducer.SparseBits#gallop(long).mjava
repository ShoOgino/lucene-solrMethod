    /** Gallop forward and stop as soon as an index is found that is greater than
     *  the given docId. {@code index} will store an index that stores a value
     *  that is &lt;= {@code docId} while the return value will give an index
     *  that stores a value that is &gt; {@code docId}. These indices can then be
     *  used to binary search. */
    private long gallop(long docId) {
      index++;
      this.docId = nextDocId;
      long hiIndex = index + 1;

      while (true) {
        if (hiIndex >= docIDsLength) {
          hiIndex = docIDsLength;
          nextDocId = maxDoc;
          break;
        }

        final long hiDocId = docIds.get(hiIndex);
        if (hiDocId > docId) {
          nextDocId = hiDocId;
          break;
        }

        final long delta = hiIndex - index;
        index = hiIndex;
        this.docId = hiDocId;
        hiIndex += delta << 1; // double the step each time
      }
      return hiIndex;
    }

