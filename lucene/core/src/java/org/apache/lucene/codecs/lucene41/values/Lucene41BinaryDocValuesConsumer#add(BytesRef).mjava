  @Override
  public void add(BytesRef value) throws IOException {
    dataOut.writeBytes(value.bytes, value.offset, value.length);
    if (buffer != null) {
      buffer.add(offset-prevOffset);
      prevOffset = offset;
    }
    offset += value.length;
  }

