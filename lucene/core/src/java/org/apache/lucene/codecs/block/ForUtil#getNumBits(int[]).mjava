  /**
   * Returns number of bits necessary to represent max value.
   */
  static int getNumBits(final int[] data) {
    if (isAllEqual(data)) {
      return 0;
    }
    int size=data.length;
    int optBits=1;
    for (int i=0; i<size; ++i) {
      while ((data[i] & ~MASK[optBits]) != 0) {
        optBits++;
      }
    }
    assert optBits < 32;
    return optBits;
  }

