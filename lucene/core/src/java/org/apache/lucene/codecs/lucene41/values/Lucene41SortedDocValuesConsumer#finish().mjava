  @Override
  public void finish() throws IOException {
    try {
      ords.finish();
      
      if (offsetBuffer != null) {
        
        final int bitsRequired = PackedInts.bitsRequired(offset);
        Iterator iterator = offsetBuffer.iterator();
        PackedInts.Writer writer = PackedInts.getWriter(offsets, valueCount+1,
            bitsRequired, PackedInts.DEFAULT);
        while (iterator.hasNext()) {
          writer.add(iterator.next());
        }
        writer.add(offset); // total # bytes
        writer.finish();
      }
    } finally {
      IOUtils.close(data, index, offsets);
    }
  }

