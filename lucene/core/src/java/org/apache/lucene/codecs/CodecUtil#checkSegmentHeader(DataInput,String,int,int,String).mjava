  /**
   * Reads and validates a header previously written with 
   * {@link #writeSegmentHeader(DataOutput, String, int, String)}.
   * <p>
   * When reading a file, supply the expected <code>codec</code>,
   * expected version range (<code>minVersion to maxVersion</code>),
   * and segment ID.
   * 
   * @param in Input stream, positioned at the point where the
   *        header was previously written. Typically this is located
   *        at the beginning of the file.
   * @param codec The expected codec name.
   * @param minVersion The minimum supported expected version number.
   * @param maxVersion The maximum supported expected version number.
   * @param segmentID The expected segment this file belongs to.
   * @return The actual version found, when a valid header is found 
   *         that matches <code>codec</code>, with an actual version 
   *         where <code>minVersion <= actual <= maxVersion</code>, 
   *         and matching <code>segmentID</code>
   *         Otherwise an exception is thrown.
   * @throws CorruptIndexException If the first four bytes are not
   *         {@link #CODEC_MAGIC}, or if the actual codec found is
   *         not <code>codec</code>, or if the <code>segmentID</code>
   *         does not match.
   * @throws IndexFormatTooOldException If the actual version is less 
   *         than <code>minVersion</code>.
   * @throws IndexFormatTooNewException If the actual version is greater 
   *         than <code>maxVersion</code>.
   * @throws IOException If there is an I/O error reading from the underlying medium.
   * @see #writeSegmentHeader(DataOutput, String, int, String)
   */
  public static int checkSegmentHeader(DataInput in, String codec, int minVersion, int maxVersion, String segmentID) throws IOException {
    int version = checkHeader(in, codec, minVersion, maxVersion);
    String id = in.readString();
    if (!id.equals(segmentID)) {
      throw new CorruptIndexException("file mismatch, expected segment id=" + segmentID + ", got=" + id, in);
    }
    return version;
  }

