  // GCD-code takes & adjusted from Lucene70DocValuesConsumer
  private static long getGCD(final PackedInts.Reader values, final int length, final long min) {
    long gcd = -1;

    for (int i = 0 ; i < length ; i++) {
      long value = values.get(i)-min;
      if (value == 0) {
        continue;
      }
      if (gcd == -1) {
        gcd = value;
        continue;
      }

      if (value < Long.MIN_VALUE / 2 || value > Long.MAX_VALUE / 2) {
        // in that case v - minValue might overflow and make the GCD computation return
        // wrong results. Since these extreme values are unlikely, we just discard
        // GCD computation for them
        gcd = 1;
      } else { // minValue needs to be set first
        gcd = MathUtil.gcd(gcd, value);
      }

      if (gcd == 1) {
        break;
      }
    }
    return gcd == -1 ? 1 : gcd;
  }

