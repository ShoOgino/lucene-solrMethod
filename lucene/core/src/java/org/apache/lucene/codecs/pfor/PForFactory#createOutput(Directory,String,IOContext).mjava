  @Override
  public IntIndexOutput createOutput(Directory dir, String fileName, IOContext context)  throws IOException {
    boolean success = false;
    IndexOutput out = dir.createOutput(fileName, context);
    try {
      IntIndexOutput ret = new PForIndexOutput(out, blockSize);
      success = true;
      return ret;
    } finally {
      if (!success) {
        // For some cases (e.g. disk full), the IntIndexOutput may not be 
        // properly created. So we should close those opened files. 
        IOUtils.closeWhileHandlingException(out);
      }
    }
  }

