    @Override
    public BinaryDocValues getBinary(FieldInfo field) throws IOException {
      final BinaryEntry entry = binaries.get(field.number);
      assert entry.fixedLength;
      return new BinaryDocValues() {
        @Override
        public void get(int docID, BytesRef result) {
          long address = entry.offset + docID * (long)entry.maxLength;
          try {
            data.seek(address);
            if (result.length < entry.maxLength) {
              result.offset = 0;
              result.bytes = new byte[entry.maxLength];
            }
            data.readBytes(result.bytes, result.offset, entry.maxLength);
            result.length = entry.maxLength;
          } catch (IOException e) {
            throw new RuntimeException(e);
          }
        }

        @Override
        public int size() {
          return maxDoc;
        }
      };
    }

