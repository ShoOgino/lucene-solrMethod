  /** sugar method for startDocument() + writeField() for every stored field in the document */
  protected final void addDocument(Iterable<? extends StorableField> doc, FieldInfos fieldInfos) throws IOException {
    int storedCount = 0;
    for (StorableField field : doc) {
      storedCount++;
    }
    
    startDocument(storedCount);

    for (StorableField field : doc) {
      writeField(fieldInfos.fieldInfo(field.name()), field);
    }
  }

