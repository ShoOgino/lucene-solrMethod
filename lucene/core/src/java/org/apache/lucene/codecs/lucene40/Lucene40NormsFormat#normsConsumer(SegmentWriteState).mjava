  @Override
  public DocValuesConsumer normsConsumer(SegmentWriteState state) throws IOException {
    final DocValuesConsumer delegate = super.normsConsumer(state);
    return new DocValuesConsumer() {

      @Override
      public void addNumericField(FieldInfo field, Iterable<Number> values) throws IOException {
        // hack: here we would examine the numerics and simulate in the impersonator the best we can
        // e.g. if they are all in byte/int range write fixed, otherwise write packed or whatever
        field.putAttribute(Lucene40FieldInfosReader.LEGACY_NORM_TYPE_KEY, LegacyDocValuesType.VAR_INTS.name());
        delegate.addNumericField(field, values);
      }
      
      @Override
      public void addBinaryField(FieldInfo field, Iterable<BytesRef> values) throws IOException {
        assert false;
      }

      @Override
      public void addSortedField(FieldInfo field, Iterable<BytesRef> values, Iterable<Number> docToOrd) throws IOException {
        assert false;
      }

      @Override
      public void close() throws IOException {
        delegate.close();
      }
    };
  }

