  @Override
  public int getNumDimensions(String fieldName) {
    BKDReader bkdReader = getBKDReader(fieldName);
    if (bkdReader == null) {
      // Schema ghost corner case!  This field did index dimensional values in the past, but
      // now all docs having this dimensional field were deleted in this segment:
      return 0;
    }
    return bkdReader.getNumDimensions();
  }

