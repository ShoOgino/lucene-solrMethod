  private LongValues applyTable(LongValues values, long[] table) {
    return new LongValues() {
      @Override
      public long get(long index) {
        return table[(int) values.get(index)];
      }
    };
  }

