  public SegmentInfo read(Directory directory, String segmentName, int format) throws IOException { 

    // NOTE: this is NOT how 3.x is really written...
    String fileName = IndexFileNames.segmentFileName(segmentName, "", Lucene3xSegmentInfosFormat.SI_EXTENSION);

    // nocommit what IOCtx
    boolean success = false;

    IndexInput input = directory.openInput(fileName, IOContext.READONCE);

    try {
      SegmentInfo si = readSegmentInfo(directory, format, input);
      success = true;
      return si;
    } finally {
      if (!success) {
        IOUtils.closeWhileHandlingException(input);
      } else {
        input.close();
      }
    }
  }

