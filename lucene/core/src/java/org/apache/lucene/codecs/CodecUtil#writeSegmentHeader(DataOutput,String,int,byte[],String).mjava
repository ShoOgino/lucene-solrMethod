  /**
   * Writes a codec header for a per-segment, which records both a string to
   * identify the file, a version number, and the unique ID of the segment. 
   * This header can be parsed and validated with 
   * {@link #checkSegmentHeader(DataInput, String, int, int, byte[], String) checkSegmentHeader()}.
   * <p>
   * CodecSegmentHeader --&gt; CodecHeader,SegmentID,SegmentSuffix
   * <ul>
   *    <li>CodecHeader   --&gt; {@link #writeHeader}
   *    <li>SegmentID     --&gt; {@link DataOutput#writeByte byte}<sup>16</sup>
   *    <li>SegmentSuffix --&gt; SuffixLength,SuffixBytes
   *    <li>SuffixLength  --&gt; {@link DataOutput#writeByte byte}
   *    <li>SuffixBytes   --&gt; {@link DataOutput#writeByte byte}<sup>SuffixLength</sup>
   * </ul>
   * <p>
   * Note that the length of a segment header depends only upon the
   * name of the codec and suffix, so this length can be computed at any time
   * with {@link #segmentHeaderLength(String,String)}.
   * 
   * @param out Output stream
   * @param codec String to identify this file. It should be simple ASCII, 
   *              less than 128 characters in length.
   * @param segmentID Unique identifier for the segment
   * @param segmentSuffix auxiliary suffix for the file. It should be simple ASCII,
   *              less than 256 characters in length.
   * @param version Version number
   * @throws IOException If there is an I/O error writing to the underlying medium.
   * @throws IllegalArgumentException If the codec name is not simple ASCII, or 
   *         is more than 127 characters in length, or if segmentID is invalid,
   *         or if the segmentSuffix is not simple ASCII, or more than 255 characters
   *         in length.
   */
  public static void writeSegmentHeader(DataOutput out, String codec, int version, byte[] segmentID, String segmentSuffix) throws IOException {
    if (segmentID.length != StringHelper.ID_LENGTH) {
      throw new IllegalArgumentException("Invalid id: " + StringHelper.idToString(segmentID));
    }
    writeHeader(out, codec, version);
    out.writeBytes(segmentID, 0, segmentID.length);
    BytesRef suffixBytes = new BytesRef(segmentSuffix);
    if (suffixBytes.length != segmentSuffix.length() || suffixBytes.length >= 256) {
      throw new IllegalArgumentException("codec must be simple ASCII, less than 256 characters in length [got " + segmentSuffix + "]");
    }
    out.writeByte((byte)suffixBytes.length);
    out.writeBytes(suffixBytes.bytes, suffixBytes.offset, suffixBytes.length);
  }

