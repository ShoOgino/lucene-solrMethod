      // nocommit: make use of extra info, like commonSuffixRef
      @Override
      public BytesRef next() throws IOException {
        //if (DEBUG) System.out.println("Enum next()");
        if (pending) {
          pending = false;
          return term;
        }
        decoded = false;
      DFS:
        while (stack.size() > 1) {
          Frame frame = newFrame();
          if (loadExpandFrame(topFrame(), frame) != null) {  // has valid target
            pushFrame(frame);
            if (isAccept(frame)) {  // gotcha
              return term;
            }
            continue;  // check next target
          } 
          frame = popFrame();
          while(stack.size() > 1) {
            if (loadNextFrame(topFrame(), frame) != null) {  // has valid sibling 
              pushFrame(frame);
              if (isAccept(frame)) {  // gotcha
                return term;
              }
              continue DFS;   // check next target 
            }
            frame = popFrame();
          }
          return null;
        }
        return null;
      }

