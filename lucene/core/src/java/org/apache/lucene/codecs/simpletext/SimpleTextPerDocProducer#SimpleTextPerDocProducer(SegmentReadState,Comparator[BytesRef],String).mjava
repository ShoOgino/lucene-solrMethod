  /**
   * Creates a new {@link Lucene40DocValuesProducer} instance and loads all
   * {@link DocValues} instances for this segment and codec.
   */
  public SimpleTextPerDocProducer(SegmentReadState state,
      Comparator<BytesRef> comp, String segmentSuffix) throws IOException {
    this.comp = comp;
    this.segmentSuffix = segmentSuffix;
    if (anyDocValuesFields(state.fieldInfos)) {
      docValues = load(state.fieldInfos, state.segmentInfo.name,
          state.segmentInfo.docCount, state.dir, state.context);
    } else {
      docValues = new TreeMap<String, DocValues>();
    }
  }

