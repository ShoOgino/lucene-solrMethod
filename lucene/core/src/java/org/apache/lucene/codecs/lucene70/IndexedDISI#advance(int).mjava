  @Override
  public int advance(int target) throws IOException {
    final int targetBlock = target & 0xFFFF0000;
    // Note: The cache makes it easy to add support for random access. This has not been done as the API forbids it
    if (block < targetBlock) {
      advanceBlock(targetBlock);
    }
    if (block == targetBlock) {
      if (method.advanceWithinBlock(this, target)) {
        return doc;
      }
      readBlockHeader();
    }
    boolean found = method.advanceWithinBlock(this, block);
    assert found;
    return doc;
  }

