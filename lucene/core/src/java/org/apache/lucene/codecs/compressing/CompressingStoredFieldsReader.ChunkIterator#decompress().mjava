    /**
     * Decompress the chunk.
     */
    void decompress() throws IOException {
      // decompress data
      final int totalLength = totalLength();
      decompressor.decompress(fieldsStream, totalLength, 0, totalLength, bytes);
      assert bytes.length == totalLength;
      if (bytes.length != chunkSize()) {
        throw new CorruptIndexException("Corrupted: expected chunk size = " + chunkSize() + ", got " + bytes.length);
      }
    }

