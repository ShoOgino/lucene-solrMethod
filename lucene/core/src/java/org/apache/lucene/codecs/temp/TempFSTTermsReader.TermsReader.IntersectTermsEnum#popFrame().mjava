      Frame popFrame() throws IOException {
        final Frame pop = stack.pop(), top = topFrame();
        if (top.fstArc.isFinal()) {
          meta = top.fstArc.nextFinalOutput;
        } else {
          meta = top.fstArc.output;
        }
        term = shrink();
        //if (DEBUG) System.out.println("  term=" + term + " stack=" + stack.size());
        return pop;
      }

