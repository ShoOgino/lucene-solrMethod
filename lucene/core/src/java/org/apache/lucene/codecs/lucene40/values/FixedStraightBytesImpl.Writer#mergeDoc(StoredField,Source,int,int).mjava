    @Override
    protected void mergeDoc(StoredField scratchField, Source source, int docID, int sourceDoc) throws IOException {
      assert lastDocID < docID;
      setMergeBytes(source, sourceDoc);
      if (size == -1) {
        size = bytesRef.length;
        datOut.writeInt(size);
      }
      assert size == bytesRef.length : "size: " + size + " ref: " + bytesRef.length;
      if (lastDocID+1 < docID) {
        fill(datOut, docID);
      }
      datOut.writeBytes(bytesRef.bytes, bytesRef.offset, bytesRef.length);
      lastDocID = docID;
    }

