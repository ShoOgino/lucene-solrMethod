    @Override
    protected void flushBlock() throws IOException {
      final int header = ForUtil.compress(buffer,encodedBuffer);
      final int numBytes = ForUtil.getEncodedSize(header);
      // nocommit writeVInt instead?
      out.writeInt(header);
      out.writeBytes(encoded, numBytes);
    }

