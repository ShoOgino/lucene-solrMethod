  @Override
  public CategoryContainer getNextFacets(CategoryContainer facets) throws NoMoreDataException, IOException {
    if (facets == null) {
      facets = new CategoryContainer();
    } else {
      facets.clear();
    }
    int numFacets = 1 + random.nextInt(maxDocFacets-1); // at least one facet to each doc
    for (int i=0; i<numFacets; i++) {
      CategoryPath cp = new CategoryPath();
      int depth = 1 + random.nextInt(maxFacetDepth-1); // depth 0 is not useful
      for (int k=0; k<depth; k++) {
        cp.add(Integer.toString(random.nextInt(maxValue)));
        addItem();
      }
      facets.addCategory(cp);
      addBytes(cp.toString().length()); // very rough approximation
    }
    return facets;
  }

