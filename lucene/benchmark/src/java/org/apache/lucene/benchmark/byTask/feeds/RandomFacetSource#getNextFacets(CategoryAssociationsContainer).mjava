  @Override
  public CategoryAssociationsContainer getNextFacets(CategoryAssociationsContainer facets) 
      throws NoMoreDataException, IOException {
    if (facets == null) {
      facets = new CategoryAssociationsContainer();
    } else {
      facets.clear();
    }
    int numFacets = 1 + random.nextInt(maxDocFacets-1); // at least one facet to each doc
    for (int i = 0; i < numFacets; i++) {
      int depth = 1 + random.nextInt(maxFacetDepth - 1); // depth 0 is not useful
      String[] components = new String[depth];
      for (int k = 0; k < depth; k++) {
        components[k] = Integer.toString(random.nextInt(maxValue));
        addItem();
      }
      CategoryPath cp = new CategoryPath(components);
      facets.setAssociation(cp, null);
      addBytes(cp.toString().length()); // very rough approximation
    }
    return facets;
  }

