  @Override
  public void getNextFacets(List<CategoryPath> facets) throws NoMoreDataException, IOException {
    facets.clear();
    int numFacets = 1 + random.nextInt(maxDocFacets); // at least one facet to each doc
    for (int i = 0; i < numFacets; i++) {
      int depth = 1 + random.nextInt(maxFacetDepth); // depth 0 is not useful
      String[] components = new String[depth];
      for (int k = 0; k < depth; k++) {
        components[k] = Integer.toString(random.nextInt(maxValue));
        addItem();
      }
      CategoryPath cp = new CategoryPath(components);
      facets.add(cp);
      addBytes(cp.toString().length()); // very rough approximation
    }
  }

