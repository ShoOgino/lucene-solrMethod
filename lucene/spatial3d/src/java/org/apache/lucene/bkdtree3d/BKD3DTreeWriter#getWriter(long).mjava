  Writer getWriter(long count) throws IOException {
    if (count < maxPointsSortInHeap) {
      return new HeapWriter((int) count);
    } else {
      return new OfflineWriter(count);
    }
  }

