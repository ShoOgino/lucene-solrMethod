  @Override
  public void setUp() throws Exception {
    super.setUp();
    directory = newDirectory();
    RandomIndexWriter iw = new RandomIndexWriter(random(), directory);
    iw.setDoRandomForceMerge(false); // Keep the segments separated.
    addSegments(iw);
    reader = iw.getReader();
    iw.close();
    searcher = newSearcher(reader);
  }

