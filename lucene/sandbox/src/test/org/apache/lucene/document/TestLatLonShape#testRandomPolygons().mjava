  public void testRandomPolygons() throws Exception {
    long avgIdxTime = 0;
    int numVertices;
    int numPolys = RandomNumbers.randomIntBetween(random(), 50, 100);

    Directory dir = newDirectory();
    RandomIndexWriter writer = new RandomIndexWriter(random(), dir);
    long start, end;

    Polygon polygon;
    Document document;
    System.out.println("generating " + numPolys + " polygons");
    for (int i = 0; i < numPolys;) {
      document = new Document();
      numVertices = TestUtil.nextInt(random(), 200000, 500000);
      polygon = GeoTestUtil.createRegularPolygon(0, 0, atLeast(1000000), numVertices);
      System.out.println("adding polygon " + i);
      start = System.currentTimeMillis();
      addPolygonsToDoc(FIELDNAME, document, polygon);
      writer.addDocument(document);
      end = System.currentTimeMillis();
      avgIdxTime += ((end - start) - avgIdxTime) / ++i;
    }
    System.out.println("avg index time: " + avgIdxTime);

    // search within 50km and verify we found our doc
    IndexReader reader = writer.getReader();
    IndexSearcher searcher = newSearcher(reader);
    start = System.currentTimeMillis();
    assertEquals(0, searcher.count(newRectQuery("field", -89.9, -89.8, -179.9, -179.8d)));
    end = System.currentTimeMillis();

    System.out.println("search: " + (end - start));

    reader.close();
    writer.close();
    dir.close();
  }

