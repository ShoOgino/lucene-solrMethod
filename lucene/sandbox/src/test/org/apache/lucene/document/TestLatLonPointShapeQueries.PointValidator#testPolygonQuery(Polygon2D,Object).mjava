    @Override
    public boolean testPolygonQuery(Polygon2D poly2d, Object shape) {
      Point p = (Point) shape;
      double lat = decodeLatitude(encodeLatitude(p.lat));
      double lon = decodeLongitude(encodeLongitude(p.lon));
      // for consistency w/ the query we test the point as a triangle
      return poly2d.relateTriangle(lon, lat, lon, lat, lon, lat) != Relation.CELL_OUTSIDE_QUERY;
    }

