    private boolean testLine(Polygon2D queryPoly, Line line) {
      double ax, ay, bx, by, temp;
      Relation r;
      for (int i = 0, j = 1; j < line.numPoints(); ++i, ++j) {
        ay = quantizeLat(line.getLat(i));
        ax = quantizeLon(line.getLon(i));
        by = quantizeLat(line.getLat(j));
        bx = quantizeLon(line.getLon(j));
        if (ay > by) {
          temp = ay;
          ay = by;
          by = temp;
          temp = ax;
          ax = bx;
          bx = temp;
        } else if (ay == by) {
          if (ax > bx) {
            temp = ay;
            ay = by;
            by = temp;
            temp = ax;
            ax = bx;
            bx = temp;
          }
        }
        r = queryPoly.relateTriangle(ax, ay, bx, by, ax, ay);
        if (queryRelation == QueryRelation.DISJOINT) {
          if (r != Relation.CELL_OUTSIDE_QUERY) return false;
        } else if (queryRelation == QueryRelation.WITHIN) {
          if (r != Relation.CELL_INSIDE_QUERY) return false;
        } else {
          if (r != Relation.CELL_OUTSIDE_QUERY) return true;
        }
      }
      return queryRelation == QueryRelation.INTERSECTS ? false : true;
    }

