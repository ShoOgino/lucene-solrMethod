  private boolean accept(QueryState state, int docID) throws IOException {
    //System.out.println("    check accept docID=" + docID);
    state.sndv.setDocument(docID);
    // How many values this doc has:
    int count = state.sndv.count();
    for(int j=0;j<count;j++) {
      long enc = state.sndv.valueAt(j);

      int latEnc = (int) ((enc>>32) & 0xffffffffL);
      int lonEnc = (int) (enc & 0xffffffffL);
      //System.out.println("      lat=" + BKDTreeWriter.decodeLat(latEnc) + " lon=" + BKDTreeWriter.decodeLon(lonEnc));

      if (latEnc >= state.latMinEnc &&
          latEnc < state.latMaxEnc &&
          lonEnc >= state.lonMinEnc &&
          lonEnc < state.lonMaxEnc &&
          (state.latLonFilter == null ||
           state.latLonFilter.accept(BKDTreeWriter.decodeLat(latEnc), BKDTreeWriter.decodeLon(lonEnc)))) {
        //System.out.println("      yes");
        return true;
      }
    }

    return false;
  }

