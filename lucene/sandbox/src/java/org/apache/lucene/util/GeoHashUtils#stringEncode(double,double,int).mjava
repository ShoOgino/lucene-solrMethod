  /**
   * Encode to a level specific geohash string from full resolution longitude, latitude
   */
  public static final String stringEncode(final double lon, final double lat, final int level) {
    // bit twiddle to geohash (since geohash is a swapped (lon/lat) encoding)
    final long hashedVal = BitUtil.flipFlop(GeoUtils.mortonHash(lon, lat));

    StringBuilder geoHash = new StringBuilder();
    short precision = 0;
    final short msf = (GeoUtils.BITS<<1)-5;
    long mask = 31L<<msf;
    do {
      geoHash.append(BASE_32[(int)((mask & hashedVal)>>>(msf-(precision*5)))]);
      // next 5 bits
      mask >>>= 5;
    } while (++precision < level);
    return geoHash.toString();
  }

