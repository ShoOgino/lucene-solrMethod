  private long getSplitValue(PathSlice source, long leftCount, long minValue, long maxValue) throws IOException {

    // Read the split value:
    SliceReader reader = source.writer.getReader(source.start + leftCount);
    boolean success = false;
    long splitValue;
    try {
      boolean result = reader.next();
      assert result;
      splitValue = reader.value();
      assert splitValue >= minValue && splitValue <= maxValue: "splitValue=" + splitValue + " minValue=" + minValue + " maxValue=" + maxValue + " reader=" + reader;
      success = true;
    } finally {
      if (success) {
        IOUtils.close(reader);
      } else {
        IOUtils.closeWhileHandlingException(reader);
      }
    }

    return splitValue;
  }

