  /** Adds docs from the current block, filtering each hit against the query min/max.  This
   *  is only needed on the boundary blocks. */
  private int addSome(QueryState state) throws IOException {
    int hitCount = 0;

    // How many points are stored in this leaf cell:
    int count = state.in.readVInt();
    state.docs.grow(count);
    for(int i=0;i<count;i++) {
      int docID = state.in.readInt();
      state.sndv.setDocument(docID);

      // How many values this doc has:
      int docValueCount = state.sndv.count();

      for(int j=0;j<docValueCount;j++) {
        long value = state.sndv.valueAt(j);

        if (value >= state.minValueIncl && value <= state.maxValueIncl) {
          state.docs.add(docID);
          hitCount++;

          // Stop processing values for this doc:
          break;
        }
      }
    }

    return hitCount;
  }

