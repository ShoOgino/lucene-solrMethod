  @Override
  public void addSortedSetField(FieldInfo field, Iterable<BytesRef> values, Iterable<Number> docToOrdCount, Iterable<Number> ords) throws IOException {
    delegate.addSortedSetField(field, values, docToOrdCount, ords);
    RangeTreeWriter writer = new RangeTreeWriter(state.directory, state.segmentInfo.name, maxPointsInLeafNode, maxPointsSortInHeap);
    Iterator<Number> docToOrdCountIt = docToOrdCount.iterator();
    Iterator<Number> ordsIt = ords.iterator();
    //System.out.println("\nSSF: field=" + field.name);
    for (int docID=0;docID<state.segmentInfo.maxDoc();docID++) {
      assert docToOrdCountIt.hasNext();
      int count = docToOrdCountIt.next().intValue();
      for(int i=0;i<count;i++) {
        assert ordsIt.hasNext();
        long ord = ordsIt.next().longValue();
        writer.add(ord, docID);
      }
    }

    long indexStartFP = writer.finish(out);

    fieldIndexFPs.put(field.number, indexStartFP);
  }

