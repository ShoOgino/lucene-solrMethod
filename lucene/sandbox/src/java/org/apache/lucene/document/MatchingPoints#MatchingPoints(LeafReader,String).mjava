  /**
   * Creates a new accumulator.
   * @param reader reader to collect point matches from
   * @param field field name.
   */
  public MatchingPoints(LeafReader reader, String field) {
    maxDoc = reader.maxDoc();
    PointValues values = reader.getPointValues();
    if (values == null) {
      throw new IllegalStateException("the query is missing null checks");
    }
    docCount = values.getDocCount(field);
    numPoints = values.size(field);
    // heuristic: if the field is really sparse, use a sparse impl
    if (docCount >= 0 && docCount * 100L < maxDoc) {
      bits = new SparseFixedBitSet(maxDoc);
    } else {
      bits = new FixedBitSet(maxDoc);
    }
  }

