    /**
     * The two-phase query approach. The parent
     * {@link org.apache.lucene.search.GeoPointTermsEnum#accept} method is called to match
     * encoded terms that fall within the bounding box of the polygon. Those documents that pass the initial
     * bounding box filter are then compared to the provided distance using the
     * {@link org.apache.lucene.util.SloppyMath#haversin} method.
     *
     * @param term term for candidate document
     * @return match status
     */
    @Override
    protected AcceptStatus postFilterBoundary(BytesRef term) {
      final long val = NumericUtils.prefixCodedToLong(term);
      final double lon = GeoUtils.mortonUnhashLon(val);
      final double lat = GeoUtils.mortonUnhashLat(val);
      // post-filter by distance
      if (SloppyMath.haversin(query.centerLat, query.centerLon, lat, lon) * 1000.0 > query.radius) {
        return AcceptStatus.NO;
      }
      return AcceptStatus.YES;
    }

