  /** Returns true iff <code>o</code> is equal to this. */
  @Override
  public boolean equals(Object o) {
    if (!(o instanceof TermAutomatonQuery)) {
      return false;
    }
    TermAutomatonQuery other = (TermAutomatonQuery) o;

    if (det == null) {
      throw new IllegalStateException("please call finish first");
    }
    if (other.det == null) {
      throw new IllegalStateException("please call other.finish first");
    }

    // NOTE: not quite correct, because if terms were added in different
    // order in each query but the language is the same, we return false:
    return (this.getBoost() == other.getBoost())
      && this.termToID.equals(other.termToID) &&
      Operations.sameLanguage(det, other.det);
  }

