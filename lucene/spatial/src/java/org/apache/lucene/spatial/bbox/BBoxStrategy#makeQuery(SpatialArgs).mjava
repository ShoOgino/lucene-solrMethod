  @Override
  public Query makeQuery(SpatialArgs args) {
    BooleanQuery bq = new BooleanQuery();
    Query spatial = makeSpatialQuery(args);
    bq.add(new ConstantScoreQuery(spatial), BooleanClause.Occur.MUST);
    
    // This part does the scoring
    Query spatialRankingQuery = new FunctionQuery(makeValueSource(args));
    bq.add(spatialRankingQuery, BooleanClause.Occur.MUST);
    return bq;
  }

