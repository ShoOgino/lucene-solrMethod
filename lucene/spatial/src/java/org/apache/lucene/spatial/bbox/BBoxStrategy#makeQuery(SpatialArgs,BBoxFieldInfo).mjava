  @Override
  public Query makeQuery(SpatialArgs args, BBoxFieldInfo fieldInfo) {
    BooleanQuery bq = new BooleanQuery();
    Query spatial = makeSpatialQuery(args, fieldInfo);
    bq.add(new ConstantScoreQuery(spatial), BooleanClause.Occur.MUST);
    
    // This part does the scoring
    Query spatialRankingQuery = new FunctionQuery(makeValueSource(args, fieldInfo));
    bq.add(spatialRankingQuery, BooleanClause.Occur.MUST);
    return bq;
  }

