  /**
   * Encode lon/lat to the geohash based long format (lon/lat interleaved, 4 least significant bits = level)
   */
  public static final long longEncode(final double lon, final double lat, final int level) {
    // shift to appropriate level
    final short msf = (short)(((12 - level) * 5) + MORTON_OFFSET);
    return ((BitUtil.flipFlop(GeoUtils.mortonHash(lon, lat)) >>> msf) << 4) | level;
  }

