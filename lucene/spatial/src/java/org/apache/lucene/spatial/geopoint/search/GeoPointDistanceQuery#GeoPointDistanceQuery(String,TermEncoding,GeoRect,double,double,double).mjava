  private GeoPointDistanceQuery(final String field, final TermEncoding termEncoding, final GeoRect bbox,
                                 final double centerLat, final double centerLon, final double radiusMeters) {
    super(field, termEncoding, bbox.minLat, bbox.maxLat, bbox.minLon, bbox.maxLon);
    {
      // check longitudinal overlap (restrict distance to maximum longitudinal radius)
      // todo this restriction technically shouldn't be needed,
      // its only purpose is to ensure the bounding box doesn't self overlap.
      final double maxRadius = GeoDistanceUtils.maxRadialDistanceMeters(centerLat, centerLon);
      if (radiusMeters > maxRadius) {
        throw new IllegalArgumentException("radiusMeters " + radiusMeters + " exceeds maxRadius [" + maxRadius
            + "] at location [" + centerLat + " " + centerLon + "]");
      }
    }

    if (GeoUtils.isValidLat(centerLat) == false) {
      throw new IllegalArgumentException("invalid centerLat " + centerLat);
    }

    if (GeoUtils.isValidLon(centerLon) == false) {
      throw new IllegalArgumentException("invalid centerLon " + centerLon);
    }

    if (radiusMeters <= 0.0) {
      throw new IllegalArgumentException("invalid radiusMeters " + radiusMeters);
    }

    this.centerLat = centerLat;
    this.centerLon = centerLon;
    this.radiusMeters = radiusMeters;
  }

