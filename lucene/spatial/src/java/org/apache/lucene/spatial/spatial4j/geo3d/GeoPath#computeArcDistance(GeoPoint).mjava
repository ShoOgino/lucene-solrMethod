    /** Compute a true, accurate, great-circle distance.
    * Double.MAX_VALUE indicates a point is outside of the shape.
    */
    @Override
    public double computeArcDistance(GeoPoint point)
    {
        // Algorithm:
        // (1) If the point is within any of the segments along the path, return that value.
        // (2) If the point is within any of the segment end circles along the path, return that value.
        double currentDistance = 0.0;
        for (PathSegment segment : segments) {
            double distance = segment.pathDistance(point);
            if (distance != Double.MAX_VALUE)
                return currentDistance + distance;
            currentDistance += segment.fullDistance;
        }

        int segmentIndex = 0;
        currentDistance = 0.0;
        for (SegmentEndpoint endpoint : points) {
            double distance = endpoint.pathDistance(point);
            if (distance != Double.MAX_VALUE)
                return currentDistance + distance;
            if (segmentIndex < segments.size())
                currentDistance += segments.get(segmentIndex++).fullDistance;
        }

        return Double.MAX_VALUE;
    }

