  /** Compute the magnitude of a vector projected to a given
   * planet model.
   */
  protected static double computeMagnitude(final PlanetModel planetModel, final double z) {
    return 1.0 / Math.sqrt((1.0-z*z)*planetModel.inverseAbSquared + z*z*planetModel.inverseCSquared);
  }

