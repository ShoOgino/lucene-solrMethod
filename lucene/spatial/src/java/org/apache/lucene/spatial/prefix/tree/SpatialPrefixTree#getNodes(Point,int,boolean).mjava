  /**
   * A Point-optimized implementation of
   * {@link #getNodes(com.spatial4j.core.shape.Shape, int, boolean, boolean)}. That
   * method in facts calls this for points.
   * <p/>
   * This implementation depends on {@link #getNode(String)} being fast, as its
   * called repeatedly when incPlarents is true.
   */
  public List<Node> getNodes(Point p, int detailLevel, boolean inclParents) {
    Node cell = getNode(p, detailLevel);
    if (!inclParents) {
      return Collections.singletonList(cell);
    }

    String endToken = cell.getTokenString();
    assert endToken.length() == detailLevel;
    List<Node> cells = new ArrayList<Node>(detailLevel);
    for (int i = 1; i < detailLevel; i++) {
      cells.add(getNode(endToken.substring(0, i)));
    }
    cells.add(cell);
    return cells;
  }

