    protected static int getLegalIndex(int index, int size) {
        while (index < 0) {
            index += size;
        }
        while (index >= size) {
            index -= size;
        }
        return index;
    }

