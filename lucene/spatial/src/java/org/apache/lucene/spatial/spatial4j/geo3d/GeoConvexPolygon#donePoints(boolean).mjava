    /** Finish the polygon, by connecting the last added point with the starting point.
    */
    public void donePoints(final boolean isInternalReturnEdge) {
        // If fewer than 3 points, can't do it.
        if (points.size() < 3)
            throw new IllegalArgumentException("Polygon needs at least three points.");
        // Time to construct the planes.  If the polygon is truly convex, then any adjacent point
        edges = new SidedPlane[points.size()];
        internalEdges = new boolean[points.size()];
        // to a segment can provide an interior measurement.
        for (int i = 0; i < points.size(); i++) {
            final GeoPoint start = points.get(i);
            final boolean isInternalEdge = (isInternalEdges!=null?(i == isInternalEdges.size()?isInternalReturnEdge:isInternalEdges.get(i)):false);
            final GeoPoint end = points.get(legalIndex(i+1));
            final GeoPoint check = points.get(legalIndex(i+2));
            final SidedPlane sp = new SidedPlane(check,start,end);
            //System.out.println("Created edge "+sp+" using start="+start+" end="+end+" check="+check);
            edges[i] = sp;
            internalEdges[i] = isInternalEdge;
        }
        createCenterPoint();
    }

