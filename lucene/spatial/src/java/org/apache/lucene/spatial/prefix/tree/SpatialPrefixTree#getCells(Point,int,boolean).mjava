  /**
   * A Point-optimized implementation of
   * {@link #getCells(com.spatial4j.core.shape.Shape, int, boolean, boolean)}. That
   * method in facts calls this for points.
   */
  public List<Cell> getCells(Point p, int detailLevel, boolean inclParents) {
    Cell cell = getCell(p, detailLevel);
    assert !cell.isLeaf();
    if (!inclParents || detailLevel == 1) {
      return Collections.singletonList(cell);
    }

    //fill in reverse order to be sorted
    Cell[] cells = new Cell[detailLevel];
    for (int i = detailLevel-1; true; i--) {
      cells[i] = cell;
      if (i == 0)
        break;
      cell = cell.getParent();
    }
    return Arrays.asList(cells);
  }

