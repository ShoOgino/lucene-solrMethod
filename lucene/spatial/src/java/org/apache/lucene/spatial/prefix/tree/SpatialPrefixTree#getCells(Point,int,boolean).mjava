  /**
   * A Point-optimized implementation of
   * {@link #getCells(com.spatial4j.core.shape.Shape, int, boolean, boolean)}. That
   * method in facts calls this for points.
   * <p/>
   * This implementation depends on {@link #getCell(String)} being fast, as its
   * called repeatedly when incPlarents is true.
   */
  public List<Cell> getCells(Point p, int detailLevel, boolean inclParents) {
    Cell cell = getCell(p, detailLevel);
    if (!inclParents) {
      return Collections.singletonList(cell);
    }

    String endToken = cell.getTokenString();
    assert endToken.length() == detailLevel;
    List<Cell> cells = new ArrayList<>(detailLevel);
    for (int i = 1; i < detailLevel; i++) {
      cells.add(getCell(endToken.substring(0, i)));
    }
    cells.add(cell);
    return cells;
  }

