  protected Rectangle gridSnap(Shape snapMe) {
    //The next 4 lines mimic PrefixTreeStrategy.createIndexableFields()
    double distErrPct = ((PrefixTreeStrategy) strategy).getDistErrPct();
    double distErr = SpatialArgs.calcDistanceFromErrPct(snapMe, distErrPct, ctx);
    int detailLevel = grid.getLevelForDistance(distErr);
    List<Cell> cells = grid.getCells(snapMe, detailLevel, false, true);

    //calc bounding box of cells.
    List<Shape> cellShapes = new ArrayList<Shape>(cells.size());
    for (Cell cell : cells) {
      cellShapes.add(cell.getShape());
    }
    return new ShapeCollection<Shape>(cellShapes, ctx).getBoundingBox();
  }

