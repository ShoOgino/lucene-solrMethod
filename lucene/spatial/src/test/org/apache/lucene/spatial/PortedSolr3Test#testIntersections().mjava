  @Test
  public void testIntersections() throws Exception {
    setupDocs();
    //Try some edge cases
    checkHitsCircle("1,1", 175, 3, 5, 6, 7);
    checkHitsCircle("0,179.8", 200, 2, 8, 9);
    checkHitsCircle("89.8, 50", 200, 2, 10, 11);//this goes over the north pole
    checkHitsCircle("-89.8, 50", 200, 2, 12, 13);//this goes over the south pole
    //try some normal cases
    checkHitsCircle("33.0,-80.0", 300, 2);
    //large distance
    checkHitsCircle("1,1", 5000, 3, 5, 6, 7);
    //Because we are generating a box based on the west/east longitudes and the south/north latitudes, which then
    //translates to a range query, which is slightly more inclusive.  Thus, even though 0.0 is 15.725 kms away,
    //it will be included, b/c of the box calculation.
    checkHitsBBox("0.1,0.1", 15, 2, 5, 6);
    //try some more
    deleteAll();
    adoc("14", "0,5");
    adoc("15", "0,15");
    //3000KM from 0,0, see http://www.movable-type.co.uk/scripts/latlong.html
    adoc("16", "18.71111,19.79750");
    adoc("17", "44.043900,-95.436643");
    commit();

    checkHitsCircle("0,0", 1000, 1, 14);
    checkHitsCircle("0,0", 2000, 2, 14, 15);
    checkHitsBBox("0,0", 3000, 3, 14, 15, 16);
    checkHitsCircle("0,0", 3001, 3, 14, 15, 16);
    checkHitsCircle("0,0", 3000.1, 3, 14, 15, 16);

    //really fine grained distance and reflects some of the vagaries of how we are calculating the box
    checkHitsCircle("43.517030,-96.789603", 109, 0);

    // falls outside of the real distance, but inside the bounding box
    checkHitsCircle("43.517030,-96.789603", 110, 0);
    checkHitsBBox("43.517030,-96.789603", 110, 1, 17);
  }

