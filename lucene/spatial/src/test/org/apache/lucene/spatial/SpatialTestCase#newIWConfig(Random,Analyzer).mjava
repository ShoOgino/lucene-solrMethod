  protected IndexWriterConfig newIWConfig(Random random, Analyzer analyzer) {
    final IndexWriterConfig indexWriterConfig = LuceneTestCase.newIndexWriterConfig(random, analyzer);
    //TODO can we randomly choose a doc-values supported format?
    if (needsDocValues())
      indexWriterConfig.setCodec( TestUtil.getDefaultCodec());
    return indexWriterConfig;
  }

