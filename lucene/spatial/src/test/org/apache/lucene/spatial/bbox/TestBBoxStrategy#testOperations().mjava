  @Test
  @Repeat(iterations = 20)
  public void testOperations() throws IOException {
    //setup
    if (random().nextInt(4) > 0) {//75% of the time choose geo (more interesting to test)
      this.ctx = SpatialContext.GEO;
    } else {
      SpatialContextFactory factory = new SpatialContextFactory();
      factory.geo = false;
      factory.worldBounds = new RectangleImpl(-300, 300, -100, 100, null);
      this.ctx = factory.newSpatialContext();
    }
    this.strategy = new BBoxStrategy(ctx, "bbox");
    //test we can disable docValues for predicate tests
    if (random().nextBoolean()) {
      BBoxStrategy bboxStrategy = (BBoxStrategy) strategy;
      FieldType fieldType = new FieldType(bboxStrategy.getFieldType());
      fieldType.setDocValueType(DocValuesType.NO);
      bboxStrategy.setFieldType(fieldType);
    }
    for (SpatialOperation operation : SpatialOperation.values()) {
      if (operation == SpatialOperation.Overlaps)
        continue;//unsupported
      testOperationRandomShapes(operation);

      deleteAll();
      commit();
    }
  }

