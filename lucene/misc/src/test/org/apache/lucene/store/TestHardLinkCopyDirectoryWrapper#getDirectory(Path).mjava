  @Override
  protected Directory getDirectory(Path file) throws IOException {
    Directory open = random().nextBoolean() ? newFSDirectory(file) : newDirectory();
    return new HardlinkCopyDirectoryWrapper(open);
  }

