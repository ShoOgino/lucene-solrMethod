  private static DoubleStream filterAndFlatValues(double[][] values, Predicate<? super double[]> p) {
    return filterValues(values, (v) -> v != null).flatMapToDouble(Arrays::stream);
  }

