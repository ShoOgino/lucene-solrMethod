  /** return random IPv4 or IPv6 address */
  private InetAddress nextInetaddress() throws UnknownHostException {
    byte[] b;
    switch (ipVersion) {
      case IPv4:
        b = new byte[4];
        break;
      case IPv6:
        b = new byte[16];
        break;
      default:
        throw new IllegalArgumentException("incorrect IP version: " + ipVersion);
    }
    random().nextBytes(b);
    return InetAddress.getByAddress(b);
  }

