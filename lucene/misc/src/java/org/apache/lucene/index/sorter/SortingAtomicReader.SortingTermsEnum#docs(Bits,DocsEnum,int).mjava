    @Override
    public DocsEnum docs(Bits liveDocs, DocsEnum reuse, final int flags) throws IOException {
      // if we're asked to reuse the given DocsEnum and it is Sorting, return
      // the wrapped one, since some Codecs expect it.
      if (reuse != null && reuse instanceof SortingDocsEnum) {
        reuse = ((SortingDocsEnum) reuse).getWrapped();
      }
      boolean withFreqs = indexOptions.compareTo(IndexOptions.DOCS_AND_FREQS) >=0 && (flags & DocsEnum.FLAG_FREQS) != 0;
      return new SortingDocsEnum(in.docs(newToOld(liveDocs), reuse, flags), withFreqs, docMap);
    }

