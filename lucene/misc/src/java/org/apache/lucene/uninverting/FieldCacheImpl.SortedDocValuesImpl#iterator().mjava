    public SortedDocValues iterator() {
      final BytesRef term = new BytesRef();
      return new SortedDocValues() {

        @Override
        public int getValueCount() {
          return numOrd;
        }

        @Override
        public int getOrd(int docID) {
          // Subtract 1, matching the 1+ord we did when
          // storing, so that missing values, which are 0 in the
          // packed ints, are returned as -1 ord:
          return (int) docToTermOrd.get(docID)-1;
        }

        @Override
        public BytesRef lookupOrd(int ord) {
          if (ord < 0) {
            throw new IllegalArgumentException("ord must be >=0 (got ord=" + ord + ")");
          }
          bytes.fill(term, termOrdToBytesOffset.get(ord));
          return term;
        }
      };
    }

