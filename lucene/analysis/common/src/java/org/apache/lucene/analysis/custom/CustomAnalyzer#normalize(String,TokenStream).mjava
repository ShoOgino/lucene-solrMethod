  @Override
  protected TokenStream normalize(String fieldName, TokenStream in) {
    TokenStream result = in;
    // tokenizers can return a tokenfilter if the tokenizer does normalization,
    // although this is really bogus/abstraction violation...
    if (tokenizer instanceof MultiTermAwareComponent) {
      TokenFilterFactory filter = (TokenFilterFactory) ((MultiTermAwareComponent) tokenizer).getMultiTermComponent();
      result = filter.create(result);
    }
    for (TokenFilterFactory filter : tokenFilters) {
      if (filter instanceof MultiTermAwareComponent) {
        filter = (TokenFilterFactory) ((MultiTermAwareComponent) filter).getMultiTermComponent();
        result = filter.create(result);
      }
    }
    return result;
  }

