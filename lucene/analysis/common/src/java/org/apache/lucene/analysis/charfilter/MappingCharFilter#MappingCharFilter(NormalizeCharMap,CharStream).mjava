  /** Default constructor that takes a {@link CharStream}. */
  public MappingCharFilter(NormalizeCharMap normMap, CharStream in) {
    super(in);
    buffer.reset(in);

    map = normMap.map;
    cachedRootArcs = normMap.cachedRootArcs;

    if (map != null) {
      fstReader = map.getBytesReader(0);
    } else {
      fstReader = null;
    }
  }

