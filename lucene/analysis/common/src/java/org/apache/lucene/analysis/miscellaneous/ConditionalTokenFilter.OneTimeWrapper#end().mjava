    @Override
    public void end() throws IOException {
      // imitate Tokenizer.end() call - endAttributes, set final offset
      if (exhausted) {
        if (endCalled == false) {
          input.end();
        }
        endCalled = true;
        endOffset = offsetAtt.endOffset();
      }
      endAttributes();
      offsetAtt.setOffset(endOffset, endOffset);
    }

