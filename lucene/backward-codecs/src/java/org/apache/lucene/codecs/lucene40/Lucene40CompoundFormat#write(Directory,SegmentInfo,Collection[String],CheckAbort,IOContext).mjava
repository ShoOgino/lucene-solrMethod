  @Override
  public void write(Directory dir, SegmentInfo si, Collection<String> files, CheckAbort checkAbort, IOContext context) throws IOException {
    String fileName = IndexFileNames.segmentFileName(si.name, "", COMPOUND_FILE_EXTENSION);
    try (Directory cfs = new Lucene40CompoundReader(dir, fileName, context, true)) {
      for (String file : files) {
        dir.copy(cfs, file, file, context);
        checkAbort.work(dir.fileLength(file));
      }
    }
  }

