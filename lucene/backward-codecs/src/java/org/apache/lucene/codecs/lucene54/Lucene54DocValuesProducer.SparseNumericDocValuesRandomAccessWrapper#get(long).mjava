    @Override
    public long get(long longIndex) {
      final int index = Math.toIntExact(longIndex);
      int doc = values.docID();
      if (doc >= index) {
        values.reset();
      }
      assert values.docID() < index;
      try {
        doc = values.advance(index);
      } catch (IOException e) {
        throw new RuntimeException(e);
      }
      if (doc == index) {
        return values.longValue();
      } else {
        return missingValue;
      }
    }

