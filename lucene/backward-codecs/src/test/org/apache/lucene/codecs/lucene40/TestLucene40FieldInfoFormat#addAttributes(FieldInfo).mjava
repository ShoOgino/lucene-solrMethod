  // but we have more internal typing information, previously recorded in fieldinfos.
  // this is exposed via attributes (so our writer expects them to be set by the dv impl)
  @Override
  protected void addAttributes(FieldInfo fi) {
    DocValuesType dvType = fi.getDocValuesType();
    if (dvType != null) {
      switch (dvType) {
        case BINARY: 
          fi.putAttribute(Lucene40FieldInfosFormat.LEGACY_DV_TYPE_KEY, LegacyDocValuesType.BYTES_FIXED_STRAIGHT.name());
          break;
        case NUMERIC:
          fi.putAttribute(Lucene40FieldInfosFormat.LEGACY_DV_TYPE_KEY, LegacyDocValuesType.FIXED_INTS_32.name());
          break;
        case SORTED:
          fi.putAttribute(Lucene40FieldInfosFormat.LEGACY_DV_TYPE_KEY, LegacyDocValuesType.BYTES_FIXED_SORTED.name());
          break;
        default:
          throw new AssertionError();
      }
    }
    
    if (fi.getNormType() != null) {
      fi.putAttribute(Lucene40FieldInfosFormat.LEGACY_NORM_TYPE_KEY, LegacyDocValuesType.FIXED_INTS_8.name());
    }
  }

