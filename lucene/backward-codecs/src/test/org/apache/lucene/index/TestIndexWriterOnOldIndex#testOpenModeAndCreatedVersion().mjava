  public void testOpenModeAndCreatedVersion() throws IOException {
    InputStream resource = getClass().getResourceAsStream("unsupported.index.single-empty-doc.630.zip");
    assertNotNull(resource);
    Path path = createTempDir();
    TestUtil.unzip(resource, path);
    Directory dir = newFSDirectory(path);
    for (OpenMode openMode : OpenMode.values()) {
      Directory tmpDir = newDirectory(dir);
      assertEquals(6 /** 6.3.0 */, SegmentInfos.readLatestCommit(tmpDir).getIndexCreatedVersionMajor());
      IndexWriter w = new IndexWriter(tmpDir, newIndexWriterConfig().setOpenMode(openMode));
      w.commit();
      w.close();
      switch (openMode) {
        case CREATE:
          assertEquals(Version.LATEST.major, SegmentInfos.readLatestCommit(tmpDir).getIndexCreatedVersionMajor());
          break;
        default:
          assertEquals(6 /** 6.3.0 */, SegmentInfos.readLatestCommit(tmpDir).getIndexCreatedVersionMajor());
      }
      tmpDir.close();
    }
    dir.close();
  }

