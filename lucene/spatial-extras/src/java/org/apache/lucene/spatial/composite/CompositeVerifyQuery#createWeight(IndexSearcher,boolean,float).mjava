  @Override
  public Weight createWeight(IndexSearcher searcher, boolean needsScores, float boost) throws IOException {
    final Weight indexQueryWeight = indexQuery.createWeight(searcher, false, boost);//scores aren't unsupported

    return new ConstantScoreWeight(this, boost) {

      @Override
      public Scorer scorer(LeafReaderContext context) throws IOException {

        final Scorer indexQueryScorer = indexQueryWeight.scorer(context);
        if (indexQueryScorer == null) {
          return null;
        }

        final TwoPhaseIterator predFuncValues = predicateValueSource.iterator(context, indexQueryScorer.iterator());
        return new ConstantScoreScorer(this, score(), predFuncValues);
      }

      @Override
      public IndexReader.CacheHelper getCacheHelper(LeafReaderContext context) {
        return null; // TODO delegate to PredicateValueSource?
      }
    };
  }

