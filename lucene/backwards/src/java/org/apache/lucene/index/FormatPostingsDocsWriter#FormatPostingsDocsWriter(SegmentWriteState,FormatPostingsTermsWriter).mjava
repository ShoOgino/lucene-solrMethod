  FormatPostingsDocsWriter(SegmentWriteState state, FormatPostingsTermsWriter parent) throws IOException {
    super();
    this.parent = parent;
    final String fileName = IndexFileNames.segmentFileName(parent.parent.segment, IndexFileNames.FREQ_EXTENSION);
    state.flushedFiles.add(fileName);
    out = parent.parent.dir.createOutput(fileName);
    totalNumDocs = parent.parent.totalNumDocs;

    // TODO: abstraction violation
    skipInterval = parent.parent.termsOut.skipInterval;
    skipListWriter = parent.parent.skipListWriter;
    skipListWriter.setFreqOutput(out);

    posWriter = new FormatPostingsPositionsWriter(state, this);
  }

