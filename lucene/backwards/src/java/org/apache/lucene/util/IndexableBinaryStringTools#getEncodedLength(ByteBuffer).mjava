  /**
   * Returns the number of chars required to encode the given byte sequence.
   * 
   * @param original The byte sequence to be encoded.  Must be backed by an array.
   * @return The number of chars required to encode the given byte sequence
   * @throws IllegalArgumentException If the given ByteBuffer is not backed by an array
   */
  public static int getEncodedLength(ByteBuffer original) 
    throws IllegalArgumentException {
    if (original.hasArray()) {
      // Use long for intermediaries to protect against overflow
      long length = (long)(original.limit() - original.arrayOffset());
      return (int)((length * 8L + 14L) / 15L) + 1;
    } else {
      throw new IllegalArgumentException("original argument must have a backing array");
    }
  }

