  @Override
  public int advance(int target) throws IOException {
    assert state != IteratorState.FINISHED : "advance() called after NO_MORE_DOCS";
    assert target > doc : "target must be > docID(), got " + target + " <= " + doc;
    int advanced = in.advance(target);
    assert advanced >= target : "backwards advance from: " + target + " to: " + advanced;
    if (advanced == DocIdSetIterator.NO_MORE_DOCS) {
      state = IteratorState.FINISHED;
    } else {
      state = IteratorState.ITERATING;
    }
    assert in.docID() == advanced;
    return doc = advanced;
  }

