  @Override
  public BulkScorer bulkScorer(AtomicReaderContext context, boolean scoreDocsInOrder, Bits acceptDocs) throws IOException {
    // if the caller asks for in-order scoring or if the weight does not support
    // out-of order scoring then collection will have to happen in-order.
    BulkScorer inScorer = in.bulkScorer(context, scoreDocsInOrder, acceptDocs);
    if (inScorer == null) {
      return null;
    }
    if (AssertingBulkScorer.shouldWrap(inScorer)) {
      return AssertingBulkScorer.wrap(new Random(random.nextLong()), inScorer);
    } else {
      // Let super wrap this.scorer instead, so we use
      // AssertingScorer:
      return super.bulkScorer(context, scoreDocsInOrder, acceptDocs);
    }
  }

