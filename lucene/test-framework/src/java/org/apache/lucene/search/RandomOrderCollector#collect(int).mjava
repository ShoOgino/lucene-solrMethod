  @Override
  public void collect(int doc) throws IOException {
    docIDs[buffered] = doc;
    scores[buffered] = scorer.score();
    try {
      freqs[buffered] = scorer.freq();
    } catch (UnsupportedOperationException e) {
      freqs[buffered] = -1;
    }
    if (++buffered == bufferSize) {
      flush();
    }
  }

