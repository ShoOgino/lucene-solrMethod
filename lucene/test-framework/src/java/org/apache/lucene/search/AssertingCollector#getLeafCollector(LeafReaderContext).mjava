  @Override
  public LeafCollector getLeafCollector(LeafReaderContext context) throws IOException {
    return new FilterLeafCollector(super.getLeafCollector(context)) {

      int lastCollected = -1;

      @Override
      public void setScorer(Scorer scorer) throws IOException {
        super.setScorer(AssertingScorer.getAssertingScorer(random, scorer));
      }

      @Override
      public void collect(int doc) throws IOException {
        if (inOrder || !acceptsDocsOutOfOrder()) {
          assert doc > lastCollected : "Out of order : " + lastCollected + " " + doc;
        }
        in.collect(doc);
        lastCollected = doc;
      }

    };
  }

