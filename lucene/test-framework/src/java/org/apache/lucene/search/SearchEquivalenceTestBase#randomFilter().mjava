  /**
   * Returns a random filter over the document set
   */
  protected Filter randomFilter() {
    final Query query;
    if (random().nextBoolean()) {
      query = TermRangeQuery.newStringRange("field", "a", "" + randomChar(), true, true);
    } else {
      // use a query with a two-phase approximation
      PhraseQuery phrase = new PhraseQuery();
      phrase.add(new Term("field", "" + randomChar()));
      phrase.add(new Term("field", "" + randomChar()));
      phrase.setSlop(100);
      query = phrase;
    }
    
    // now wrap the query as a filter. QWF has its own codepath
    if (random().nextBoolean()) {
      return new QueryWrapperFilter(query);
    } else {
      return new SlowWrapperFilter(query, random().nextBoolean());
    }
  }

