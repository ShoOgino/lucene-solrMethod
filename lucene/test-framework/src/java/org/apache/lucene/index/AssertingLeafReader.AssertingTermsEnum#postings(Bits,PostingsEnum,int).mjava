    @Override
    public PostingsEnum postings(Bits liveDocs, PostingsEnum reuse, int flags) throws IOException {
      assertThread("Terms enums", creationThread);
      assert state == State.POSITIONED: "docs(...) called on unpositioned TermsEnum";

      // reuse if the codec reused
      final PostingsEnum actualReuse;
      if (reuse instanceof AssertingPostingsEnum) {
        actualReuse = ((AssertingPostingsEnum) reuse).in;
      } else {
        actualReuse = null;
      }
      PostingsEnum docs = super.postings(liveDocs, actualReuse, flags);
      if (docs == null) {
        return null;
      } else if (docs == actualReuse) {
        // codec reused, reset asserting state
        ((AssertingPostingsEnum)reuse).reset();
        return reuse;
      } else {
        return new AssertingPostingsEnum(docs);
      }
    }

