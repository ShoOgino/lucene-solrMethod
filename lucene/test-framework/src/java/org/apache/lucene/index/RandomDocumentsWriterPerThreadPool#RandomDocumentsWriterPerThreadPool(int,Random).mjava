  public RandomDocumentsWriterPerThreadPool(int maxNumPerThreads, Random random) {
    super(maxNumPerThreads);
    assert getMaxThreadStates() >= 1;
    states = new ThreadState[maxNumPerThreads];
    this.random = new Random(random.nextLong());
    this.maxRetry = 1 + random.nextInt(10);
  }

