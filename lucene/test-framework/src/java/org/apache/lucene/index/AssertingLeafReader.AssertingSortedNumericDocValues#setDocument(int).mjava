    @Override
    public void setDocument(int doc) {
      assertThread("Sorted numeric doc values", creationThread);
      assert doc >= 0 && doc < maxDoc;
      in.setDocument(doc);
      // check the values are actually sorted
      long previous = Long.MIN_VALUE;
      for (int i = 0; i < in.count(); i++) {
        long v = in.valueAt(i);
        assert v >= previous;
        previous = v;
      }
    }

