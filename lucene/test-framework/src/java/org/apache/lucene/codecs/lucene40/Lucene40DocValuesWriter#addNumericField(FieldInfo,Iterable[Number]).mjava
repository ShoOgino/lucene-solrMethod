  @Override
  public void addNumericField(FieldInfo field, Iterable<Number> values) throws IOException {
    // TODO: examine the values: and simulate all the possibilities.
    // e.g. if all values fit in a byte, write a fixed_8 etc.
    field.putAttribute(legacyKey, LegacyDocValuesType.VAR_INTS.name());
    String fileName = IndexFileNames.segmentFileName(state.segmentInfo.name, Integer.toString(field.number), "dat");
    IndexOutput data = dir.createOutput(fileName, state.context);
    boolean success = false;
    try {
      addVarIntsField(data, values);
      success = true;
    } finally {
      if (success) {
        IOUtils.close(data);
      } else {
        IOUtils.closeWhileHandlingException(data);
      }
    }
  }

