    @Override
    public void finish(long sumTotalTermFreq, long sumDocFreq, int docCount) throws IOException {
      // TODO: assert that if state == START (no finishTerm called), that no actual docs were fed.
      // TODO: this makes the api really confusing! we should try to clean this up!
      assert state == TermsConsumerState.INITIAL || state == TermsConsumerState.START;
      state = TermsConsumerState.FINISHED;
      assert docCount >= 0;
      assert sumDocFreq >= docCount;
      if (fieldInfo.getIndexOptions() == IndexOptions.DOCS_ONLY) {
        assert sumTotalTermFreq == -1;
      } else {
        assert sumTotalTermFreq >= sumDocFreq;        
      }
      in.finish(sumTotalTermFreq, sumDocFreq, docCount);
    }

