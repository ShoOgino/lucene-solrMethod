    @Override
    public void startDocument(int numStoredFields) throws IOException {
      in.startDocument(numStoredFields);
      assert fieldCount == 0;
      fieldCount = numStoredFields;
      numWritten++;
    }

