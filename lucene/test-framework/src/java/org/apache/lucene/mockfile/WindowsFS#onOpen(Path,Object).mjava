  @Override
  protected void onOpen(Path path, Object stream) throws IOException {
    synchronized (openFiles) {
      final Object key = getKey(path);
      // we have to read the key under the lock otherwise me might leak the openFile handle
      // if we concurrently delete or move this file.
      Integer v = openFiles.get(key);
      if (v != null) {
        v = Integer.valueOf(v.intValue()+1);
        openFiles.put(key, v);
      } else {
        openFiles.put(key, Integer.valueOf(1));
      }
    }
  }

