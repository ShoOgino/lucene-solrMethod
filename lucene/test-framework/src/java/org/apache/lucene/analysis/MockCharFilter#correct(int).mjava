  @Override
  public int correct(int currentOff) {
    SortedMap<Integer,Integer> subMap = corrections.subMap(0, currentOff+1);
    int ret = subMap.isEmpty() ? currentOff : currentOff + subMap.get(subMap.lastKey());
    assert ret >= 0 : "currentOff=" + currentOff + ",diff=" + (ret-currentOff);
    return ret;
  }

