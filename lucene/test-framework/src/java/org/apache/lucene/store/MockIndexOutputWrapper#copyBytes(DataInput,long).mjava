  @Override
  public void copyBytes(DataInput input, long numBytes) throws IOException {
    delegate.copyBytes(input, numBytes);
    // TODO: we may need to check disk full here as well
    dir.maybeThrowDeterministicException();
  }

