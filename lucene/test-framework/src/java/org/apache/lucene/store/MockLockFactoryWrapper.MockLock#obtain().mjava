    @Override
    public boolean obtain() throws IOException {
      if (delegateLock.obtain()) {
        assert (delegate instanceof NoLockFactory) || dir.openLocks.containsKey(name) == false;
        dir.openLocks.put(name, new RuntimeException("lock \"" + name + "\" was not released"));
        return true;
      } else {
        return false;
      }
    }

