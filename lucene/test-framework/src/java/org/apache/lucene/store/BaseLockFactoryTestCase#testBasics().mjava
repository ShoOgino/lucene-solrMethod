  /** Test obtaining and releasing locks, checking validity */
  public void testBasics() throws IOException {
    Directory dir = getDirectory(createTempDir());
    
    Lock l = dir.obtainLock("commit");
    try {
      dir.obtainLock("commit");
      fail("succeeded in obtaining lock twice, didn't get exception");
    } catch (LockObtainFailedException expected) {}
    l.close();
    
    // Make sure we can obtain first one again:
    l = dir.obtainLock("commit");
    l.close();
    
    dir.close();
  }

