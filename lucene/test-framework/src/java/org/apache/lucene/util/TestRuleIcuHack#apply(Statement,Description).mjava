  @Override
  public Statement apply(final Statement s, Description d) {
    return new Statement() {
      @Override
      public void evaluate() throws Throwable {
        // START hack to init ICU safely before we randomize locales.
        // ICU fails during classloading when a special Java7-only locale is the default
        // see: http://bugs.icu-project.org/trac/ticket/8734
        if (!icuTested.getAndSet(true)) {
          Locale previous = Locale.getDefault();
          try {
            Locale.setDefault(Locale.ROOT);
            Class.forName("com.ibm.icu.util.ULocale");
          } catch (ClassNotFoundException cnfe) {
            // ignore if no ICU is in classpath
          } finally {
            Locale.setDefault(previous);
          }
        }

        s.evaluate();
      }
    };
  }

