  /** Returns true if this is an FSDirectory backed by {@link WindowsFS}. */
  public static boolean isWindowsFS(Directory dir) {
    // First unwrap directory to see if there is an FSDir:
    while (true) {
      if (dir instanceof FSDirectory) {
        return isWindowsFS(((FSDirectory) dir).getDirectory());
      } else if (dir instanceof FilterDirectory) {
        dir = ((FilterDirectory) dir).getDelegate();
      } else {
        return false;
      }
    }
  }

