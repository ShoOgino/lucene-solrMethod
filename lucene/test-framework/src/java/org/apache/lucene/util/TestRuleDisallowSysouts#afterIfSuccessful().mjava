  /**
   * We're only interested in failing the suite if it was successful. Otherwise
   * just propagate the original problem and don't bother.
   */
  @Override
  protected void afterIfSuccessful() throws Throwable {
    if (isEnforced()) {
      checkCaptureStreams();
  
      // Flush any buffers.
      capturedSystemOut.printStream.flush();
      capturedSystemErr.printStream.flush();
  
      // And check for offenders, but only if everything was successful so far.
      StackTraceElement[] offenderStack = firstWriteStack.get();
      if (offenderStack != null && failureMarker.wasSuccessful()) {
        AssertionError e = new AssertionError("The test or suite printed information to stdout or stderr," +
            " even though verbose mode is turned off and it's not annotated with @" + 
            SuppressSysoutChecks.class.getSimpleName() + ". This exception contains the stack" +
                " trace of the first offending call.");
        e.setStackTrace(offenderStack);
        throw e;
      }
    }
  }

