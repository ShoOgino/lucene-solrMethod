  @Override
  public Statement apply(final Statement s, final Description d) {
    return new Statement() {
      @Override
      public void evaluate() throws Throwable {
        if (failuresSoFar >= maxFailures) {
          RandomizedTest.assumeTrue("Ignored, failures limit reached (" + 
              failuresSoFar + " >= " + maxFailures + ").", false);
        }

        try {
          s.evaluate();
        } catch (Throwable t) {
          if (!TestRuleMarkFailure.isAssumption(t)) {
            System.out.println("#" + d);
            failuresSoFar++;
          }
          throw t;
        }
      }
    };
  }

