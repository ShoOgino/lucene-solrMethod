  @Override
  public Statement apply(final Statement s, Description d) {
    return new Statement() {
      @Override
      public void evaluate() throws Throwable {
        // Clear status at start.
        failures = false;

        try {
          s.evaluate();
        } catch (Throwable t) {
          for (Throwable t2 : expandFromMultiple(t)) {
            if (!(t2 instanceof AssumptionViolatedException)) {
              markFailed();
              break;
            }
          }
          throw t;
        }
      }
    };
  }

