  /** Tells {@link IndexWriter} to enforce the specified limit as the maximum number of documents in one index; call
   *  {@link #restoreIndexWriterMaxDocs} once your test is done. */
  public void setIndexWriterMaxDocs(int limit) {
    Method m;
    try {
      m = IndexWriter.class.getDeclaredMethod("setMaxDocs", int.class);
    } catch (NoSuchMethodException nsme) {
      throw new RuntimeException(nsme);
    }
    m.setAccessible(true);
    try {
      m.invoke(IndexWriter.class, limit);
    } catch (IllegalAccessException | InvocationTargetException iae) {
      throw new RuntimeException(iae);
    }
  }

