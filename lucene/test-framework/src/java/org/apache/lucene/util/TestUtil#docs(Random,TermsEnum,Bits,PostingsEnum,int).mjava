  // Returns a DocsEnum from a positioned TermsEnum, but
  // randomly sometimes uses a DocsAndFreqsEnum, DocsAndPositionsEnum.
  public static PostingsEnum docs(Random random, TermsEnum termsEnum, Bits liveDocs, PostingsEnum reuse, int flags) throws IOException {
    if (random.nextBoolean()) {
      if (random.nextBoolean()) {
        final int posFlags;
        switch (random.nextInt(4)) {
          case 0: posFlags = PostingsEnum.FLAG_POSITIONS; break;
          case 1: posFlags = PostingsEnum.FLAG_OFFSETS; break;
          case 2: posFlags = PostingsEnum.FLAG_PAYLOADS; break;
          default: posFlags = PostingsEnum.FLAG_OFFSETS | PostingsEnum.FLAG_PAYLOADS; break;
        }
        PostingsEnum docsAndPositions = termsEnum.postings(liveDocs, null, posFlags);
        if (docsAndPositions != null) {
          return docsAndPositions;
        }
      }
      flags |= PostingsEnum.FLAG_FREQS;
    }
    return termsEnum.postings(liveDocs, reuse, flags);
  }

