  @Override
  public Statement apply(final Statement s, final Description d) {
    return new Statement() {
      @Override
      public void evaluate() throws Throwable {
        s.evaluate();

        Throwable problem = null;
        try {
          LuceneTestCase.assertSaneFieldCaches(d.getDisplayName());
        } catch (Throwable t) {
          problem = t;
        }

        FieldCache.DEFAULT.purgeAllCaches();

        if (problem != null) {
          Rethrow.rethrow(problem);
        }
      }
    };
  }  

