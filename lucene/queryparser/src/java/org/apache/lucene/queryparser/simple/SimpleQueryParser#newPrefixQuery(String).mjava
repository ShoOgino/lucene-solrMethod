  /**
   * Factory method to generate a prefix query.
   */
  protected Query newPrefixQuery(String text) {
    BooleanQuery.Builder bq = new BooleanQuery.Builder();
    bq.setDisableCoord(true);
    for (Map.Entry<String,Float> entry : weights.entrySet()) {
      PrefixQuery prefix = new PrefixQuery(new Term(entry.getKey(), text));
      prefix.setBoost(entry.getValue());
      bq.add(prefix, BooleanClause.Occur.SHOULD);
    }
    return simplify(bq.build());
  }

