  @Override
  public synchronized String[] listAll() throws IOException {
    final Set<String> files = new HashSet<String>();
    for(String f : cache.listAll()) {
      files.add(f);
    }
    for(String f : delegate.listAll()) {
      assert !files.contains(f);
      files.add(f);
    }
    return files.toArray(new String[files.size()]);
  }

