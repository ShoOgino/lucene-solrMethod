  private boolean isOptimized(IndexWriter writer, SegmentInfo info)
    throws IOException {
    assert writer != null;
    return !info.hasDeletions() &&
      !info.hasSeparateNorms() &&
      info.dir == writer.getDirectory() &&
      info.getUseCompoundFile() == getUseCompoundFile();
  }

