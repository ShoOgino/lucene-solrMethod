  public boolean maybeReopen(boolean applyAllDeletes) throws IOException {
    if (reopenLock.tryLock()) {
      try {
        final SearcherManagerRef reference = applyAllDeletes ? withDeletes : withoutDeletes;
        // Mark gen as of when reopen started:
        final long newSearcherGen = indexingGen.getAndIncrement();
        boolean setSearchGen = false;
        if (!(setSearchGen = reference.manager.isSearcherCurrent())) {
          setSearchGen = reference.manager.maybeReopen();
        }
        if (setSearchGen) {
          reference.generation = newSearcherGen;// update searcher gen
          newGeneration.signalAll(); // wake up threads if we have a new generation
        }
        return setSearchGen;
      } finally {
        reopenLock.unlock();
      }
    }
    return false;
  }

