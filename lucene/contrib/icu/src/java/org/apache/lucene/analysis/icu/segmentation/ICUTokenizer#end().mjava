  @Override
  public void end() throws IOException {
    final int finalOffset = (length < 0) ? offset : offset + length;
    offsetAtt.setOffset(finalOffset, finalOffset);
  }  

