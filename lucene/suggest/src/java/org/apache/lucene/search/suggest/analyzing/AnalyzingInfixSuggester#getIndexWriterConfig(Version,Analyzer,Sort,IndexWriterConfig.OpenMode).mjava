  /** Override this to customize index settings, e.g. which
   *  codec to use. The sort is null if this config is for
   *  the first pass writer. */
  protected IndexWriterConfig getIndexWriterConfig(Version matchVersion, Analyzer indexAnalyzer, Sort sort, IndexWriterConfig.OpenMode openMode) {
    IndexWriterConfig iwc = new IndexWriterConfig(matchVersion, indexAnalyzer);
    iwc.setCodec(new Lucene46Codec());
    iwc.setOpenMode(openMode);

    if (sort != null) {
      // This way all merged segments will be sorted at
      // merge time, allow for per-segment early termination
      // when those segments are searched:
      iwc.setMergePolicy(new SortingMergePolicy(iwc.getMergePolicy(), sort));
    }
    return iwc;
  }

