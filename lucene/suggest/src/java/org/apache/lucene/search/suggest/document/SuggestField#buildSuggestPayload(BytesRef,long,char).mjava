  private BytesRef buildSuggestPayload(BytesRef surfaceForm, long weight, char sepLabel) throws IOException {
    for (int i = 0; i < surfaceForm.length; i++) {
      if (surfaceForm.bytes[i] == sepLabel) {
        assert sepLabel == '\u001f';
        throw new IllegalArgumentException(
            "surface form cannot contain unit separator character U+001F; this character is reserved");
      }
    }
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    try (OutputStreamDataOutput output = new OutputStreamDataOutput(byteArrayOutputStream)) {
      output.writeVInt(surfaceForm.length);
      output.writeBytes(surfaceForm.bytes, surfaceForm.offset, surfaceForm.length);
      output.writeVLong(weight + 1);
    }
    return new BytesRef(byteArrayOutputStream.toByteArray());
  }

