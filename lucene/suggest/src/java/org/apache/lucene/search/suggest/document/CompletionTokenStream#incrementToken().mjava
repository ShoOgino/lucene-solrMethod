  @Override
  public boolean incrementToken() throws IOException {
    clearAttributes();
    if (finiteStrings == null) {
      //TODO: make this return a Iterator<IntsRef> instead?
      Automaton automaton = toAutomaton();
      Set<IntsRef> strings = Operations.getFiniteStrings(automaton, maxGraphExpansions);

      posInc = strings.size();
      finiteStrings = strings.iterator();
    }
    if (finiteStrings.hasNext()) {
      posAttr.setPositionIncrement(posInc);
      /*
       * this posInc encodes the number of paths that this surface form
       * produced. Multi Fields have the same surface form and therefore sum up
       */
      posInc = 0;
      Util.toBytesRef(finiteStrings.next(), bytesAtt.builder()); // now we have UTF-8
      if (charTermAttribute != null) {
        charTermAttribute.setLength(0);
        charTermAttribute.append(bytesAtt.toUTF16());
      }
      if (payload != null) {
        payloadAttr.setPayload(this.payload);
      }
      return true;
    }

    return false;
  }

