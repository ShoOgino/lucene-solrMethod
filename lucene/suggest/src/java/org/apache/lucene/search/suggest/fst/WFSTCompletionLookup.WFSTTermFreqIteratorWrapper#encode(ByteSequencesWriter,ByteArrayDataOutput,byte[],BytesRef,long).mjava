    @Override
    protected void encode(ByteSequencesWriter writer, ByteArrayDataOutput output, byte[] buffer, BytesRef spare, long weight) throws IOException {
      if (spare.length + 5 >= buffer.length) {
        buffer = ArrayUtil.grow(buffer, spare.length + 5);
      }
      output.reset(buffer);
      output.writeBytes(spare.bytes, spare.offset, spare.length);
      output.writeByte((byte)0); // separator: not used, just for sort order
      output.writeInt(encodeWeight(weight));
      writer.write(buffer, 0, output.getPosition());
    }

