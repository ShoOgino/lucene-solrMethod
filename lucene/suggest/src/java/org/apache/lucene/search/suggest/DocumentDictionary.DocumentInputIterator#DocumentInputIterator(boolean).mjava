    /**
     * Creates an iterator over term, weight and payload fields from the lucene
     * index. setting <code>withPayload</code> to false, implies an iterator
     * over only term and weight.
     */
    public DocumentInputIterator(boolean hasPayloads) throws IOException {
      docCount = reader.maxDoc() - 1;
      this.hasPayloads = hasPayloads;
      currentPayload = null;
      liveDocs = MultiFields.getLiveDocs(reader);
      this.relevantFields = getRelevantFields(new String [] {field, weightField, payloadField});
    }

