  private FacetsCollector performSearch(FacetIndexingParams iParams,
                                        TaxonomyReader tr, IndexReader ir,
                                        IndexSearcher searcher) throws IOException {
    // step 1: collect matching documents into a collector
    Query q = new MatchAllDocsQuery();
    TopScoreDocCollector topDocsCollector = TopScoreDocCollector.create(10,
        true);

    // Faceted search parameters indicate which facets are we interested in
    FacetSearchParams facetSearchParams = new FacetSearchParams(iParams);

    facetSearchParams.addFacetRequest(new CountFacetRequest(
        new CategoryPath("Band"), 10));
    CountFacetRequest bandDepth = new CountFacetRequest(new CategoryPath(
    "Band"), 10);
    bandDepth.setDepth(2);
    facetSearchParams.addFacetRequest(bandDepth);
    facetSearchParams.addFacetRequest(new CountFacetRequest(
        new CategoryPath("Author"), 10));
    facetSearchParams.addFacetRequest(new CountFacetRequest(
        new CategoryPath("Band", "Rock & Pop"), 10));

    // perform documents search and facets accumulation
    FacetsCollector facetsCollector = new FacetsCollector(facetSearchParams, ir, tr);
    searcher.search(q, MultiCollector.wrap(topDocsCollector, facetsCollector));
    return facetsCollector;
  }

