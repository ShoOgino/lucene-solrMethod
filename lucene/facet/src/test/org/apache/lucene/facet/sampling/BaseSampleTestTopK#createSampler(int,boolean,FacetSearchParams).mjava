  private Sampler createSampler(int nTrial, boolean useRandomSampler, FacetSearchParams sParams) {
    SamplingParams samplingParams = new SamplingParams();
    
    /*
     * Set sampling to Exact fixing with TakmiSampleFixer as it is not easy to
     * validate results with amortized results. 
     */
    samplingParams.setSampleFixer(new TakmiSampleFixer(indexReader, taxoReader, sParams));
        
    final double retryFactor = Math.pow(1.01, nTrial);
    samplingParams.setOversampleFactor(5.0 * retryFactor); // Oversampling 
    samplingParams.setSampleRatio(0.8 * retryFactor);
    samplingParams.setMinSampleSize((int) (100 * retryFactor));
    samplingParams.setMaxSampleSize((int) (10000 * retryFactor));
    samplingParams.setSamplingThreshold(11000); //force sampling

    Sampler sampler = useRandomSampler ? 
        new RandomSampler(samplingParams, new Random(random().nextLong())) :
          new RepeatableSampler(samplingParams);
    return sampler;
  }

