  @Test
  public void testDifferentAggregatorsSameCategoryList() throws Exception {
    // Same category list cannot be aggregated by two different aggregators. If
    // you want to do that, you need to separate the categories into two
    // category list (you'll still have one association list).
    DirectoryTaxonomyReader taxo = new DirectoryTaxonomyReader(taxoDir);

    // facet requests for two facets
    FacetSearchParams fsp = new FacetSearchParams(
        new AssociationIntSumFacetRequest(aint, 10),
        new AssociationIntSumFacetRequest(bint, 10),
        new AssociationFloatSumFacetRequest(afloat, 10),
        new AssociationFloatSumFacetRequest(bfloat, 10));
    
    Query q = new MatchAllDocsQuery();

    FacetsCollector fc = FacetsCollector.create(fsp, reader, taxo);
    
    IndexSearcher searcher = newSearcher(reader);
    searcher.search(q, fc);
    try {
      fc.getFacetResults();
      fail("different aggregators for same category list should not be supported");
    } catch (RuntimeException e) {
      // ok - expected
    }
    taxo.close();
  }  

