  private static void encoderTest(IntEncoder encoder, IntsRef data, IntsRef expected) throws IOException {
    // ensure toString is implemented
    String toString = encoder.toString();
    assertFalse(toString.startsWith(encoder.getClass().getName() + "@"));
    IntDecoder decoder = encoder.createMatchingDecoder();
    toString = decoder.toString();
    assertFalse(toString.startsWith(decoder.getClass().getName() + "@"));
    
    BytesRef bytes = new BytesRef(100); // some initial capacity - encoders should grow the byte[]
    IntsRef values = new IntsRef(100); // some initial capacity - decoders should grow the int[]
    for (int i = 0; i < 2; i++) {
      // run 2 iterations to catch encoders/decoders which don't reset properly
      encoding(encoder, data, bytes);
      decoding(bytes, values, encoder.createMatchingDecoder());
      assertTrue(expected.intsEquals(values));
    }
  }

