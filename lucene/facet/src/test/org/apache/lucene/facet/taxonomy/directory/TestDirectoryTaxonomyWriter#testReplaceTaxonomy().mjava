  @Test
  public void testReplaceTaxonomy() throws Exception {
    Directory input = newDirectory();
    DirectoryTaxonomyWriter taxoWriter = new DirectoryTaxonomyWriter(input);
    taxoWriter.addCategory(new CategoryPath("a"));
    taxoWriter.close();
    
    Directory dir = newDirectory();
    taxoWriter = new DirectoryTaxonomyWriter(dir);
    int ordinal = taxoWriter.addCategory(new CategoryPath("b"));
    taxoWriter.addCategory(new CategoryPath("c"));
    taxoWriter.commit();
    
    String origCreateTime = getCreateTime(dir);
    
    // replace the taxonomy with the input one
    taxoWriter.replaceTaxonomy(input);
    
    // add the same category again -- it should not receive the same ordinal !
    int newOrdinal = taxoWriter.addCategory(new CategoryPath("b"));
    assertNotSame("new ordinal cannot be the original ordinal", ordinal, newOrdinal);
    assertEquals("ordinal should have been 2 since only one category was added by replaceTaxonomy", 2, newOrdinal);
    
    taxoWriter.close();
    
    String newCreateTime = getCreateTime(dir);
    assertNotSame("create time should have been changed after replaceTaxonomy", origCreateTime, newCreateTime);
    
    dir.close();
    input.close();
  }

