  /**
   * Decodes a 32-bit integer from bytes read from {@code in}. Bytes are read,
   * one at a time, from {@code in}, and it is assumed they represent a 32-bit
   * integer encoded using this class's encoding scheme. The decoded value is
   * returned.
   * @param in The input stream containing the encoded bytes.
   * @return The decoded value.
   * @exception EOFException If the stream ends before a value has been decoded.
   */
  public static int decode(InputStream in) throws IOException {
    int value = 0;
    while (true) {
      int first = in.read();
      if (first < 0) {
        throw new EOFException();
      }
      value |= first & 0x7F;
      if ((first & 0x80) == 0) {
        return value;
      }
      value <<= 7;
    }
  }

