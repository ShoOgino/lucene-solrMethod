  @Override
  protected void doEncode(IntsRef values, BytesRef buf, int upto) {
    int prev = 0;
    for (int i = values.offset; i < upto; i++) {
      int tmp = values.ints[i];
      values.ints[i] -= prev;
      prev = tmp;
    }
    encoder.doEncode(values, buf, upto);
  }

