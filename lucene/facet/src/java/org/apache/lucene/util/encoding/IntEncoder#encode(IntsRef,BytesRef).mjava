  /**
   * Encodes the values to the given buffer. Note that the buffer's offset and
   * length are set to 0.
   */
  public final void encode(IntsRef values, BytesRef buf) {
    buf.offset = buf.length = 0;
    reset();
    doEncode(values, buf, values.offset + values.length);
    assert buf.offset == 0 : "offset should not have been modified by the encoder.";
  }

