  /**
   * Skip to the requested document. Returns true iff the document has categort
   * association values and they were read successfully.
   */
  public boolean setNextDoc(int docId) throws IOException {
    if (!hasAssociations) { // there are no associations at all
      return false;
    }

    if (!pi.setdoc(docId)) { // no associations for the requested document
      return false;
    }

    BytesRef associations = pi.getPayload();
    ByteArrayDataInput in = new ByteArrayDataInput(associations.bytes, associations.offset, associations.length);
    while (!in.eof()) {
      int ordinal = in.readInt();
      association.deserialize(in);
      handleAssociation(ordinal, association);
    }
    return true;
  }

