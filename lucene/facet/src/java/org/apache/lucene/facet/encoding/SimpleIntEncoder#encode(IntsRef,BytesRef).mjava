  @Override
  public void encode(IntsRef values, BytesRef buf) {
    buf.offset = buf.length = 0;
    // ensure there's enough room in the buffer
    int bytesNeeded = values.length * 4;
    if (buf.bytes.length < bytesNeeded) {
      buf.grow(bytesNeeded);
    }
    
    int upto = values.offset + values.length;
    for (int i = values.offset; i < upto; i++) {
      int value = values.ints[i];
      buf.bytes[buf.length++] = (byte) (value >>> 24);
      buf.bytes[buf.length++] = (byte) ((value >> 16) & 0xFF);
      buf.bytes[buf.length++] = (byte) ((value >> 8) & 0xFF);
      buf.bytes[buf.length++] = (byte) (value & 0xFF);
    }
  }

