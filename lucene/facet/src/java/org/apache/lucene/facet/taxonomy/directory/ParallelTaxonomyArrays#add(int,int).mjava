  /**
   * Adds the given ordinal/parent info and returns either a new instance if the
   * underlying array had to grow, or this instance otherwise.
   * <p>
   * <b>NOTE:</b> you should call this method from a thread-safe code.
   */
  ParallelTaxonomyArrays add(int ordinal, int parentOrdinal) {
    if (ordinal >= parents.length) {
      int[] newarray = ArrayUtil.grow(parents);
      newarray[ordinal] = parentOrdinal;
      return new ParallelTaxonomyArrays(newarray);
    }
    parents[ordinal] = parentOrdinal;
    return this;
  }

