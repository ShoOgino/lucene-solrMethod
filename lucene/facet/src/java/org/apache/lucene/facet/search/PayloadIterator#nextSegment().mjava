  private void nextSegment() throws IOException {
    hasMore = false;
    while (leaves.hasNext()) {
      AtomicReaderContext ctx = leaves.next();
      curDocBase = ctx.docBase;
      Fields fields = ctx.reader().fields();
      if (fields != null) {
        Terms terms = fields.terms(term.field());
        if (terms != null) {
          reuseTE = terms.iterator(reuseTE);
          if (reuseTE.seekExact(term.bytes(), true)) {
            // this class is usually used to iterate on whatever a Query matched
            // if it didn't match deleted documents, we won't receive them. if it
            // did, we should iterate on them too, therefore we pass liveDocs=null
            currentDPE = reuseTE.docsAndPositions(null, currentDPE, DocsAndPositionsEnum.FLAG_PAYLOADS);
            if (currentDPE != null && (curDocID = currentDPE.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS) {
              hasMore = true;
              break;
            }
          }
        }
      }
    }
  }

