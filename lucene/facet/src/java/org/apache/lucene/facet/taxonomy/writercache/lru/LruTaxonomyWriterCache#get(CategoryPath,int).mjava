  @Override
  public synchronized int get(CategoryPath categoryPath, int length) {
    if (length<0 || length>categoryPath.length()) {
      length = categoryPath.length();
    }
    // TODO (Facet): unfortunately, we make a copy here! we can avoid part of
    // the copy by creating a wrapper object (but this still creates a new
    // object). A better implementation of the cache would not use Java's
    // hash table, but rather some other hash table we can control, and
    // pass the length parameter into it...
    Integer res = cache.get(new CategoryPath(categoryPath, length));
    if (res==null) {
      return -1;
    }
    return res.intValue();
  }

