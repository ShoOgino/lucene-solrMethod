    @SuppressWarnings("synthetic-access")
    @Override
    public BytesRef getBytes(int docID, BytesRef ref) {
      ref = delegate.getBytes(docID, ref);
      if (ref == null || ref.length == 0) {
        return ref;
      } else {
        decoder.decode(ref, ordinals);
        
        // map the ordinals
        for (int i = 0; i < ordinals.length; i++) {
          ordinals.ints[i] = ordinalMap[ordinals.ints[i]];
        }
        
        encoder.encode(ordinals, ref);
        return ref;
      }
    }

