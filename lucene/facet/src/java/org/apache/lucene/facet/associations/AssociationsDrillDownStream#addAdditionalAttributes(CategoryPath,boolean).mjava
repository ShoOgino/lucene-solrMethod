  @Override
  protected void addAdditionalAttributes(CategoryPath cp, boolean isParent) {
    if (isParent) {
      return; // associations are not added to parent categories
    }
    
    CategoryAssociation association = associations.getAssociation(cp);
    if (association == null) {
      // it is ok to set a null association for a category - it's treated as a
      // regular category in that case.
      return;
    }
    if (payload.bytes.length < association.maxBytesNeeded()) {
      payload.grow(association.maxBytesNeeded());
    }
    output.reset(payload.bytes);
    association.serialize(output);
    payload.length = output.getPosition();
  }

