  /**
   * Adds the given ordinal/parent info and returns either a new instance if the
   * underlying array had to grow, or this instance otherwise.
   * <p>
   * <b>NOTE:</b> you should call this method from a thread-safe code.
   */
  ParentArray add(int ordinal, int parentOrdinal) {
    if (ordinal >= parentOrdinals.length) {
      int[] newarray = ArrayUtil.grow(parentOrdinals);
      newarray[ordinal] = parentOrdinal;
      return new ParentArray(newarray);
    }
    parentOrdinals[ordinal] = parentOrdinal;
    return this;
  }

