  /**
   * Search, sorting by score, and computing
   * drill down and sideways counts.
   */
  public SimpleDrillSidewaysResult search(ScoreDoc after,
                                          SimpleDrillDownQuery query, int topN) throws IOException {
    int limit = searcher.getIndexReader().maxDoc();
    if (limit == 0) {
      limit = 1; // the collector does not alow numHits = 0
    }
    topN = Math.min(topN, limit);
    TopScoreDocCollector hitCollector = TopScoreDocCollector.create(topN, after, true);
    SimpleDrillSidewaysResult r = search(query, hitCollector);
    return new SimpleDrillSidewaysResult(r.facets, hitCollector.topDocs());
  }

