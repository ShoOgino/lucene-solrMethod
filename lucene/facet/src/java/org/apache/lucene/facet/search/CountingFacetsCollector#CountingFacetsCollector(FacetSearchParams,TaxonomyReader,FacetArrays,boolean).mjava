  public CountingFacetsCollector(FacetSearchParams fsp, TaxonomyReader taxoReader, FacetArrays facetArrays, 
      boolean useDirectSource) {
    assert facetArrays.arrayLength >= taxoReader.getSize() : "too small facet array";
    assert assertParams(fsp) == null : assertParams(fsp);
    
    this.fsp = fsp;
    this.taxoReader = taxoReader;
    this.facetArrays = facetArrays;
    this.counts = facetArrays.getIntArray();
    this.facetsField = fsp.indexingParams.getCategoryListParams(null).field;
    this.useDirectSource = useDirectSource;
  }

