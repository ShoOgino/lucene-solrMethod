  private boolean addLabel(HashArray a, CategoryPath label, int prefixLen,
                            int hash, int ordinal) {
    int index = CompactLabelToOrdinal.indexFor(hash, a.offsets.length);
    int offset = a.offsets[index];

    if (offset == 0) {
      a.offsets[index] = this.labelRepository.length();
      try {
        label.serializeAppendTo(prefixLen, this.labelRepository);
      } catch (IOException e) {
        // can't happen - LabelRepository.append() never throws an
        // exception
      }
      a.cids[index] = ordinal;
      return true;
    }

    return false;
  }

