  /**
   * Initializes with the given {@link FacetIndexingParams}. Returns the proper
   * {@link DocValuesFormat} for the fields that are returned by
   * {@link FacetIndexingParams#getAllCategoryListParams()}.
   */
  public Facet45Codec(FacetIndexingParams fip) {
    if (fip.getPartitionSize() != Integer.MAX_VALUE) {
      throw new IllegalArgumentException("this Codec does not support partitions");
    }
    this.facetFields = new HashSet<String>();
    for (CategoryListParams clp : fip.getAllCategoryListParams()) {
      facetFields.add(clp.field);
    }
  }

