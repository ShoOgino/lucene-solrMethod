  /**
   * prepare most of the work needed for a two-phase commit.
   * See {@link IndexWriter#prepareCommit}.
   */
  @Override
  public synchronized void prepareCommit() throws IOException {
    ensureOpen();
    indexWriter.setCommitData(combinedCommitData(indexWriter.getCommitData()));
    indexWriter.prepareCommit();
  }

