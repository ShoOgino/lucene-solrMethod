  public StandardFacetsAccumulator(FacetSearchParams searchParams, IndexReader indexReader,
      TaxonomyReader taxonomyReader, IntArrayAllocator intArrayAllocator,
      FloatArrayAllocator floatArrayAllocator) {
    
    super(searchParams,indexReader,taxonomyReader);
    int realPartitionSize = intArrayAllocator == null || floatArrayAllocator == null 
              ? PartitionsUtils.partitionSize(searchParams, taxonomyReader) : -1; // -1 if not needed.
    this.intArrayAllocator = intArrayAllocator != null 
        ? intArrayAllocator
        // create a default one if null was provided
        : new IntArrayAllocator(realPartitionSize, 1);
    this.floatArrayAllocator = floatArrayAllocator != null 
        ? floatArrayAllocator
        // create a default one if null provided
        : new FloatArrayAllocator(realPartitionSize, 1);
    // can only be computed later when docids size is known
    isUsingComplements = false;
    partitionSize = PartitionsUtils.partitionSize(searchParams, taxonomyReader);
    maxPartitions = (int) Math.ceil(this.taxonomyReader.getSize() / (double) partitionSize);
    accumulateGuard = new Object();
  }

