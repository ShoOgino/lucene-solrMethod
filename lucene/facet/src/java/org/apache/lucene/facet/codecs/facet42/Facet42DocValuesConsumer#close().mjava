  @Override
  public void close() throws IOException {
    boolean success = false;
    try {
      out.writeVInt(-1); // write EOF marker
      success = true;
    } finally {
      if (success) {
        IOUtils.close(out);
      } else {
        IOUtils.closeWhileHandlingException(out);
      }
    }
  }

