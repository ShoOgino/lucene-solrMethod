    @Override
    public HashMap<String,BytesRef> finish() {
      try {
        encoder.close();
      } catch (IOException e) {
        // shouldn't happen as we're writing to byte[]
        throw new RuntimeException("unexpected exception", e);
      }
      HashMap<String,BytesRef> result = new HashMap<String,BytesRef>();
      result.put(name, new BytesRef(ubaos.toByteArray(), ubaos.getStartPos(), ubaos.length()));
      return result;
    }

