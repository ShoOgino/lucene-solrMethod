    @Override
    public void encode(int ordinal) {
      final String name = PartitionsUtils.partitionNameByOrdinal(indexingParams, categoryListParams, ordinal);
      IntEncoder encoder = partitionEncoder.get(name);
      if (encoder == null) {
        encoder = categoryListParams.createEncoder();
        final UnsafeByteArrayOutputStream ubaos = new UnsafeByteArrayOutputStream();        
        encoder.reInit(ubaos);
        partitionEncoder.put(name, encoder);
        partitionBytes.put(name, ubaos);
      }
      try {
        encoder.encode(ordinal % partitionSize);
      } catch (IOException e) {
        // shouldn't happen as we're writing to byte[]
        throw new RuntimeException("unexpected exception", e);
      }
    }

