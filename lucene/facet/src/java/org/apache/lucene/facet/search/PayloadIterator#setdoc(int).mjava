  /**
   * Skip forward to document docId. Return true if this document exists and
   * has any payload.
   * <P>
   * Users should call this method with increasing docIds, and implementations
   * can assume that this is the case.
   */
  public boolean setdoc(int docId) throws IOException {
    if (!hasMore) {
      return false;
    }

    // re-basing docId->localDocID is done fewer times than currentDoc->globalDoc
    int localDocID = docId - curDocBase;
    
    if (curDocID > localDocID) {
      // document does not exist
      return false;
    }
    
    if (curDocID < localDocID) {
      // look for the document either in that segment, or others
      while (hasMore && (curDocID = currentDPE.advance(localDocID)) == DocIdSetIterator.NO_MORE_DOCS) {
        nextSegment(); // also updates curDocID
        localDocID = docId - curDocBase;
        // nextSegment advances to nextDoc, so check if we still need to advance
        if (curDocID >= localDocID) {
          break;
        }
      }
      
      // we break from the above loop when:
      // 1. we iterated over all segments (hasMore=false)
      // 2. current segment advanced to a doc, either requested or higher
      if (!hasMore || curDocID != localDocID) {
        return false;
      }
    }

    // we're on the document
    assert currentDPE.freq() == 1 : "expecting freq=1 (got " + currentDPE.freq() + ") term=" + term + " doc=" + (curDocID + curDocBase);
    int pos = currentDPE.nextPosition();
    assert pos != -1 : "no positions for term=" + term + " doc=" + (curDocID + curDocBase);
    data = currentDPE.getPayload();
    return data != null;
  }

