  @Override
  public DocValues docValues(String field) throws IOException {
    Term term = fieldTerms.get(field);
    if (term == null) {
      return super.docValues(field);
    } else {
      DocsAndPositionsEnum dpe = null;
      Fields fields = fields();
      if (fields != null) {
        Terms terms = fields.terms(term.field());
        if (terms != null) {
          TermsEnum te = terms.iterator(null); // no use for reusing
          if (te.seekExact(term.bytes(), true)) {
            // we're not expected to be called for deleted documents
            dpe = te.docsAndPositions(null, null, DocsAndPositionsEnum.FLAG_PAYLOADS);
          }
        }
      }
      // we shouldn't return null, even if the term does not exist or has no
      // payloads, since we already marked the field as having DocValues.
      return new PayloadMigratingDocValues(dpe);
    }
  }

