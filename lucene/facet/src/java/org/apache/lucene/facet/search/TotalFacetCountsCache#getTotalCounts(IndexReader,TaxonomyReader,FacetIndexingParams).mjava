  /**
   * Get the total facet counts for a reader/taxonomy pair and facet indexing
   * parameters. If not in cache, computed here and added to the cache for later
   * use.
   * 
   * @param indexReader
   *          the documents index
   * @param taxonomy
   *          the taxonomy index
   * @param facetIndexingParams
   *          facet indexing parameters
   * @return the total facet counts.
   */
  public TotalFacetCounts getTotalCounts(IndexReader indexReader, TaxonomyReader taxonomy,
      FacetIndexingParams facetIndexingParams) throws IOException {
    // create the key
    TFCKey key = new TFCKey(indexReader, taxonomy, facetIndexingParams);
    // it is important that this call is not synchronized, so that available TFC 
    // would not wait for one that needs to be computed.  
    TotalFacetCounts tfc = cache.get(key);
    if (tfc != null) {
      markRecentlyUsed(key); 
      return tfc;
    }
    return computeAndCache(key);
  }

