  /**
   * Returns the {@link CachedOrds} relevant to the given
   * {@link AtomicReaderContext}, or {@code null} if there is no
   * {@link BinaryDocValues} in this reader for the requested
   * {@link CategoryListParams#field}.
   */
  public static synchronized CachedOrds getCachedOrds(AtomicReaderContext context, CategoryListParams clp) throws IOException {
    BinaryDocValues dv = context.reader().getBinaryDocValues(clp.field);
    if (dv == null) {
      return null;
    }
    Map<String,CachedOrds> fieldCache = ordsCache.get(context.reader().getCoreCacheKey());
    if (fieldCache == null) {
      fieldCache = new HashMap<String,OrdinalsCache.CachedOrds>();
      ordsCache.put(context.reader().getCoreCacheKey(), fieldCache);
    }
    CachedOrds co = fieldCache.get(clp.field);
    if (co == null) {
      co = new CachedOrds(dv, context.reader().maxDoc(), clp);
      fieldCache.put(clp.field, co);
    }
    return co;
  }

