    @Override
    public BytesRef getBytes(int docID, BytesRef ref) {
      if (curDocID > docID) {
        // document does not exist
        ref.length = 0;
        return ref;
      }
      
      try {
        if (curDocID < docID) {
          curDocID = dpe.advance(docID);
          if (curDocID != docID) { // requested document does not have a payload
            ref.length = 0;
            return ref;
          }
        }
        
        // we're on the document
        dpe.nextPosition();
        ref.copyBytes(dpe.getPayload());
        return ref;
      } catch (IOException e) {
        throw new RuntimeException(e);
      }
    }

