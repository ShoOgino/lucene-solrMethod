  private void addGroupField(Document doc, String groupField, String value, DocValuesType valueType) {
    doc.add(new TextField(groupField, value, Field.Store.NO));
    Field valuesField = null;
    switch(valueType) {
      case BINARY:
        valuesField = new BinaryDocValuesField(groupField + "_dv", new BytesRef(value));
        break;
      case SORTED:
        valuesField = new SortedDocValuesField(groupField + "_dv", new BytesRef(value));
        break;
      default:
        fail("unhandled type");
    }
    doc.add(valuesField);
  }

