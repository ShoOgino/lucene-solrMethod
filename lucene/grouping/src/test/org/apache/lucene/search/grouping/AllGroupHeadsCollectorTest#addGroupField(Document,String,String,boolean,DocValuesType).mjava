  // nocommit: isnt this method elsehwere in this test? either deja-vu or i fixed one just like it a few hundred lines back
  private void addGroupField(Document doc, String groupField, String value, boolean canUseIDV, DocValuesType valueType) {
    doc.add(new TextField(groupField, value, Field.Store.YES));
    if (canUseIDV) {
      Field valuesField = null;
      switch(valueType) {
      case BINARY:
        valuesField = new StraightBytesDocValuesField(groupField + "_dv", new BytesRef(value));
        break;
      case SORTED:
        valuesField = new SortedBytesDocValuesField(groupField + "_dv", new BytesRef(value));
        break;
      default:
        fail("unhandled type");
      }
      doc.add(valuesField);
    }
  }

