  private void addField(Document doc, String field, String value, DocValuesType type) {
    doc.add(new StringField(field, value, Field.Store.YES));
    if (type == null) {
      return;
    }
    String dvField = field + "_dv";

    Field valuesField = null;
    switch (type) {
      case NUMERIC:
        valuesField = new PackedLongDocValuesField(dvField, Integer.parseInt(value));
        break;
      /* nocommit: case FLOAT_64:
        valuesField = new DoubleDocValuesField(dvField, Double.parseDouble(value));
        break; */
      case BINARY:
        valuesField = new StraightBytesDocValuesField(dvField, new BytesRef(value));
        break;
      case SORTED:
        valuesField = new SortedBytesDocValuesField(dvField, new BytesRef(value));
        break;
    }
    doc.add(valuesField);
  }

