    protected int getOrdForDoc(int doc) throws IOException {
      int curDocID = groupIndex.docID();
      if (curDocID < doc) {
        curDocID = groupIndex.advance(doc);
      }

      if (curDocID == doc) {
        return groupIndex.ordValue();
      } else {
        return -1;
      }
    }

