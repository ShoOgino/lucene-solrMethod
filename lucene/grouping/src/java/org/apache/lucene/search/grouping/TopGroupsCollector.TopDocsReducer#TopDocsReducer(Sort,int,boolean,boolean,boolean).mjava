    TopDocsReducer(Sort withinGroupSort,
                   int maxDocsPerGroup, boolean getScores, boolean getMaxScores, boolean fillSortFields) {
      this.needsScores = getScores || getMaxScores || withinGroupSort.needsScores();
      this.supplier = withinGroupSort == Sort.RELEVANCE ?
          () -> TopScoreDocCollector.create(maxDocsPerGroup) :
          () -> TopFieldCollector.create(withinGroupSort, maxDocsPerGroup, fillSortFields, getScores, getMaxScores);
    }

