      @Override
      public int compare(int compIDX, int doc) throws IOException {
        if (sortsIndex[compIDX].docID() < doc) {
          sortsIndex[compIDX].advance(doc);
        }
        if (sortOrds[compIDX] < 0) {
          // The current segment doesn't contain the sort value we encountered before. Therefore the ord is negative.
          final BytesRef term;
          if (sortsIndex[compIDX].docID() == doc) {
            term = sortsIndex[compIDX].binaryValue();
          } else {
            term = new BytesRef(BytesRef.EMPTY_BYTES);
          }
          return sortValues[compIDX].get().compareTo(term);
        } else {
          int ord;
          if (sortsIndex[compIDX].docID() == doc) {
            ord = sortsIndex[compIDX].ordValue();
          } else {
            ord = -1;
          }
          return sortOrds[compIDX] - ord;
        }
      }

