  public synchronized void incRef(Collection<String> fileNames) throws IOException {
    for(String fileName : fileNames) {

      if (pending.contains(fileName)) {
        throw new IllegalStateException("cannot incRef file \"" + fileName + "\": it is pending delete");
      }

      assert slowFileExists(dir, fileName): "file " + fileName + " does not exist!";

      Integer curCount = refCounts.get(fileName);
      if (curCount == null) {
        refCounts.put(fileName, 1);
      } else {
        refCounts.put(fileName, curCount.intValue() + 1);
      }
    }
  }

