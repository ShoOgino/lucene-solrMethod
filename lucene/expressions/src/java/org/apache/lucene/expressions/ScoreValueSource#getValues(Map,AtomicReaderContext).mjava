  /**
   * <code>context</code> must contain a key "scorer" which is a {@link Scorer}.
   */
  @Override
  public FunctionValues getValues(Map context, AtomicReaderContext readerContext) throws IOException {
    Scorer v = (Scorer) context.get("scorer");
    if (v == null) {
      throw new IllegalStateException("Expressions referencing the score can only be used for sorting");
    }
    return new ScoreFunctionValues(this, v);
  }

