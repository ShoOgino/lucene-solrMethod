  /**
   * <code>context</code> must contain a key "scorer" which is a {@link FunctionValues}.
   */
  @Override
  public FunctionValues getValues(Map context, AtomicReaderContext readerContext) throws IOException {
    FunctionValues v = (FunctionValues) context.get("scorer");
    if (v == null) {
      throw new IllegalStateException("Expressions referencing the score can only be used for sorting");
    }
    return v;
  }

