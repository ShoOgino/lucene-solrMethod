  private void addRawDocument(byte[] buf, int off, int len) throws IOException {
    endWithPreviousDocument();
    if (bufferedDocs.length >= chunkSize) {
      flush();
    }
    bufferedDocs.writeBytes(buf, off, len);
    ++numBufferedDocs;
  }

