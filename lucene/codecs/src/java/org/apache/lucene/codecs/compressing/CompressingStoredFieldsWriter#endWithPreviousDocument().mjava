  private void endWithPreviousDocument() throws IOException {
    if (numBufferedDocs > 0) {
      assert bufferedDocs.length > 0;
      if (numBufferedDocs == endOffsets.length) {
        endOffsets = ArrayUtil.grow(endOffsets);
      }
      endOffsets[numBufferedDocs - 1] = bufferedDocs.length;
    }
  }

