    private final void maybeSeek() throws IOException {
      if (seekPending) {
        if (pendingFP != lastBlockFP) {
          // need new block
          in.seek(pendingFP);
          blockReader.seek(pendingFP);
          lastBlockFP = pendingFP;
          blockSize = blockReader.readBlock();
        }
        upto = pendingUpto;

        // TODO: if we were more clever when writing the
        // index, such that a seek point wouldn't be written
        // until the int encoder "committed", we could avoid
        // this (likely minor) inefficiency:

        // This is necessary for int encoders that are
        // non-causal, ie must see future int values to
        // encode the current ones.
        while(upto >= blockSize) {
          upto -= blockSize;
          lastBlockFP = in.getFilePointer();
          blockSize = blockReader.readBlock();
        }
        seekPending = false;
      }
    }

