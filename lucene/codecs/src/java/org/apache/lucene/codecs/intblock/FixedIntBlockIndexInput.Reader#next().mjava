    @Override
    public int next() throws IOException {
      if (seekPending) {
        // Seek & load new block
        in.seek(pendingFP);
        lastBlockFP = pendingFP;
        blockReader.readBlock();
        seekPending = false;
      } else if (upto == blockSize) {
        // Load new block
        lastBlockFP = in.getFilePointer();
        blockReader.readBlock();
        upto = 0;
      }
      return pending[upto++];
    }

