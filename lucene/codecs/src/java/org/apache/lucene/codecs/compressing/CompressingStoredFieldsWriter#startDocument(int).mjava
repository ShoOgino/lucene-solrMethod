  @Override
  public void startDocument(int numStoredFields) throws IOException {
    endWithPreviousDocument();
    if (bufferedDocs.length >= chunkSize) {
      flush();
    }
    bufferedDocs.writeVInt(numStoredFields);
    ++numBufferedDocs;
  }

