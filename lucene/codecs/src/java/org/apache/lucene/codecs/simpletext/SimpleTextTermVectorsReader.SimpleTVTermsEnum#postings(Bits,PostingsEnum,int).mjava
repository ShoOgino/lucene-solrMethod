    @Override
    public PostingsEnum postings(Bits liveDocs, PostingsEnum reuse, int flags) throws IOException {

      if (PostingsEnum.requiresPositions(flags)) {
        SimpleTVPostings postings = current.getValue();
        if (postings.positions == null && postings.startOffsets == null) {
          return null;
        }
        // TODO: reuse
        SimpleTVPostingsEnum e = new SimpleTVPostingsEnum();
        e.reset(liveDocs, postings.positions, postings.startOffsets, postings.endOffsets, postings.payloads);
        return e;
      }

      // TODO: reuse
      SimpleTVDocsEnum e = new SimpleTVDocsEnum();
      e.reset(liveDocs, (flags & PostingsEnum.FREQS) == 0 ? 1 : current.getValue().freq);
      return e;
    }

