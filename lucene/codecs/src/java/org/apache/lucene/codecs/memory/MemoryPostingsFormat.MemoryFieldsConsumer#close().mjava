    @Override
    public void close() throws IOException {
      if (closed) {
        return;
      }
      closed = true;
      
      // EOF marker:
      try (IndexOutput out = this.out) {
        out.writeVInt(0);
        CodecUtil.writeFooter(out);
      }
    }

