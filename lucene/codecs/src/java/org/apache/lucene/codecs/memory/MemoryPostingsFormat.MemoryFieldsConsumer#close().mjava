    @Override
    public void close() throws IOException {
      // EOF marker:
      try {
        out.writeVInt(0);
        CodecUtil.writeFooter(out);
      } finally {
        out.close();
      }
    }

