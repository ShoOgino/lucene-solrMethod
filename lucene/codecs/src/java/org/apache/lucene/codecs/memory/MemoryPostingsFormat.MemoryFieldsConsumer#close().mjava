    @Override
    public void close() throws IOException {
      // EOF marker:
      try {
        out.writeVInt(0);
      } finally {
        out.close();
      }
    }

