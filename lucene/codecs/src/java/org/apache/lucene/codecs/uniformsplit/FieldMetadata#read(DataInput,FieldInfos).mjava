  public static FieldMetadata read(DataInput input, FieldInfos fieldInfos) throws IOException {
    int fieldId = input.readVInt();
    FieldMetadata stats = new FieldMetadata(fieldInfos.fieldInfo(fieldId), 0, false);

    stats.numTerms = input.readVInt();
    stats.sumDocFreq = input.readVInt();

    stats.sumTotalTermFreq = stats.sumDocFreq;
    if (stats.fieldInfo.getIndexOptions().compareTo(IndexOptions.DOCS_AND_FREQS) >= 0) {
      stats.sumTotalTermFreq += input.readVInt();
      assert stats.sumTotalTermFreq >= stats.sumDocFreq : "sumTotalFQ: " + stats.sumTotalTermFreq + " sumDocFQ: " + stats.sumDocFreq;
    }

    stats.docCount = input.readVInt();

    stats.dictionaryStartFP = input.readVLong();
    stats.firstBlockStartFP = input.readVLong();
    stats.lastBlockStartFP = input.readVLong();

    int len = input.readVInt();
    BytesRef lastTerm = new BytesRef(len);
    if (len > 0) {
      input.readBytes(lastTerm.bytes, 0, len);
      lastTerm.length = len;
    }
    stats.setLastTerm(lastTerm);
    return stats;
  }

