  /**
   * @param indexInput {@link IndexInput} must be positioned to the fields metadata
   *                   details by calling {@link #seekFieldsMetadata(IndexInput)} before this call.
   */
  protected static Collection<FieldMetadata> parseFieldsMetadata(IndexInput indexInput, FieldInfos fieldInfos) throws IOException {
    Collection<FieldMetadata> fieldMetadataCollection = new ArrayList<>();
    int fieldsNumber = indexInput.readVInt();
    for (int i = 0; i < fieldsNumber; i++) {
      fieldMetadataCollection.add(FieldMetadata.read(indexInput, fieldInfos));
    }
    return fieldMetadataCollection;
  }

