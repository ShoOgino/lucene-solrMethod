  @Override
  public SortedDocValues getSorted(FieldInfo field) throws IOException {
    final SortedEntry entry = sorteds.get(field.number);
    SortedRawValues instance;
    synchronized (this) {
      instance = sortedInstances.get(field.number);
      if (instance == null) {
        // Lazy load
        instance = loadSorted(field);
        sortedInstances.put(field.number, instance);
      }
    }
    final NumericDocValues docToOrd = instance.docToOrd;
    final BinaryDocValues values = getBinary(field);

    return new SortedDocValues() {

      @Override
      public int getOrd(int docID) {
        return (int) docToOrd.get(docID);
      }

      @Override
      public BytesRef lookupOrd(int ord) {
        return values.get(ord);
      }

      @Override
      public int getValueCount() {
        return entry.values.count;
      }

      // Leave lookupTerm to super's binary search

      // Leave termsEnum to super
    };
  }

