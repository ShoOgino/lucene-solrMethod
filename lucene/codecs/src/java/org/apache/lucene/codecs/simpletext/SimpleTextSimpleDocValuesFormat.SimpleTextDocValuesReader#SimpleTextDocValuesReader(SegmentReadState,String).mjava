    public SimpleTextDocValuesReader(SegmentReadState state, String ext) throws IOException {
      //System.out.println("dir=" + state.directory + " seg=" + state.segmentInfo.name + " ext=" + ext);
      data = state.directory.openInput(IndexFileNames.segmentFileName(state.segmentInfo.name, state.segmentSuffix, ext), state.context);
      maxDoc = state.segmentInfo.getDocCount();
      while(true) {
        readLine();
        //System.out.println("READ field=" + scratch.utf8ToString());
        if (scratch.equals(END)) {
          break;
        }
        assert startsWith(FIELD) : scratch.utf8ToString();
        String fieldName = stripPrefix(FIELD);
        //System.out.println("  field=" + fieldName);
        FieldInfo fieldInfo = state.fieldInfos.fieldInfo(fieldName);
        assert fieldInfo != null;

        OneField field = new OneField();
        fields.put(fieldName, field);

        field.fieldInfo = fieldInfo;
        //System.out.println("  field=" + fieldName);

        // nocommit hack hack hack!!:
        DocValues.Type dvType = ext.equals("slen") ? DocValues.Type.FIXED_INTS_8 : fieldInfo.getDocValuesType();
        assert dvType != null;
        if (DocValues.isNumber(dvType) || DocValues.isFloat(dvType)) {
          readLine();
          assert startsWith(MINVALUE): "got " + scratch.utf8ToString() + " field=" + fieldName + " ext=" + ext;
          field.minValue = Long.parseLong(stripPrefix(MINVALUE));
          readLine();
          assert startsWith(PATTERN);
          field.pattern = stripPrefix(PATTERN);
          field.dataStartFilePointer = data.getFilePointer();
          data.seek(data.getFilePointer() + (1+field.pattern.length()) * maxDoc);
        } else if (DocValues.isBytes(dvType)) {
          readLine();
          assert startsWith(FIXEDLENGTH);
          field.fixedLength = Boolean.parseBoolean(stripPrefix(FIXEDLENGTH));
          readLine();
          assert startsWith(MAXLENGTH);
          field.maxLength = Integer.parseInt(stripPrefix(MAXLENGTH));
          readLine();
          assert startsWith(PATTERN);
          field.pattern = stripPrefix(PATTERN);
          field.dataStartFilePointer = data.getFilePointer();
          data.seek(data.getFilePointer() + (9+field.pattern.length()+field.maxLength) * maxDoc);
        } else if (DocValues.isSortedBytes(dvType)) {
          readLine();
          assert startsWith(NUMVALUES);
          field.numValues = Integer.parseInt(stripPrefix(NUMVALUES));
          readLine();
          assert startsWith(FIXEDLENGTH);
          field.fixedLength = Boolean.parseBoolean(stripPrefix(FIXEDLENGTH));
          readLine();
          assert startsWith(MAXLENGTH);
          field.maxLength = Integer.parseInt(stripPrefix(MAXLENGTH));
          readLine();
          assert startsWith(PATTERN);
          field.pattern = stripPrefix(PATTERN);
          readLine();
          assert startsWith(ORDPATTERN);
          field.ordPattern = stripPrefix(ORDPATTERN);
          field.dataStartFilePointer = data.getFilePointer();
          data.seek(data.getFilePointer() + (9+field.pattern.length()+field.maxLength) * field.numValues + (1+field.ordPattern.length())*maxDoc);
        } else {
          throw new AssertionError();
        }
      }

      // We should only be called from above if at least one
      // field has DVs:
      assert !fields.isEmpty();
    }

