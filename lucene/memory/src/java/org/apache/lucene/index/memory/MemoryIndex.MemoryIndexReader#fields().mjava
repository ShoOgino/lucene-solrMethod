    @Override
    public Fields fields() {
      Map<String, Info> filteredFields = fields.entrySet().stream()
          .filter(entry ->  entry.getValue().numTokens > 0)
          .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue,
              (u,v) -> { throw new IllegalStateException(String.format(Locale.ROOT, "Duplicate key %s", u));},
              TreeMap::new
          ));
      return new MemoryFields(filteredFields );
    }

