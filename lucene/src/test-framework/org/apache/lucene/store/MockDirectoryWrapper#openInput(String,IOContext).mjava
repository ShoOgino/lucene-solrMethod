  @Override
  public synchronized IndexInput openInput(String name, IOContext context) throws IOException {
    maybeYield();
    if (!delegate.fileExists(name))
      throw new FileNotFoundException(name);

    // cannot open a file for input if it's still open for
    // output, except for segments.gen and segments_N
    if (openFilesForWrite.contains(name) && !name.startsWith("segments")) {
      throw fillOpenTrace(new IOException("MockDirectoryWrapper: file \"" + name + "\" is still open for writing"), name, false);
    }

    // nocommit - randomize IOContext here?
    IndexInput ii = new MockIndexInputWrapper(this, name, delegate.openInput(name, context));
    addFileHandle(ii, name, true);
    return ii;
  }

