  private void doRandomOptimize() throws IOException {
    final int segCount = w.getSegmentCount();
    if (r.nextBoolean() || segCount == 0) {
      // full optimize
      w.optimize();
    } else {
      // partial optimize
      final int limit = _TestUtil.nextInt(r, 1, segCount);
      w.optimize(limit);
      assert w.getSegmentCount() <= limit: "limit=" + limit + " actual=" + w.getSegmentCount();
    }
  }

