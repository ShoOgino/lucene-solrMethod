  /**
   * Adds a Document.
   * @see IndexWriter#addDocument(Document)
   */
  public void addDocument(Document doc) throws IOException {
    if (doDocValues) {
      randomPerDocFieldValues(r, doc);
    }
    w.addDocument(doc);
    
    maybeCommit();
  }

