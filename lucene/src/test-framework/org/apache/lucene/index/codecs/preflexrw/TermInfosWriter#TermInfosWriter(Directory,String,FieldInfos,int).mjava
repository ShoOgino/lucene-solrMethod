  TermInfosWriter(Directory directory, String segment, FieldInfos fis,
                  int interval)
       throws IOException {
    initialize(directory, segment, fis, interval, false);
    boolean success = false;
    try {
    other = new TermInfosWriter(directory, segment, fis, interval, true);
    other.other = this;
      success = true;
    } finally {
      if (!success) {
        try {
          IOUtils.closeWhileHandlingException(output);
        } catch (IOException e) {
          // cannot happen since we suppress exceptions
          throw new RuntimeException(e);
        }

        try {
          directory.deleteFile(IndexFileNames.segmentFileName(segment, "",
              (isIndex ? PreFlexCodec.TERMS_INDEX_EXTENSION
                  : PreFlexCodec.TERMS_EXTENSION)));
        } catch (IOException ignored) {
        }
      }
    }
  }

