  // can we make this more evil?
  @Override
  public PerDocConsumer docsConsumer(PerDocWriteState state) throws IOException {
    if (useSepDocValues) {
      return new SepDocValuesConsumer(state);
    } else {
      return new DefaultDocValuesConsumer(state);
    }
  }

