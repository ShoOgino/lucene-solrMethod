    @Override
    public synchronized String getFieldCodec(String name) {
      Codec codec = previousMappings.get(name);
      if (codec == null) {
        codec = knownCodecs.get(Math.abs(perFieldSeed ^ name.hashCode()) % knownCodecs.size());
        if (codec instanceof SimpleTextCodec && perFieldSeed % 5 != 0) {
          // make simpletext rarer, choose again
          codec = knownCodecs.get(Math.abs(perFieldSeed ^ name.toUpperCase(Locale.ENGLISH).hashCode()) % knownCodecs.size());
        }
        previousMappings.put(name, codec);
      }
      return codec.name;
    }

