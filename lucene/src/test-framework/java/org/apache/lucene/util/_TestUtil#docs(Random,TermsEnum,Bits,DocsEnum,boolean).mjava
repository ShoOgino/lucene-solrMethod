  // Returns a DocsEnum from a positioned TermsEnum, but
  // randomly sometimes uses a DocsAndFreqsEnum, DocsAndPositionsEnum.
  public static DocsEnum docs(Random random, TermsEnum termsEnum, Bits liveDocs, DocsEnum reuse, boolean needsFreqs) throws IOException {
    if (random.nextBoolean()) {
      if (random.nextBoolean()) {
        // TODO: cast re-use to D&PE if we can...?
        final DocsAndPositionsEnum docsAndPositions = termsEnum.docsAndPositions(liveDocs, null);
        if (docsAndPositions != null) {
          return docsAndPositions;
        }
      }
      final DocsEnum docsAndFreqs = termsEnum.docs(liveDocs, null, true);
      if (docsAndFreqs != null) {
        return docsAndFreqs;
      }
    }
    return termsEnum.docs(liveDocs, null, needsFreqs);
  }

