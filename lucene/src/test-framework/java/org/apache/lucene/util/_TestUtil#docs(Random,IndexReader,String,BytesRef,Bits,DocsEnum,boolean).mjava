  // Returns a DocsEnum, but randomly sometimes uses a
  // DocsAndFreqsEnum, DocsAndPositionsEnum.  Returns null
  // if field/term doesn't exist:
  public static DocsEnum docs(Random random, IndexReader r, String field, BytesRef term, Bits liveDocs, DocsEnum reuse, boolean needsFreqs) throws IOException {
    final Terms terms = MultiFields.getTerms(r, field);
    if (terms == null) {
      return null;
    }
    final TermsEnum termsEnum = terms.iterator(null);
    if (!termsEnum.seekExact(term, random.nextBoolean())) {
      return null;
    }
    if (random.nextBoolean()) {
      if (random.nextBoolean()) {
        // TODO: cast re-use to D&PE if we can...?
        final DocsAndPositionsEnum docsAndPositions = termsEnum.docsAndPositions(liveDocs, null);
        if (docsAndPositions != null) {
          return docsAndPositions;
        }
      }
      final DocsEnum docsAndFreqs = termsEnum.docs(liveDocs, reuse, true);
      if (docsAndFreqs != null) {
        return docsAndFreqs;
      }
    }
    return termsEnum.docs(liveDocs, reuse, needsFreqs);
  }

