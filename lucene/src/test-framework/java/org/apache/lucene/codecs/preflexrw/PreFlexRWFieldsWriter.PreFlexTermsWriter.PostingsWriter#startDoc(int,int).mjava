      @Override
      public void startDoc(int docID, int termDocFreq) throws IOException {
        //System.out.println("    w doc=" + docID);

        final int delta = docID - lastDocID;
        if (docID < 0 || (df > 0 && delta <= 0)) {
          throw new CorruptIndexException("docs out of order (" + docID + " <= " + lastDocID + " )");
        }

        if ((++df % termsOut.skipInterval) == 0) {
          skipListWriter.setSkipData(lastDocID, storePayloads, lastPayloadLength);
          skipListWriter.bufferSkip(df);
        }

        lastDocID = docID;

        assert docID < totalNumDocs: "docID=" + docID + " totalNumDocs=" + totalNumDocs;

        if (omitTF) {
          freqOut.writeVInt(delta);
        } else {
          final int code = delta << 1;
          if (termDocFreq == 1) {
            freqOut.writeVInt(code|1);
          } else {
            freqOut.writeVInt(code);
            freqOut.writeVInt(termDocFreq);
          }
        }
        lastPosition = 0;
      }

