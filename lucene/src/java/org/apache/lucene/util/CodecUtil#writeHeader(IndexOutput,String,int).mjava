  public static IndexOutput writeHeader(IndexOutput out, String codec, int version)
    throws IOException {
    final long start = out.getFilePointer();
    out.writeInt(CODEC_MAGIC);
    out.writeString(codec);
    out.writeInt(version);

    // We require this so we can easily pre-compute header length
    if (out.getFilePointer()-start != codec.length()+9) {
      throw new IllegalArgumentException("codec must be simple ASCII, less than 128 characters in length [got " + codec + "]");
    }

    return out;
  }

