  /**
   * Creates an array with content retrieved from the given IndexInput.
   * @param in       an IndexInput, positioned at the start of Packed64-content.
   * @param valueCount  the number of elements.
   * @param bitsPerValue the number of bits available for any given value.
   * @throws java.io.IOException if the values for the backing array could not
   *                             be retrieved.
   */
  public Packed32(IndexInput in, int valueCount, int bitsPerValue)
                                                            throws IOException {
    super(valueCount, bitsPerValue);
    int size = size(bitsPerValue, valueCount);
    blocks = new int[size + 1]; // +1 due to non-conditional tricks
    // TODO: find a faster way to bulk-read ints...
    for(int i = 0 ; i < size ; i++) {
      blocks[i] = in.readInt();
    }
    if (size % 2 == 1) {
      in.readInt(); // Align to long
    }
    updateCached();
  }

