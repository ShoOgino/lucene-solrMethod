  @Override
  public long get(int index) throws IOException {
    assert index < valueCount : "ord must be less than valueCount";
    if (index < position) {
      pendingBitsLeft = 0;
      final long bitsToSkip = (((long) bitsPerValue) * (long) index);
      final long skip = bitsToSkip - pendingBitsLeft;
      final long closestByte = (skip >> 6) << 3;
      in.seek(startPointer + closestByte);
      pending = in.readLong();
      pendingBitsLeft = 64 - (int) (skip % 64);
      position = index - 1;
      return currentValue = next();
    } else if (index == position) {
      return currentValue;
    }
    return advance(index);
  }

