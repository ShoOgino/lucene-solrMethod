  @Override
  public void finish() throws IOException {
    while (written < valueCount) {
      add(0L); // Auto flush
    }

    if (pendingBitPos != 64) {
      out.writeLong(pending);
    }
  }

