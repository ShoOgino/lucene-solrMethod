  private void push() throws IOException {

    FST.Arc<T> arc = arcs[current.length];
    assert arc != null;

    while(true) {
      grow();
      
      current.bytes[current.length] = (byte) arc.label;
      appendOutput(arc.output);
      //System.out.println("    push: append label=" + ((char) arc.label) + " output=" + fst.outputs.outputToString(arc.output));
      current.length++;
      grow();

      if (!fst.hasArcs(arc.target)) {
        break;
      }

      if (arc.isFinal()) {
        appendFinalOutput(arc.nextFinalOutput);
        lastFinal = true;
        return;
      }

      arc = fst.readFirstArc(arc.target, getArc(current.length));
    }
    result.output = output[current.length-1];
  }

