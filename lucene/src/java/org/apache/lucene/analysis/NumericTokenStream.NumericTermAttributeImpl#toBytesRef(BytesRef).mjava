    public int toBytesRef(BytesRef bytes) {
      try {
        assert ts.valSize == 64 || ts.valSize == 32;
        return (ts.valSize == 64) ? 
          NumericUtils.longToPrefixCoded(ts.value, ts.shift, bytes) :
          NumericUtils.intToPrefixCoded((int) ts.value, ts.shift, bytes);
      } catch (IllegalArgumentException iae) {
        // return empty token before first
        bytes.length = 0;
        return 0;
      }
    }

