    /**
     * Resets the internal {@link DocumentsWriterPerThread} with the given one. 
     * if the given DWPT is <code>null</code> this ThreadState is marked as inactive and should not be used
     * for indexing anymore.
     * @see #isActive()  
     */
    void resetWriter(DocumentsWriterPerThread perThread) {
      assert this.isHeldByCurrentThread();
      if (perThread == null) {
        isActive = false;
      }
      this.perThread = perThread;
      this.perThreadBytes = 0;
      this.flushPending = false;
    }

