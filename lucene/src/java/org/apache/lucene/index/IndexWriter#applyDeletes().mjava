  // Apply buffered deletes to all segments.
  private final synchronized boolean applyDeletes() throws CorruptIndexException, IOException {
    assert testPoint("startApplyDeletes");
    if (infoStream != null) {
      message("applyDeletes");
    }
    flushDeletesCount++;
    boolean success = false;
    boolean changed;
    try {
      changed = docWriter.applyDeletes(segmentInfos);
      success = true;
    } finally {
      if (!success && infoStream != null) {
        message("hit exception flushing deletes");
      }
    }

    if (changed)
      checkpoint();
    return changed;
  }

