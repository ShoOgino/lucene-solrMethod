  public void addField(IndexableField field, FieldInfo fieldInfo) throws IOException {
    if (numStoredFields == storedFields.length) {
      int newSize = ArrayUtil.oversize(numStoredFields + 1, RamUsageEstimator.NUM_BYTES_OBJECT_REF);
      IndexableField[] newArray = new IndexableField[newSize];
      System.arraycopy(storedFields, 0, newArray, 0, numStoredFields);
      storedFields = newArray;
    }

    if (numStoredFields == fieldNumbers.length) {
      fieldNumbers = ArrayUtil.grow(fieldNumbers);
    }

    storedFields[numStoredFields] = field;
    fieldNumbers[numStoredFields] = fieldInfo.number;
    numStoredFields++;

    assert docState.testPoint("StoredFieldsWriterPerThread.processFields.writeField");
  }

