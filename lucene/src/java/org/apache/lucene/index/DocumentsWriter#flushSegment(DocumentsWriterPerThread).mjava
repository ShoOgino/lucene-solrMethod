  private boolean flushSegment(DocumentsWriterPerThread perThread)
      throws IOException {
    if (perThread.getNumDocsInRAM() == 0) {
      return false;
    }

    SegmentInfo newSegment = perThread.flush();
    
    if (newSegment != null) {
      finishFlushedSegment(newSegment, perThread);
      return true;
    }
    return false;
  }

