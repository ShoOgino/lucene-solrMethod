  /**
   * Expert: set the merge policy used by this writer.
   * 
   * @deprecated use {@link IndexWriterConfig#setMergePolicy(MergePolicy)} instead.
   */
  public void setMergePolicy(MergePolicy mp) {
    ensureOpen();
    if (mp == null)
      throw new NullPointerException("MergePolicy must be non-null");

    if (mergePolicy != mp)
      mergePolicy.close();
    mergePolicy = mp;
    mergePolicy.setIndexWriter(this);
    pushMaxBufferedDocs();
    if (infoStream != null)
      message("setMergePolicy " + mp);
    // Required so config.getMergePolicy returns the right value. But this will
    // go away together with the method in 4.0.
    config.setMergePolicy(mp);
  }

