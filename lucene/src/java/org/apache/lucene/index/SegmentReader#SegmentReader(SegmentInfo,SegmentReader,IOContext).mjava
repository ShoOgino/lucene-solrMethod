  // Create new SegmentReader sharing core from a previous
  // SegmentReader and loading new live docs from a new
  // deletes file.  Used by openIfChanged.
  SegmentReader(SegmentInfo si, SegmentReader parent, IOContext context) throws IOException {
    assert si.dir == parent.getSegmentInfo().dir;
    this.si = si;

    // It's no longer possible to unDeleteAll, so, we can
    // only be created if we have deletions:
    assert si.hasDeletions();

    // ... but load our own deleted docs:
    liveDocs = new BitVector(si.dir, si.getDelFileName(), context);
    numDocs = si.docCount - si.getDelCount();
    assert checkLiveCounts(false);

    // We share core w/ parent:
    parent.core.incRef();
    core = parent.core;
  }

