  /** Build compound file for the segment we just flushed */
  void createCompoundFile(String compoundFileName, Collection<String> flushedFiles) throws IOException {
    CompoundFileWriter cfsWriter = new CompoundFileWriter(directory, compoundFileName);
    for(String fileName : flushedFiles) {
      cfsWriter.addFile(fileName);
    }

    // Perform the merge
    cfsWriter.close();
  }

