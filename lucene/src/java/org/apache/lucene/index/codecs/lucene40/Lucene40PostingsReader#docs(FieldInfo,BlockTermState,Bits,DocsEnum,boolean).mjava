  @Override
  public DocsEnum docs(FieldInfo fieldInfo, BlockTermState termState, Bits liveDocs, DocsEnum reuse, boolean needsFreqs) throws IOException {
    SegmentDocsEnum docsEnum;
    if (needsFreqs && fieldInfo.indexOptions == IndexOptions.DOCS_ONLY) {
      return null;
    } else if (reuse == null || !(reuse instanceof SegmentDocsEnum)) {
      docsEnum = new SegmentDocsEnum(freqIn);
    } else {
      docsEnum = (SegmentDocsEnum) reuse;
      if (docsEnum.startFreqIn != freqIn) {
        // If you are using ParellelReader, and pass in a
        // reused DocsEnum, it could have come from another
        // reader also using standard codec
        docsEnum = new SegmentDocsEnum(freqIn);
      }
    }
    // if (DEBUG) System.out.println("SPR.docs ts=" + termState);
    return docsEnum.reset(fieldInfo, (StandardTermState) termState, liveDocs);
  }

