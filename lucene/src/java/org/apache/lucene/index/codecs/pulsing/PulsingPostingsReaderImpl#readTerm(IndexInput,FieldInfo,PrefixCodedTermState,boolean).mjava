  @Override
  public void readTerm(IndexInput termsIn, FieldInfo fieldInfo, PrefixCodedTermState _termState, boolean isIndexTerm) throws IOException {
    PulsingTermState termState = (PulsingTermState) _termState;

    termState.pendingIndexTerm |= isIndexTerm;

    // total TF, but in the omitTFAP case its computed based on docFreq.
    long count = fieldInfo.omitTermFreqAndPositions ? termState.docFreq : termState.totalTermFreq;
    
    if (count <= maxPositions) {

      // Inlined into terms dict -- just read the byte[] blob in,
      // but don't decode it now (we only decode when a DocsEnum
      // or D&PEnum is pulled):
      termState.postingsSize = termsIn.readVInt();
      if (termState.postings == null || termState.postings.length < termState.postingsSize) {
        termState.postings = new byte[ArrayUtil.oversize(termState.postingsSize, 1)];
      }
      termsIn.readBytes(termState.postings, 0, termState.postingsSize);
    } else {
      termState.postingsSize = -1;
      termState.wrappedTermState.docFreq = termState.docFreq;
      wrappedPostingsReader.readTerm(termsIn, fieldInfo, termState.wrappedTermState, termState.pendingIndexTerm);
      termState.pendingIndexTerm = false;
    }
  }

