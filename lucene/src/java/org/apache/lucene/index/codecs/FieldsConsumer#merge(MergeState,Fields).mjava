  public void merge(MergeState mergeState, Fields fields) throws IOException {
    FieldsEnum fieldsEnum = fields.iterator();
    assert fieldsEnum != null;
    String field;
    while((field = fieldsEnum.next()) != null) {
      mergeState.fieldInfo = mergeState.fieldInfos.fieldInfo(field);
      assert mergeState.fieldInfo != null : "FieldInfo for field is null: "+ field;
      TermsEnum terms = fieldsEnum.terms();
      if(terms != null) {
        final TermsConsumer termsConsumer = addField(mergeState.fieldInfo);
        termsConsumer.merge(mergeState, terms);
      }
      if (mergeState.fieldInfo.hasDocValues()) {
        final DocValues docValues = fieldsEnum.docValues();
        // TODO: is this assert values and if so when?
//        assert docValues != null : "DocValues are null for " + mergeState.fieldInfo.getDocValues();
        if(docValues == null) { // for now just continue
          continue; 
        }
        final DocValuesConsumer docValuesConsumer = addValuesField(mergeState.fieldInfo);
        assert docValuesConsumer != null;
        docValuesConsumer.merge(mergeState, docValues);
      }
    }
  }

