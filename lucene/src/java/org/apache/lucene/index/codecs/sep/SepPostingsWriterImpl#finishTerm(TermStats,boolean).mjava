  /** Called when we are done adding docs to this term */
  @Override
  public void finishTerm(TermStats stats, boolean isIndexTerm) throws IOException {

    // TODO: -- wasteful we are counting this in two places?
    assert stats.docFreq > 0;
    assert stats.docFreq == df;

    docIndex.write(termsOut, isIndexTerm);

    if (df >= skipInterval) {
      skipListWriter.writeSkip(skipOut);
    }

    lastDocID = 0;
    df = 0;
  }

