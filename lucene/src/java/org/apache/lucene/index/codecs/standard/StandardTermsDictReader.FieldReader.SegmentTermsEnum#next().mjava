      @Override
      public BytesRef next() throws IOException {

        if (seekPending) {
          seekPending = false;
          in.seek(state.filePointer);
        }
        
        if (state.ord >= numTerms-1) {
          return null;
        }

        bytesReader.read();
        state.docFreq = in.readVInt();

        // TODO: would be cleaner, but space-wasting, to
        // simply record a bit into each index entry as to
        // whether it's an index entry or not, rather than
        // re-compute that information... or, possibly store
        // a "how many terms until next index entry" in each
        // index entry, but that'd require some tricky
        // lookahead work when writing the index
        postingsReader.readTerm(in,
                                fieldInfo, state,
                                indexReader.isIndexTerm(1+state.ord, state.docFreq, false));

        state.ord++;

        return bytesReader.term;
      }

