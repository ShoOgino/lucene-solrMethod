  @Override
  public void files(Directory dir, SegmentInfo info, Set<String> files) throws IOException {
    Iterator<Codec> it = fields.values().iterator();
    Set<Codec> seen = new HashSet<Codec>();
    while(it.hasNext()) {
      final Codec codec = it.next();
      if (!seen.contains(codec)) {
        seen.add(codec);
        codec.files(dir, info, files);
      }
    }
  }

