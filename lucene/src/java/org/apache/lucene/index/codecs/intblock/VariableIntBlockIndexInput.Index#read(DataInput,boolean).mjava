    @Override
    public void read(final DataInput indexIn, final boolean absolute) throws IOException {
      if (absolute) {
        fp = indexIn.readVLong();
        upto = indexIn.readByte()&0xFF;
      } else {
        final long delta = indexIn.readVLong();
        if (delta == 0) {
          // same block
          upto = indexIn.readByte()&0xFF;
        } else {
          // new block
          fp += delta;
          upto = indexIn.readByte()&0xFF;
        }
      }
      // TODO: we can't do this assert because non-causal
      // int encoders can have upto over the buffer size
      //assert upto < maxBlockSize: "upto=" + upto + " max=" + maxBlockSize;
    }

