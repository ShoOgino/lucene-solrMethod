  protected TypePromoter promoteValueType(final FieldInfo fieldInfo, final IndexDocValues docValues,
      TypePromoter currentPromoter) {
    assert currentPromoter != null;
    final TypePromoter incomingPromoter = TypePromoter.create(docValues.type(),  docValues.getValueSize());
    assert incomingPromoter != null;
    final TypePromoter newPromoter = currentPromoter.promote(incomingPromoter);
    return newPromoter == null ? handleIncompatibleValueType(fieldInfo, incomingPromoter, currentPromoter) : newPromoter;    
  }

