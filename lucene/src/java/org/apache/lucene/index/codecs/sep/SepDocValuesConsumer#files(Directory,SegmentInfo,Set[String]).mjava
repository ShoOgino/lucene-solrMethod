  @SuppressWarnings("fallthrough")
  public static void files(Directory dir, SegmentInfo segmentInfo,
      Set<String> files) throws IOException {
    FieldInfos fieldInfos = segmentInfo.getFieldInfos();
    for (FieldInfo fieldInfo : fieldInfos) {
      if (fieldInfo.hasDocValues()) {
        String filename = docValuesId(segmentInfo.name, fieldInfo.number);
        switch (fieldInfo.getDocValues()) {
          case BYTES_FIXED_DEREF:
          case BYTES_VAR_DEREF:
          case BYTES_VAR_STRAIGHT:
          case BYTES_FIXED_SORTED:
          case BYTES_VAR_SORTED:
            files.add(IndexFileNames.segmentFileName(filename, "",
                Writer.INDEX_EXTENSION));
            assert dir.fileExists(IndexFileNames.segmentFileName(filename, "",
                Writer.INDEX_EXTENSION));
            // until here all types use an index
          case BYTES_FIXED_STRAIGHT:
          case FLOAT_32:
          case FLOAT_64:
          case VAR_INTS:
          case FIXED_INTS_16:
          case FIXED_INTS_32:
          case FIXED_INTS_64:
          case FIXED_INTS_8:
            files.add(IndexFileNames.segmentFileName(filename, "",
                Writer.DATA_EXTENSION));
            assert dir.fileExists(IndexFileNames.segmentFileName(filename, "",
                Writer.DATA_EXTENSION));
            break;
          default:
            assert false;
        }
      }
    }
  }

