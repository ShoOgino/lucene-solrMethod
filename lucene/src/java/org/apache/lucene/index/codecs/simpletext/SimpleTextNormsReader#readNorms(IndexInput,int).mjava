  // we read in all the norms up front into a hashmap
  private void readNorms(IndexInput in, int maxDoc) throws IOException {
    BytesRef scratch = new BytesRef();
    boolean success = false;
    try {
      SimpleTextUtil.readLine(in, scratch);
      while (!scratch.equals(END)) {
        assert StringHelper.startsWith(scratch, FIELD);
        String fieldName = readString(FIELD.length, scratch);
        byte bytes[] = new byte[maxDoc];
        for (int i = 0; i < bytes.length; i++) {
          SimpleTextUtil.readLine(in, scratch);
          assert StringHelper.startsWith(scratch, DOC);
          SimpleTextUtil.readLine(in, scratch);
          assert StringHelper.startsWith(scratch, NORM);
          bytes[i] = scratch.bytes[scratch.offset + NORM.length];
        }
        norms.put(fieldName, bytes);
        SimpleTextUtil.readLine(in, scratch);
        assert StringHelper.startsWith(scratch, FIELD) || scratch.equals(END);
      }
      success = true;
    } finally {
      if (success) {
        IOUtils.close(in);
      } else {
        IOUtils.closeWhileHandlingException(in);
      }
    }
  }

