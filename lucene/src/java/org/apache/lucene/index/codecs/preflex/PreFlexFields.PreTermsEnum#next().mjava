    @Override
    public BytesRef next() throws IOException {
      if (DEBUG_SURROGATES) {
        System.out.println("TE.next() skipNext=" + skipNext);
      }
      if (skipNext) {
        skipNext = false;
        if (termEnum.term() == null) {
          return null;
        } else {
          scratchBytesRef.copy(termEnum.term().text());
          return current = scratchBytesRef;
        }
      }
      if (termEnum.next() && termEnum.term().field() == fieldInfo.name) {
        newSuffixStart = termEnum.newSuffixStart;
        if (DEBUG_SURROGATES) {
          System.out.println("  set newSuffixStart=" + newSuffixStart);
        }
        surrogatesDance();
        final Term t = termEnum.term();
        if (t == null || t.field() != fieldInfo.name) {
          assert t == null || !t.field().equals(fieldInfo.name); // make sure fields are in fact interned
          current = null;
        } else {
          scratchBytesRef.copy(t.text());
          current = scratchBytesRef;
        }
        return current;
      } else {
        if (DEBUG_SURROGATES) {
          System.out.println("  force pop");
        }
        // force pop
        newSuffixStart = -1;
        surrogatesDance();
        final Term t = termEnum.term();
        if (t == null || t.field() != fieldInfo.name) {
          assert t == null || !t.field().equals(fieldInfo.name); // make sure fields are in fact interned
          return null;
        } else {
          scratchBytesRef.copy(t.text());
          current = scratchBytesRef;
          return current;
        }
      }
    }

