    @Override
    public boolean checkIndexTerm(BytesRef text, TermStats stats) throws IOException {
      if (policy.isIndexTerm(text, stats) || first) {
        first = false;
        //System.out.println("VGW: index term=" + text.utf8ToString() + " fp=" + termsOut.getFilePointer());
        final int lengthSave = text.length;
        text.length = indexedTermPrefixLength(lastTerm, text);
        try {
          fstBuilder.add(text, fstOutputs.get(termsOut.getFilePointer()));
        } finally {
          text.length = lengthSave;
        }
        lastTerm.copy(text);
        return true;
      } else {
        //System.out.println("VGW: not index term=" + text.utf8ToString() + " fp=" + termsOut.getFilePointer());
        lastTerm.copy(text);
        return false;
      }
    }

