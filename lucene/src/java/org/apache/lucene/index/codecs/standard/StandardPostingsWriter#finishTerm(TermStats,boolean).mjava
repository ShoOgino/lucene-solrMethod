  /** Called when we are done adding docs to this term */
  @Override
  public void finishTerm(TermStats stats, boolean isIndexTerm) throws IOException {
    assert stats.docFreq > 0;

    // TODO: wasteful we are counting this (counting # docs
    // for this term) in two places?
    assert stats.docFreq == df;

    if (isIndexTerm) {
      // Write absolute at seek points
      termsOut.writeVLong(freqStart);
    } else {
      // Write delta between seek points
      termsOut.writeVLong(freqStart - lastFreqStart);
    }

    lastFreqStart = freqStart;

    if (df >= skipInterval) {
      termsOut.writeVInt((int) (skipListWriter.writeSkip(freqOut)-freqStart));
    }
     
    if (!omitTermFreqAndPositions) {
      if (isIndexTerm) {
        // Write absolute at seek points
        termsOut.writeVLong(proxStart);
      } else {
        // Write delta between seek points
        termsOut.writeVLong(proxStart - lastProxStart);
      }
      lastProxStart = proxStart;
    }

    lastDocID = 0;
    df = 0;
  }

