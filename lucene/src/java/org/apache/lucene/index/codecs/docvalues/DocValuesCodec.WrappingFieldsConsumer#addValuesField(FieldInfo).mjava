    @Override
    public synchronized DocValuesConsumer addValuesField(FieldInfo field)
        throws IOException {
      DocValuesConsumer consumer = DocValuesConsumer.create(state.segmentName,
      // TODO: set comparator here
      //TODO can we have a compound file per segment and codec for docvalues?
          state.directory, field, state.codecId +"-"+ field.number, null);
      docValuesConsumers.add(consumer);
      return consumer;
    }

