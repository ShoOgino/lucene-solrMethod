    private void surrogatesDance() throws IOException {
      
      // Tricky: prior to 4.0, Lucene index sorted terms in
      // UTF16 order, but as of 4.0 we sort by Unicode code
      // point order.  These orders differ because of the
      // surrrogates; so we have to fixup our enum, here, by
      // carefully first seeking past the surrogates and
      // then back again at the end.  The process is
      // recursive, since any given term could have multiple
      // new occurrences of surrogate pairs, so we use a
      // stack to record the pending seek-backs.
      if (DEBUG_SURROGATES) {
        System.out.println("  dance start term=" + (termEnum.term() == null ? null : UnicodeUtil.toHexString(termEnum.term().text())));
      }

      while(popPendingSeek());
      while(pushNewSurrogate());
    }

