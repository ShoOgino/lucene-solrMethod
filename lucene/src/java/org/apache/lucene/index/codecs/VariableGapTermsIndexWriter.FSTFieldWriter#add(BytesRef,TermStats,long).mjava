    @Override
    public void add(BytesRef text, TermStats stats, long termsFilePointer) throws IOException {
      final int lengthSave = text.length;
      text.length = indexedTermPrefixLength(lastTerm, text);
      try {
        fstBuilder.add(text, fstOutputs.get(termsFilePointer));
      } finally {
        text.length = lengthSave;
      }
      lastTerm.copy(text);
    }

