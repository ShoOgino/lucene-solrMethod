    @Override
    public BytesRef next() throws IOException {
      assert !ended;

      if (iter.hasNext()) {
        Map.Entry<BytesRef,TermData> ent = iter.next();
        current = ent.getKey();
        TermData td = ent.getValue();
        docFreq = td.docFreq;
        docsStart = td.docsStart;
        return current;
      } else {
        current = null;
        return null;
      }

      /*
      readLine(in, scratch);
      if (scratch.equals(END) || scratch.startsWith(FIELD)) {
        ended = true;
        current = null;
        return null;
      } else {
        assert scratch.startsWith(TERM): "got " + scratch.utf8ToString();
        docsStart = in.getFilePointer();
        final int len = scratch.length - TERM.length;
        if (len > scratch2.length) {
          scratch2.grow(len);
        }
        System.arraycopy(scratch.bytes, TERM.length, scratch2.bytes, 0, len);
        scratch2.length = len;
        current = scratch2;
        docFreq = 0;
        long lineStart = 0;
        while(true) {
          lineStart = in.getFilePointer();
          readLine(in, scratch);
          if (scratch.equals(END) || scratch.startsWith(FIELD) || scratch.startsWith(TERM)) {
            break;
          }
          if (scratch.startsWith(DOC)) {
            docFreq++;
          }
        }
        in.seek(lineStart);
        return current;
      }
      */
    }

