    @Override
    public void write(IndexOutput indexOut, boolean absolute) throws IOException {
      assert upto >= 0;
      if (absolute) {
        indexOut.writeVLong(fp);
        indexOut.writeByte((byte) upto);
      } else if (fp == lastFP) {
        // same block
        indexOut.writeVLong(0);
        assert upto >= lastUpto;
        indexOut.writeByte((byte) upto);
      } else {      
        // new block
        indexOut.writeVLong(fp - lastFP);
        indexOut.writeByte((byte) upto);
      }
      lastUpto = upto;
      lastFP = fp;
    }

