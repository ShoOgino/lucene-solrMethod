  @Override
  public void flushTermsBlock() throws IOException {
    termsOut.writeVInt((int) buffer2.getFilePointer());
    buffer2.writeTo(termsOut);
    buffer2.reset();

    // TODO: can we avoid calling this if all terms
    // were inlined...?  Eg for a "primary key" field, the
    // wrapped codec is never invoked...
    wrappedPostingsWriter.flushTermsBlock();
  }

