  @Override
  public void files(Directory dir, SegmentInfo segmentInfo, Set<String> files)
      throws IOException {
    Set<String> otherFiles = new HashSet<String>();
    other.files(dir, segmentInfo, otherFiles);
    for (String string : otherFiles) {
      if (dir.fileExists(string))
        files.add(string);
    }

    for (String file : dir.listAll()) {
      if (file.startsWith(segmentInfo.name)
          && (file.endsWith(Writer.DATA_EXTENSION) || file
              .endsWith(Writer.INDEX_EXTENSION))) {
        files.add(file);
      }
    }
    // files.add(IndexFileNames.segmentFileName(segmentInfo.name, "",
    // Writer.DATA_EXTENSION));
    // files.add(IndexFileNames.segmentFileName(segmentInfo.name, "",
    // Writer.INDEX_EXTENSION));

  }

