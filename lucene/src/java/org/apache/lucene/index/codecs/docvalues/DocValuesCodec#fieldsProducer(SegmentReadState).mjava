  @Override
  public FieldsProducer fieldsProducer(SegmentReadState state)
      throws IOException {
    Directory dir = state.dir;
    Set<String> files = new HashSet<String>();

    other.files(dir, state.segmentInfo, state.codecId, files);
    for (String string : files) {
      if (dir.fileExists(string))
        return new WrappingFielsdProducer(state, other.fieldsProducer(state));
    }
    return new WrappingFielsdProducer(state, FieldsProducer.EMPTY);

  }

