  /**
   * Creates a new {@link DefaultDocValuesProducer} instance and loads all
   * {@link IndexDocValues} instances for this segment and codec.
   */
  public DefaultDocValuesProducer(SegmentReadState state) throws IOException {
    if (state.fieldInfos.anyDocValuesFields()) {
      cfs = new CompoundFileDirectory(state.dir, 
                                      IndexFileNames.segmentFileName(state.segmentInfo.name,
                                                                     DefaultDocValuesConsumer.DOC_VALUES_SEGMENT_SUFFIX, IndexFileNames.COMPOUND_FILE_EXTENSION), 
                                      state.context, false);
      docValues = load(state.fieldInfos, state.segmentInfo.name, state.segmentInfo.docCount, cfs, state.context);
    } else {
      cfs = null;
      docValues = new TreeMap<String,IndexDocValues>();
    }
  }

