  /** Called when we are done adding docs to this term */
  @Override
  public void finishTerm(int docCount, boolean isIndexTerm) throws IOException {

    // TODO: -- wasteful we are counting this in two places?
    assert docCount > 0;
    assert docCount == df;

    docIndex.write(termsOut, isIndexTerm);

    if (df >= skipInterval) {
      skipListWriter.writeSkip(skipOut);
    }

    lastDocID = 0;
    df = 0;
  }

