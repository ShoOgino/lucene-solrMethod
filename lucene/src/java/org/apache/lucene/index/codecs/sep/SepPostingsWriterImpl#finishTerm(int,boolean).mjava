  /** Called when we are done adding docs to this term */
  @Override
  public void finishTerm(int docCount, boolean isIndexTerm) throws IOException {

    long skipPos = skipOut.getFilePointer();

    // TODO: -- wasteful we are counting this in two places?
    assert docCount > 0;
    assert docCount == df;

    // TODO: -- only do this if once (consolidate the
    // conditional things that are written)
    if (!omitTF) {
      freqIndex.write(termsOut, isIndexTerm);
    }
    docIndex.write(termsOut, isIndexTerm);

    if (df >= skipInterval) {
      skipListWriter.writeSkip(skipOut);
    }

    if (isIndexTerm) {
      termsOut.writeVLong(skipPos);
      lastSkipStart = skipPos;
    } else if (df >= skipInterval) {
      termsOut.writeVLong(skipPos-lastSkipStart);
      lastSkipStart = skipPos;
    }

    if (!omitTF) {
      posIndex.write(termsOut, isIndexTerm);
      if (isIndexTerm) {
        // Write absolute at seek points
        termsOut.writeVLong(payloadStart);
      } else {
        termsOut.writeVLong(payloadStart-lastPayloadStart);
      }
      lastPayloadStart = payloadStart;
    }

    lastDocID = 0;
    df = 0;
  }

