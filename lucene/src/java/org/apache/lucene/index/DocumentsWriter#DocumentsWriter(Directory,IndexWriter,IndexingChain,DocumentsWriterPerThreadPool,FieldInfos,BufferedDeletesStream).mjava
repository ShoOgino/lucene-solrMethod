  DocumentsWriter(Directory directory, IndexWriter writer, IndexingChain chain, DocumentsWriterPerThreadPool indexerThreadPool, FieldInfos fieldInfos, BufferedDeletesStream bufferedDeletesStream) throws IOException {
    this.directory = directory;
    this.indexWriter = writer;
    this.similarityProvider = writer.getConfig().getSimilarityProvider();
    this.bufferedDeletesStream = bufferedDeletesStream;
    this.perThreadPool = indexerThreadPool;
    this.chain = chain;
    this.perThreadPool.initialize(this, fieldInfos);
  }

