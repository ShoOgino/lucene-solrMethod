  /**
   * Returns total size in bytes of all of files used by this segment (if
   * {@code includeDocStores} is true), or the size of all files except the
   * store files otherwise.
   */
  public long sizeInBytes(boolean includeDocStores) throws IOException {
    if (includeDocStores) {
      if (sizeInBytesWithStore != -1) return sizeInBytesWithStore;
      sizeInBytesWithStore = 0;
      for (final String fileName : files()) {
        // We don't count bytes used by a shared doc store against this segment
        if (docStoreOffset == -1 || !IndexFileNames.isDocStoreFile(fileName)) {
          sizeInBytesWithStore += dir.fileLength(fileName);
        }
      }
      return sizeInBytesWithStore;
    } else {
      if (sizeInBytesNoStore != -1) return sizeInBytesNoStore;
      sizeInBytesNoStore = 0;
      for (final String fileName : files()) {
        if (IndexFileNames.isDocStoreFile(fileName)) {
          continue;
        }
        sizeInBytesNoStore += dir.fileLength(fileName);
      }
      return sizeInBytesNoStore;
    }
  }

