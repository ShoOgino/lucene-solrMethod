  @Override
  public DocumentsWriterPerThread.DocWriter finishDocument() throws IOException {
    final DocumentsWriterPerThread.DocWriter oneDoc = one.finishDocument();
    final DocumentsWriterPerThread.DocWriter twoDoc = two.finishDocument();
    if (oneDoc == null)
      return twoDoc;
    else if (twoDoc == null)
      return oneDoc;
    else {
      DocFieldConsumers.PerDoc both = getPerDoc();
      both.docID = docState.docID;
      assert oneDoc.docID == docState.docID;
      assert twoDoc.docID == docState.docID;
      both.writerOne = oneDoc;
      both.writerTwo = twoDoc;
      return both;
    }
  }

