  private boolean doFlush(DocumentsWriterPerThread flushingDWPT) throws IOException {
    boolean maybeMerge = false;
    while (flushingDWPT != null) {
      maybeMerge = true;
      try {
        // flush concurrently without locking
        final FlushedSegment newSegment = flushingDWPT.flush();
        finishFlushedSegment(newSegment);
      } finally {
          flushControl.doAfterFlush(flushingDWPT);
          flushingDWPT.checkAndResetHasAborted();
          indexWriter.flushCount.incrementAndGet();
      }
        flushingDWPT =  flushControl.nextPendingFlush() ;
    }
    return maybeMerge;
  }

