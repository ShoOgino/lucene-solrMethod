  @Override
  public TermEnum terms() throws IOException {
    ensureOpen();
    if (core.isPreFlex) {
      // For old API on an old segment, instead of
      // converting old API -> new API -> old API, just give
      // direct access to old:
      return ((PreFlexFields) core.fields).tis.terms();
    } else {
      // Emulate pre-flex API on top of flex index
      return new LegacyTermEnum(null);
    }
  }

