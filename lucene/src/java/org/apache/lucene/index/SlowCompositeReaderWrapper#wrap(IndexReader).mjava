  /** This method is sugar for getting an {@link AtomicIndexReader} from
   * an {@link IndexReader} of any kind. If the reader is already atomic,
   * it is returned unchanged, otherwise wrapped by this class.
   */
  public static AtomicIndexReader wrap(IndexReader reader) throws IOException {
    if (reader instanceof CompositeIndexReader) {
      return new SlowCompositeReaderWrapper((CompositeIndexReader) reader);
    } else {
      assert reader instanceof AtomicIndexReader;
      return (AtomicIndexReader) reader;
    }
  }

