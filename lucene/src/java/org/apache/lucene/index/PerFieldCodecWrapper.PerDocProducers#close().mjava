    public void close() throws IOException {
      final Iterator<PerDocValues> it = codecs.values().iterator();
      IOException err = null;
      while (it.hasNext()) {
        try {
          PerDocValues next = it.next();
          if (next != null) {
            next.close();
          }
        } catch (Exception ioe) {
          // keep first IOException we hit but keep
          // closing the rest
          if (err == null) {
            err = new IOException(ioe);
          }
        }
      }
      if (err != null) {
        throw err;
      }
    }

