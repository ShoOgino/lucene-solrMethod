    public void close() throws IOException {
      final Collection<PerDocValues> values = codecs.values();
      IOException err = null;
      for (PerDocValues perDocValues : values) {
        try {
          if (perDocValues != null) {
            perDocValues.close();
          }
        } catch (IOException ioe) {
          // keep first IOException we hit but keep
          // closing the rest
          if (err == null) {
            err = ioe;
          }
        }
      }
      if (err != null) {
        throw err;
      }
    }

