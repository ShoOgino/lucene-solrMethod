  @Override
  public DocValues docValues() throws IOException {
    final List<MultiDocValues.DocValuesIndex> values = new ArrayList<MultiDocValues.DocValuesIndex>();
    for (int i = 0; i < numTop; i++) {
      final DocValues docValues = top[i].fields.docValues();
      if (docValues != null) {
        values.add(new MultiDocValues.DocValuesIndex(docValues,
            top[i].index));
      }
    }
    // TODO return an empty docvalues instance if values are empty
    return docValues.reset(values.toArray(MultiDocValues.DocValuesIndex.EMPTY_ARRAY));
  }

