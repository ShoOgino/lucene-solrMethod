    @Override
    public int advance(int target) throws IOException {
      assert target > currentDoc : "target " + target
          + " must be > than the current doc " + currentDoc;
      int relativeDoc = target - currentStart;
      do {
        if (target >= maxDoc) // we are beyond max doc
          return currentDoc = NO_MORE_DOCS;
        if (target >= currentMax) {
          final int idx = ReaderUtil.subIndex(target, starts);
          currentEnum.close();
          currentEnum = docValuesIdx[idx].docValues.getEnum(this.attributes());
          currentStart = docValuesIdx[idx].start;
          currentMax = currentStart + docValuesIdx[idx].length;
          relativeDoc = target - currentStart;
        } else {
          return currentDoc = currentStart + currentEnum.advance(relativeDoc);
        }
      } while ((relativeDoc = currentEnum.advance(relativeDoc)) == NO_MORE_DOCS);
      return currentDoc = currentStart + relativeDoc;
    }

