    @Override
    public int advance(int target) throws IOException {
      if (target >= maxDoc)
        return pos = NO_MORE_DOCS;
      final long val = ints.advance(target);
      ref.ints[0] = val == defaultValue? 0:minValue + val;
      ref.offset = 0; // can we skip this?
      return pos = target;
    }

