    private final int ensureSource(int docID) {
      int n = docID - start;
      if (n >= numDocs) {
        final int idx = ReaderUtil.subIndex(docID, starts);
        assert idx >= 0 && idx < docValuesIdx.length : "idx was " + idx
            + " for doc id: " + docID + " slices : " + Arrays.toString(starts);
        assert docValuesIdx[idx] != null;
        try {
          current = docValuesIdx[idx].docValues.getSource();
          missingValues.copy(current.getMissing());
        } catch (IOException e) {
          throw new RuntimeException("load failed", e); // TODO how should we
          // handle this
        }

        start = docValuesIdx[idx].start;
        numDocs = docValuesIdx[idx].length;
        n = docID - start;
      }
      return n;
    }

