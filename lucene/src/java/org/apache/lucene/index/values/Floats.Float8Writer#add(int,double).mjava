    @Override
    public void add(int docID, double v) throws IOException {
      assert docID > lastDocId : "docID: " + docID
          + " must be greater than the last added doc id: " + lastDocId;
      if (docID >= values.length) {
        final long len = values.length;
        values = ArrayUtil.grow(values, 1 + docID);
        bytesUsed.addAndGet(RamUsageEstimator.NUM_BYTES_LONG
            * ((values.length) - len));
      }
      values[docID] = Double.doubleToLongBits(v);
      lastDocId = docID;
    }

