    protected IntsWriter(Directory dir, String id, String codecName,
        int version, Counter bytesUsed, IOContext context, ValueType valueType) throws IOException {
      super(dir, id, codecName, version, bytesUsed, context);
      final int expectedSize = typeToSize(valueType);
      this.bytesRef = new BytesRef(expectedSize);
      bytesRef.length = expectedSize;
      template = IndexDocValuesArray.TEMPLATES.get(valueType);
    }

