    protected FloatsWriter(Directory dir, String id, int precision,
        AtomicLong bytesUsed) throws IOException {
      super(bytesUsed);
      this.id = id;
      this.precision = (byte) precision;
      datOut = dir.createOutput(IndexFileNames.segmentFileName(id, "",
          Writer.DATA_EXTENSION));
      CodecUtil.writeHeader(datOut, CODEC_NAME, VERSION_CURRENT);
      assert datOut.getFilePointer() == CodecUtil.headerLength(CODEC_NAME);
      datOut.writeByte(this.precision);
    }

