    @Override
    public void add(int docID, BytesRef bytes) throws IOException {
      assert lastDocID < docID;
      assert !merge;
      if (size == -1) {
        if (bytes.length > BYTE_BLOCK_SIZE) {
          throw new IllegalArgumentException("bytes arrays > " + Short.MAX_VALUE + " are not supported");
        }
        size = bytes.length;
        pool.nextBuffer();
      } else if (bytes.length != size) {
        throw new IllegalArgumentException("expected bytes size=" + size
            + " but got " + bytes.length);
      }
      if (lastDocID+1 < docID) {
        advancePool(docID);
      }
      pool.copy(bytes);
      lastDocID = docID;
    }

