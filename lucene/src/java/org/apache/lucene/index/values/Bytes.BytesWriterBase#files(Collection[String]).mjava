    @Override
    public void files(Collection<String> files) throws IOException {
      assert datOut != null;
      files.add(IndexFileNames.segmentFileName(id, "", DATA_EXTENSION));
      if (idxOut != null) { // called after flush - so this must be initialized
        // if needed or present
        final String idxFile = IndexFileNames.segmentFileName(id, "",
            INDEX_EXTENSION);
        files.add(idxFile);
      }
    }

