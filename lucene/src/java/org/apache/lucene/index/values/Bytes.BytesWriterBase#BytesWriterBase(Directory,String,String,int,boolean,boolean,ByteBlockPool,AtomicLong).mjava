    protected BytesWriterBase(Directory dir, String id, String codecName,
        int version, boolean initIndex, boolean initData, ByteBlockPool pool,
        AtomicLong bytesUsed) throws IOException {
      this.dir = dir;
      this.id = id;
      this.codecName = codecName;
      this.version = version;
      this.pool = pool;
      this.bytesUsed = bytesUsed;
      if (initData)
        initDataOut();
      if (initIndex)
        initIndexOut();
    }

