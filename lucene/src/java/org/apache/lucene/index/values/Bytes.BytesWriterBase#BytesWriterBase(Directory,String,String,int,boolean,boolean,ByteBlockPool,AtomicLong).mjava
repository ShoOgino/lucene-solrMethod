    protected BytesWriterBase(Directory dir, String id, String codecName,
        int version, boolean initIndex, boolean initData, ByteBlockPool pool,
        AtomicLong bytesUsed) throws IOException {
      super(bytesUsed);
      this.dir = dir;
      this.id = id;
      this.codecName = codecName;
      this.version = version;
      this.pool = pool;
      if (initData) {
        initDataOut();
      }

      if (initIndex) {
        initIndexOut();
      }
    }

