    /* (non-Javadoc)
     * @see org.apache.lucene.index.values.Writer#merge(org.apache.lucene.index.values.Writer.MergeState)
     */
    @Override
    protected void merge(MergeState state) throws IOException {
      if(state.bits == null && state.reader instanceof Reader){
        Reader reader = (Reader) state.reader;
        final int maxDocs = reader.maxDoc;
        if(maxDocs == 0)
          return;
        if(size == -1) {
          size = reader.size;
          initDataOut();
          datOut.writeInt(size);
          oneRecord = new byte[size];
        }
       fill(state.docBase);
       // TODO should we add a transfer to API to each reader?
       datOut.copyBytes(reader.cloneData(), size * maxDocs);
       lastDocID += maxDocs-1;
      } else
        super.merge(state);
    }

