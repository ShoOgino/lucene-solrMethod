  public static Writer getWriter(Directory dir, String id, int precisionBytes)
      throws IOException {
    if (precisionBytes != 4 && precisionBytes != 8) {
      throw new IllegalArgumentException("precisionBytes must be 4 or 8; got "
          + precisionBytes);
    }
    if (precisionBytes == 4) {
      return new Float4Writer(dir, id);
    } else {
      return new Float8Writer(dir, id);
    }
  }

