    public Writer(Directory dir, String id, Allocator allocator,
        Counter bytesUsed, IOContext context) throws IOException {
      super(dir, id, CODEC_NAME, VERSION_CURRENT, bytesUsed, context);
      hash = new BytesRefHash(new ByteBlockPool(allocator), 16, array);
      docToAddress = new int[1];
      bytesUsed.addAndGet(RamUsageEstimator.NUM_BYTES_INT);
    }

