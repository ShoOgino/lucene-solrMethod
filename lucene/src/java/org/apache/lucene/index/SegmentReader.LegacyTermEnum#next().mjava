    @Override
    public boolean next() throws IOException {

      if (done) {
        return false;
      }

      while(true) {
        if (terms == null) {
          // Advance to the next field
          currentField = fields.next();
          if (currentField == null) {
            done = true;
            return false;
          }
          terms = fields.terms();
        }
        currentTerm = terms.next();
        if (currentTerm != null) {
          // This field still has terms
          return true;
        } else {
          // Done producing terms from this field; advance
          // to next field
          terms = null;
        }
      }
    }

