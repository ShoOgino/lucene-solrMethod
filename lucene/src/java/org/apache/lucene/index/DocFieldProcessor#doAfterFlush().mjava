  /** In flush we reset the fieldHash to not maintain per-field state
   *  across segments */
  @Override
  void doAfterFlush() {
    fieldHash = new DocFieldProcessorPerField[2];
    hashMask = 1;
    totalFieldCount = 0;
    for(PerDocConsumer consumer : perDocConsumers.values()) {
      try {
        consumer.close();  
      } catch (IOException e) {
        // ignore and continue closing remaining consumers
      }
    }
    perDocConsumers.clear();
    docValues.clear();
  }

