  private int mergeNorms(SegmentWriteState segmentWriteState) throws IOException {
    final NormsWriter writer = codec.normsFormat().normsWriter(segmentWriteState);
    
    boolean success = false;
    try {
      int numMerged = writer.merge(mergeState);
      success = true;
      return numMerged;
    } finally {
      if (success) {
        IOUtils.close(writer);
      } else {
        IOUtils.closeWhileHandlingException(writer);
      }
    }
  }

