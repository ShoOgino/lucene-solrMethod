  private void finishFlushedSegment(FlushedSegment newSegment, FrozenBufferedDeletes bufferedDeletes)
      throws IOException {
    // this is eventually finishing the flushed segment and publishing it to the IndexWriter
    if (bufferedDeletes != null && bufferedDeletes.any()) {
      bufferedDeletesStream.push(bufferedDeletes);
      if (infoStream != null) {
        message("flush: push buffered deletes: " + bufferedDeletes);
      }
    }
    publishFlushedSegment(newSegment);

  }

