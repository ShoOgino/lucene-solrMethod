    /**
     * Commit live docs changes for the segment readers for
     * the provided infos.
     *
     * @throws IOException
     */
    public synchronized void commit(SegmentInfos infos) throws IOException {
      for (SegmentInfo info : infos) {
        final ReadersAndLiveDocs rld = readerMap.get(info);
        if (rld != null && rld.writeLiveDocs(directory)) {
          assert infoIsLive(info);
          // Must checkpoint w/ deleter, because we just
          // created created new _X_N.del file.
          deleter.checkpoint(segmentInfos, false);
        }
      }
    }

