    protected void setFailed() {
      assert segment == null;
      failed = true;
    }

