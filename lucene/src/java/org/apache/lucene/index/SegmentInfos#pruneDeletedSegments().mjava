  /** Prunes any segment whose docs are all deleted. */
  public void pruneDeletedSegments() {
    int segIdx = 0;
    while(segIdx < size()) {
      final SegmentInfo info = info(segIdx);
      if (info.getDelCount() == info.docCount) {
        remove(segIdx);
      } else {
        segIdx++;
      }
    }
  }

