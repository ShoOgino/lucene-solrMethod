  private void addField(Document doc, FieldInfo fi, boolean binary, boolean tokenize, int numeric) throws CorruptIndexException, IOException {
    final AbstractField f;

    if (binary) {
      int toRead = fieldsStream.readVInt();
      final byte[] b = new byte[toRead];
      fieldsStream.readBytes(b, 0, b.length);
      f = new Field(fi.name, b);
    } else if (numeric != 0) {
      f = loadNumericField(fi, numeric);
    } else {
      Field.Index index = Field.Index.toIndex(fi.isIndexed, tokenize);
      Field.TermVector termVector = Field.TermVector.toTermVector(fi.storeTermVector, fi.storeOffsetWithTermVector, fi.storePositionWithTermVector);
      f = new Field(fi.name,     // name
        false,
        fieldsStream.readString(), // read value
        Field.Store.YES,
        index,
        termVector);
    }
    
    f.setOmitTermFreqAndPositions(fi.omitTermFreqAndPositions);
    f.setOmitNorms(fi.omitNorms);
    doc.add(f);
  }

