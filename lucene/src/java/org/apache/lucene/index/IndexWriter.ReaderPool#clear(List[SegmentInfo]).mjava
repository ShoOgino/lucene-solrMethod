    /** Forcefully clear changes for the specified segments.  This is called on successful merge. */
    synchronized void clear(List<SegmentInfo> infos) throws IOException {
      if (infos == null) {
        for (Map.Entry<SegmentCacheKey,SegmentReader> ent: readerMap.entrySet()) {
          ent.getValue().hasChanges = false;
        }
      } else {
        for (final SegmentInfo info: infos) {
          final SegmentReader r = readerMap.get(new SegmentCacheKey(info, IOContext.Context.MERGE));
          if (r != null) {
            r.hasChanges = false;
          }
        }
      }
    }

