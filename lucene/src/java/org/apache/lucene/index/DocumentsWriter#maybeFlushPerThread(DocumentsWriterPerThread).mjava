  private final boolean maybeFlushPerThread(DocumentsWriterPerThread perThread) throws IOException {
    if (perThread.getNumDocsInRAM() == maxBufferedDocs) {
      flushSegment(perThread, false);
      assert perThread.getNumDocsInRAM() == 0;
      return true;
    }

    return false;
  }

