  private final boolean maybeFlushPerThread(DocumentsWriterPerThread perThread) throws IOException {
    if (perThread.getNumDocsInRAM() == maxBufferedDocs) {
      flushSegment(perThread);
      assert perThread.getNumDocsInRAM() == 0;
      
      return true;
    }

    return false;
  }

