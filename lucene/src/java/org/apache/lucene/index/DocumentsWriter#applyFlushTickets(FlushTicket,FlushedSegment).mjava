  private void applyFlushTickets(FlushTicket current, FlushedSegment segment) throws IOException {
    synchronized (ticketQueue) {
      if (current != null) {
        // nocommit -- can't caller set current.segment = segment?
        // nocommit -- confused by this comment:
        // This is a segment FlushTicket so assign the flushed segment so we can make progress.
        assert segment != null;
        current.segment = segment;
      }
      while (true) {
        // Keep publishing eligible flushed segments:
        final FlushTicket head = ticketQueue.peek();
        if (head != null && head.canPublish()) {
          ticketQueue.poll();
          finishFlush(head.segment, head.frozenDeletes);
        } else {
          break;
        }
      }
    }
  }

