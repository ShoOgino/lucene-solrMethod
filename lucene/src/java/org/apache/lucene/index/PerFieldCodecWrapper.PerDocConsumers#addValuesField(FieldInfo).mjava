    @Override
    public DocValuesConsumer addValuesField(FieldInfo field) throws IOException {
      assert field.getCodecId() != FieldInfo.UNASSIGNED_CODEC_ID;
      final PerDocConsumer perDoc = consumers.get(field.getCodecId());
      if (perDoc == null) {
        return null;
      }
      return perDoc.addValuesField(field);
    }

