  /** Can only be called once. */
  public void setSegmentCodecs(SegmentCodecs segmentCodecs) {
    assert this.segmentCodecs == null;
    if (segmentCodecs == null) {
      throw new IllegalArgumentException("segmentCodecs must be non-null");
    }
    this.segmentCodecs = segmentCodecs;
  }

