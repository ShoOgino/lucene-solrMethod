  private final void returnDocumentsWriterPerThread(ThreadState state, boolean clearThreadBindings) {
    lock.lock();
    try {
      state.finish();
      if (clearThreadBindings) {
        clearThreadBindings(state);
      }
      state.isIdle = true;
      threadStateAvailable.signalAll();
    } finally {
      lock.unlock();
    }
  }

