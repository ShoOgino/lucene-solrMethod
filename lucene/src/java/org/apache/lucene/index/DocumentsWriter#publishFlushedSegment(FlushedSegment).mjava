  private void publishFlushedSegment(FlushedSegment newSegment)
      throws IOException {
    if (newSegment != null) {
      final SegmentInfo segInfo = indexWriter.prepareFlushedSegment(newSegment);
      final BufferedDeletes deletes = newSegment.segmentDeletes;
      FrozenBufferedDeletes packet = null;
      if (deletes != null && deletes.any()) {
        // segment private delete
        packet = new FrozenBufferedDeletes(deletes, true);
        if (infoStream != null) {
          message("flush: push buffered seg private deletes: " + packet);
        }
      }
      indexWriter.publishFlushedSegment(segInfo, packet);
    }
  }

