  // Moves all pending deletes onto the provided segment,
  // then clears the pending deletes
  public synchronized void pushDeletes(SegmentDeletes newDeletes, SegmentInfo info, boolean noLimit) {
    assert newDeletes.any();
    numTerms.addAndGet(newDeletes.numTermDeletes.get());

    if (!noLimit) {
      assert !deletesMap.containsKey(info);
      assert info != null;
      deletesMap.put(info, newDeletes);
      bytesUsed.addAndGet(newDeletes.bytesUsed.get());
    } else {
      final SegmentDeletes deletes = getDeletes(info);
      bytesUsed.addAndGet(-deletes.bytesUsed.get());
      deletes.update(newDeletes, noLimit);
      bytesUsed.addAndGet(deletes.bytesUsed.get());
    }    
    if (infoStream != null) {
      message("push deletes seg=" + info + " dels=" + getDeletes(info));
    }
    assert checkDeleteStats();    
  }

