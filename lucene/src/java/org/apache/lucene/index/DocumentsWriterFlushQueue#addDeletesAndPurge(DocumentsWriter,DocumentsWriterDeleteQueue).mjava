  synchronized void addDeletesAndPurge(DocumentsWriter writer,
      DocumentsWriterDeleteQueue deleteQueue) throws IOException {
   incTickets();// first inc the ticket count - freeze opens
                // a window for #anyChanges to fail
    boolean success = false;
    try {
      queue.add(new GlobalDeletesTicket(deleteQueue.freezeGlobalBuffer(null)));
      success = true;
    } finally {
      if (!success) {
       decTickets();
      }
    }
    forcePurge(writer);
  }

