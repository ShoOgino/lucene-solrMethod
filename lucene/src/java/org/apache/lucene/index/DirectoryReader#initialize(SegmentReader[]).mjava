  private void initialize(SegmentReader[] subReaders) throws IOException {
    this.subReaders = subReaders;
    starts = new int[subReaders.length + 1];    // build starts array

    final List<Fields> subFields = new ArrayList<Fields>();
    final List<ReaderUtil.Slice> fieldSlices = new ArrayList<ReaderUtil.Slice>();

    for (int i = 0; i < subReaders.length; i++) {
      starts[i] = maxDoc;
      maxDoc += subReaders[i].maxDoc();      // compute maxDocs

      if (subReaders[i].hasDeletions()) {
        hasDeletions = true;
      }

      final ReaderUtil.Slice slice = new ReaderUtil.Slice(starts[i], subReaders[i].maxDoc(), i);
      subReaderToSlice.put(subReaders[i], slice);

      final Fields f = subReaders[i].fields();
      if (f != null) {
        subFields.add(f);
        fieldSlices.add(slice);
      }
    }
    starts[subReaders.length] = maxDoc;

    if (!readOnly) {
      maxIndexVersion = SegmentInfos.readCurrentVersion(directory, codecs);
    }
  }

