  public DocumentsWriter(Directory directory, IndexWriter indexWriter, IndexWriterConfig config) {
    this.directory = directory;
    this.indexWriter = indexWriter;
    this.config = config;
    this.maxBufferedDocs = config.getMaxBufferedDocs();
    this.threadPool = config.getIndexerThreadPool();
    this.infoStream = indexWriter.getInfoStream();
  }

