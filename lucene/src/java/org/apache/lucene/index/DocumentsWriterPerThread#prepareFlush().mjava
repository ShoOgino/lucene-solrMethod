  FrozenBufferedDeletes prepareFlush() {
    assert numDocsInRAM > 0;
    final FrozenBufferedDeletes globalDeletes = deleteQueue.freezeGlobalBuffer(deleteSlice);
    // apply all deletes before we flush and release the delete slice
    deleteSlice.apply(pendingDeletes, numDocsInRAM);
    deleteSlice = null;
    return globalDeletes;
  }

