  private boolean checkLiveCounts(boolean isNRT) throws IOException {
    if (liveDocs != null) {
      if (liveDocs.size() != si.docCount) {
        throw new CorruptIndexException("document count mismatch: deleted docs count " + liveDocs.size() + " vs segment doc count " + si.docCount + " segment=" + si.name);
      }

      final int recomputedCount = liveDocs.getRecomputedCount();
      // Verify BitVector is self consistent:
      assert liveDocs.count() == recomputedCount : "live count=" + liveDocs.count() + " vs recomputed count=" + recomputedCount;

      // Verify our docCount matches:
      assert numDocs == recomputedCount :
      "delete count mismatch: numDocs=" + numDocs + " vs BitVector=" + (si.docCount-recomputedCount);

      assert isNRT || si.docCount - si.getDelCount() == recomputedCount :
        "si.docCount=" + si.docCount + "si.getDelCount()=" + si.getDelCount() + " recomputedCount=" + recomputedCount;
    }
  
    return true;
  }

