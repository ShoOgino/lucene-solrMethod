  /**
   * Obtain the number of deleted docs for a pooled reader.
   * If the reader isn't being pooled, the segmentInfo's 
   * delCount is returned.
   */
  public int numDeletedDocs(SegmentInfo info) throws IOException {
    ensureOpen(false);
    SegmentReader reader = readerPool.getIfExists(info);
    try {
      if (reader != null) {
        // the pulled reader could be from an in-flight merge 
        // while the info we see has already new applied deletes after a commit
        // we max out the delets since deletes never shrink
        return Math.max(info.getDelCount(), reader.numDeletedDocs());
      } else {
        return info.getDelCount();
      }
    } finally {
      if (reader != null) {
        readerPool.release(reader, false);
      }
    }
  }

