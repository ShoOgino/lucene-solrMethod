  /**
   * Persists all snapshots information. If the given id and segment are not
   * null, it persists their information as well.
   */
  private void persistSnapshotInfos(String id, String segment) throws IOException {
    writer.deleteAll();
    Document d = new Document();
    FieldType ft = new FieldType();
    ft.setStored(true);
    d.add(new Field(SNAPSHOTS_ID, ft, ""));
    for (Entry<String, String> e : super.getSnapshots().entrySet()) {
      d.add(new Field(e.getKey(), ft, e.getValue()));
    }
    if (id != null) {
      d.add(new Field(id, ft, segment));
    }
    writer.addDocument(d);
    writer.commit();
  }

