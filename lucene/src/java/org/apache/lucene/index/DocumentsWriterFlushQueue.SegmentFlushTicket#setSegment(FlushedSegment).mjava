    protected void setSegment(FlushedSegment segment) {
      assert !failed;
      this.segment = segment;
    }

