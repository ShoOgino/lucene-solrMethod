  private void applyFlushTickets() throws IOException {
    synchronized (ticketQueue) {
      while (true) {
        // Keep publishing eligible flushed segments:
        final FlushTicket head = ticketQueue.peek();
        if (head != null && head.canPublish()) {
          ticketQueue.poll();
          finishFlush(head.segment, head.frozenDeletes);
        } else {
          break;
        }
      }
    }
  }

