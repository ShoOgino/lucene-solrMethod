  private void applyFlushTickets() throws IOException {
    synchronized (ticketQueue) {
      while (true) {
        // Keep publishing eligible flushed segments:
        final FlushTicket head = ticketQueue.peek();
        if (head != null && head.canPublish()) {
          try {
            finishFlush(head.segment, head.frozenDeletes);
          } finally {
            ticketQueue.poll();
          }
        } else {
          break;
        }
      }
    }
  }

