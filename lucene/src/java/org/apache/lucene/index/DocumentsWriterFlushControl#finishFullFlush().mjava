  synchronized void finishFullFlush() {
    assert fullFlush;
    assert flushQueue.isEmpty();
    try {
      if (!blockedFlushes.isEmpty()) {
        assert assertBlockedFlushes(documentsWriter.deleteQueue);
        flushQueue.addAll(blockedFlushes);
        blockedFlushes.clear();
      }
    } finally {
      fullFlush = false;
    }
  }

