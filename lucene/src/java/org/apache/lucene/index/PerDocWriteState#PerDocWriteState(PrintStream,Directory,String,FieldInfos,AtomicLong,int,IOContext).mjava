  PerDocWriteState(PrintStream infoStream, Directory directory,
      String segmentName, FieldInfos fieldInfos, AtomicLong bytesUsed,
      int codecId, IOContext context) {
    this.infoStream = infoStream;
    this.directory = directory;
    this.segmentName = segmentName;
    this.fieldInfos = fieldInfos;
    this.segmentCodecs = fieldInfos.buildSegmentCodecs(false);
    this.codecId = codecId;
    this.bytesUsed = bytesUsed;
    this.context = context;
  }

