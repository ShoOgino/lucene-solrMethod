  @Override
  public void close() throws IOException {
    if (writer != null) {
      boolean success = false;
      try {
        writer.finish();
        success = true;
      } finally {
        if (success) {
          IOUtils.close(writer);
        } else {
          IOUtils.closeWhileHandlingException(writer);
        }
      }
    }
  }

