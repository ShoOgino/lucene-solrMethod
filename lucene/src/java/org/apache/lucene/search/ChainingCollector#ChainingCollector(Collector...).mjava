  public ChainingCollector(Collector... collectors) {
    // For the user's convenience, we allow null collectors to be passed.
    // However, to improve performance, these null collectors are found
    // and dropped from the array we save for actual collection time.
    int n = 0;
    for (Collector c : collectors) {
      if (c != null) {
        n++;
      }
    }

    if (n == 0) {
      throw new IllegalArgumentException("At least 1 collector must not be null");
    } else if (n == collectors.length) {
      // No null collectors, can use the given list as is.
      this.collectors = collectors;
    } else {
      this.collectors = new Collector[n];
      n = 0;
      for (Collector c : collectors) {
        if (c != null) {
          this.collectors[n++] = c;
        }
      }
    }
  }

