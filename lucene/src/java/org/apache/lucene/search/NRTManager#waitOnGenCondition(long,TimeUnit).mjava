  private boolean waitOnGenCondition(long time, TimeUnit unit)
      throws InterruptedException {
    assert reopenLock.isHeldByCurrentThread();
    if (time < 0) {
      newGeneration.await();
      return true;
    } else {
      return newGeneration.await(time, unit);
    }
  }

