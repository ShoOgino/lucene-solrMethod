  @Override
  public BytesRef next() throws IOException {
    if (queuedBottom != null) {
      bottomChanged(bottom, queuedBottom);
      queuedBottom = null;
    }
    
    BytesRef term = actualEnum.next();
    boostAtt.setBoost(actualBoostAtt.getBoost());
    
    final float bottom = boostAtt.getMaxNonCompetitiveBoost();
    if (bottom != this.bottom && term != null) {
      this.bottom = bottom;
      // clone the term before potentially doing something with it
      // this is a rare but wonderful occurrence anyway
      queuedBottom = new BytesRef(term);
    }
    
    return term;
  }

