    private int calculateMaxDistance(int m) {
      return (int) ((1-minSimilarity) * (Math.min(text.length, m) + realPrefixLength));
    }

