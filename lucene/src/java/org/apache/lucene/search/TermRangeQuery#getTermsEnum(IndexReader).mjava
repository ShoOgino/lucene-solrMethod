  @Override
  protected TermsEnum getTermsEnum(IndexReader reader) throws IOException {
    if (collator == null && lowerTerm != null && upperTerm != null && lowerTerm.compareTo(upperTerm) > 0) {
      return TermsEnum.EMPTY;
    }
    if ((lowerTerm == null || (collator == null && includeLower && "".equals(lowerTerm))) && upperTerm == null) {
      // NOTE: for now, MultiTermQuery enums terms at the
      // MultiReader level, so we must use MultiFields here:
      final Terms terms = MultiFields.getTerms(reader, field);
      return (terms != null) ? terms.iterator() : null;
    }
    return new TermRangeTermsEnum(reader, field,
        lowerTerm, upperTerm, includeLower, includeUpper, collator);
  }

