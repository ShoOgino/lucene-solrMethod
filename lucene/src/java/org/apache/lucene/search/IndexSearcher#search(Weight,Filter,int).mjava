  // inherit javadoc
  @Override
  public TopDocs search(Weight weight, Filter filter, int nDocs) throws IOException {

    if (nDocs <= 0) {
      throw new IllegalArgumentException("nDocs must be > 0");
    }

    nDocs = Math.min(nDocs, reader.maxDoc());

    TopScoreDocCollector collector = TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());
    search(weight, filter, collector);
    return collector.topDocs();
  }

