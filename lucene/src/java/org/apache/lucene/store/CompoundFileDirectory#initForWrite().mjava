  protected final void initForWrite() throws IOException {
    assert !(directory instanceof CompoundFileDirectory) : "compound file inside of compound file: " + fileName;
    this.entries = SENTINEL;
    this.openForWrite = true;
    this.isOpen = true;
    writer = new CompoundFileWriter(directory, fileName);
  }

