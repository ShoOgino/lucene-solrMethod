    @Override
    public void copyBytes(DataInput input, long numBytes) throws IOException {
      // Optimized copy only if the number of bytes to copy is larger than the
      // buffer size, and the given IndexInput supports FileChannel copying ..
      // NOTE: the below check relies on NIOIndexInput extending Simple. If that
      // changes in the future, we should change the check as well.
      if (numBytes > BUFFER_SIZE && input instanceof SimpleFSIndexInput) {
        // flush any bytes in the buffer
        flush();
        // do the optimized copy
        FileChannel in = ((SimpleFSIndexInput) input).file.getChannel();
        FileChannel out = file.getChannel();
        copy(in, out, numBytes);
        // corrects the position in super (BufferedIndexOutput), so that calls
        // to getFilePointer will return the correct pointer.
        // Perhaps a specific method is better?
        super.seek(out.position());
      } else {
        super.copyBytes(input, numBytes);
      }
    }

