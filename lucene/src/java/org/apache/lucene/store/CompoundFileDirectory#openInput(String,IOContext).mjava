  @Override
  public synchronized IndexInput openInput(String fileName, IOContext context) throws IOException {
    ensureOpen();
    assert !openForWrite;
    final String id = IndexFileNames.stripSegmentName(fileName);
    final FileEntry entry = entries.get(id);
    if (entry == null) {
      throw new IOException("No sub-file with id " + id + " found (fileName=" + fileName + " files: " + entries.keySet() + ")");
    }
    return openInputSlice(id, entry.offset, entry.length, readBufferSize);
  }

