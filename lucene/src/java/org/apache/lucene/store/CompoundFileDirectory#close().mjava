  @Override
  public synchronized void close() throws IOException {
    ensureOpen();
    entries = null;
    isOpen = false;
    if (writer != null) {
      assert openForWrite;
      writer.close();
    }
  }

