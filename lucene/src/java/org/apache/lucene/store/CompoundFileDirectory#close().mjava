  @Override
  public synchronized void close() throws IOException {
    if (!isOpen) {
      // allow double close - usually to be consistent with other closeables
      assert entries == null; 
      return; // already closed
     }
    entries = null;
    isOpen = false;
    if (writer != null) {
      assert openForWrite;
      writer.close();
    }
  }

