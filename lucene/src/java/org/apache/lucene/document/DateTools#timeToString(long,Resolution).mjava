  /**
   * Converts a millisecond time to a string suitable for indexing.
   * 
   * @param time the date expressed as milliseconds since January 1, 1970, 00:00:00 GMT
   * @param resolution the desired resolution, see
   *  {@link #round(long, DateTools.Resolution)}
   * @return a string in format <code>yyyyMMddHHmmssSSS</code> or shorter,
   *  depending on <code>resolution</code>; using GMT as timezone
   */
  public static String timeToString(long time, Resolution resolution) {
    final DateFormats formats = FORMATS.get();
    
    formats.calInstance.setTimeInMillis(round(time, resolution));
    final Date date = formats.calInstance.getTime();
    
    switch (resolution) {
      case YEAR: return formats.YEAR_FORMAT.format(date);
      case MONTH:return formats.MONTH_FORMAT.format(date);
      case DAY: return formats.DAY_FORMAT.format(date);
      case HOUR: return formats.HOUR_FORMAT.format(date);
      case MINUTE: return formats.MINUTE_FORMAT.format(date);
      case SECOND: return formats.SECOND_FORMAT.format(date);
      case MILLISECOND: return formats.MILLISECOND_FORMAT.format(date);
    }
    
    throw new IllegalArgumentException("unknown resolution " + resolution);
  }

