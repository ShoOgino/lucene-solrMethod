      @Override
      public void close() throws IOException {
        Iterator<FieldsConsumer> it = codecs.values().iterator();
        IOException err = null;
        while(it.hasNext()) {
          try {
            it.next().close();
          } catch (IOException ioe) {
            // keep first IOException we hit but keep
            // closing the rest
            if (err == null) {
              err = ioe;
            }
          }
        }
        if (err != null) {
          throw err;
        }
      }

