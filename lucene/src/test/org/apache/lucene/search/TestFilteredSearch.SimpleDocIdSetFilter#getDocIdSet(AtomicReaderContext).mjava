    @Override
    public DocIdSet getDocIdSet(AtomicReaderContext context) {
      assert context.isAtomic;
      final OpenBitSet set = new OpenBitSet();
      int docBase = context.docBase;
      final int limit = docBase+context.reader.maxDoc();
      for (;index < docs.length; index++) {
        final int docId = docs[index];
        if(docId > limit)
          break;
        if (docId >= docBase) {
          set.set(docId-docBase);
        }
      }
      return set.isEmpty()?null:set;
    }

