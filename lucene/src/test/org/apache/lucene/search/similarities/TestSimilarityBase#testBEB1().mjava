  /** Correctness test for the BEB1 DFR model. */
  public void testBEB1() throws IOException {
    SimilarityBase sim = new DFRSimilarity(
        new BasicModelBE(), new AfterEffectB(), new NormalizationH1());
    float tfn = FREQ * AVG_FIELD_LENGTH / DOC_LEN;  // 8.75
    float b = (TOTAL_TERM_FREQ + 1 + 1) / ((DOC_FREQ + 1) * (tfn + 1));  // 0.67132866
    double f = TOTAL_TERM_FREQ + 1 + tfn;
    double n = f + NUMBER_OF_DOCUMENTS;
    double n1 = n + f - 1;        // 258.5
    double m1 = n + f - tfn - 2;  // 248.75
    double n2 = f;                                      // 79.75
    double m2 = f - tfn;                                // 71.0
    float be = (float)(-SimilarityBase.log2(n - 1) -
               SimilarityBase.log2(Math.E) +                   // -8.924494472554715
               ((m1 + 0.5f) * SimilarityBase.log2(n1 / m1) +
                (n1 - m1) * SimilarityBase.log2(n1)) -         // 91.9620374903885
               ((m2 + 0.5f) * SimilarityBase.log2(n2 / m2) +
                (n2 - m2) * SimilarityBase.log2(n2)));         // 67.26544321004599
               // 15.7720995
    float gold = b * be;                                       // 10.588263
    correctnessTestCore(sim, gold);
  }

