  private void checkMaxClauseLimitation(MultiTermQuery.RewriteMethod method) throws Exception {
    // default gets restored automatically by LuceneTestCase:
    BooleanQuery.setMaxClauseCount(3);
    
    final MultiTermQuery mtq = new TermRangeQuery("data", "2", "7", true, true);
    mtq.setRewriteMethod(method);
    try {
      multiSearcherDupls.rewrite(mtq);
      fail("Should throw BooleanQuery.TooManyClauses");
    } catch (BooleanQuery.TooManyClauses e) {
      //  Maybe remove this assert in later versions, when internal API changes:
      assertEquals("Should throw BooleanQuery.TooManyClauses with a stacktrace containing checkMaxClauseCount()",
        "checkMaxClauseCount", e.getStackTrace()[0].getMethodName());
    }
  }

