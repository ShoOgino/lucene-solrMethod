  static void assertReaderClosed(IndexReader reader, boolean checkSubReaders, boolean checkNormsClosed) {
    assertEquals(0, reader.getRefCount());
    
    if (checkNormsClosed && reader instanceof AtomicIndexReader) {
      // TODO: should we really assert something here? we check for open files and this is obselete...
      // assertTrue(((SegmentReader) reader).normsClosed());
    }
    
    if (checkSubReaders && reader instanceof CompositeIndexReader) {
      IndexReader[] subReaders = ((CompositeIndexReader) reader).getSequentialSubReaders();
      for (int i = 0; i < subReaders.length; i++) {
        assertReaderClosed(subReaders[i], checkSubReaders, checkNormsClosed);
      }
    }
  }

