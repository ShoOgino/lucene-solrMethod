  /*
    Run above stress test against RAMDirectory and then
    FSDirectory.
  */
  public void testThreadedOptimize() throws Exception {
    Directory directory = new MockRAMDirectory();
    runTest(directory, new SerialMergeScheduler());
    runTest(directory, new ConcurrentMergeScheduler());
    directory.close();

    File dirName = new File(TEMP_DIR, "luceneTestThreadedOptimize");
    directory = FSDirectory.open(dirName);
    runTest(directory, new SerialMergeScheduler());
    runTest(directory, new ConcurrentMergeScheduler());
    directory.close();
    _TestUtil.rmDir(dirName);
  }

