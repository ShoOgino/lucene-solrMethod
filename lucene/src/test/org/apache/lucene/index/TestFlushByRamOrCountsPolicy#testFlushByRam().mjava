  public void testFlushByRam() throws CorruptIndexException,
      LockObtainFailedException, IOException, InterruptedException {
    int[] numThreads = new int[] { numCPUs + random.nextInt(numCPUs + 1), 1 };
    for (int i = 0; i < numThreads.length; i++) {
      runFlushByRam(numThreads[i],
          1 + random.nextInt(10) + random.nextDouble(), false);
    }

    for (int i = 0; i < numThreads.length; i++) {
      // with a 250 mb ram buffer we should never stall
      runFlushByRam(numThreads[i], 250.d, true);
    }
  }

