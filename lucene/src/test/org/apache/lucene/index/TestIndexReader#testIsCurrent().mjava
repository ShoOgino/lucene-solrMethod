    public void testIsCurrent() throws Exception {
      MockRAMDirectory d = new MockRAMDirectory();
      IndexWriter writer = new IndexWriter(d, newIndexWriterConfig(random, 
        TEST_VERSION_CURRENT, new MockAnalyzer()));
      addDocumentWithFields(writer);
      writer.close();
      // set up reader:
      IndexReader reader = IndexReader.open(d, false);
      assertTrue(reader.isCurrent());
      // modify index by adding another document:
      writer = new IndexWriter(d, newIndexWriterConfig(random, TEST_VERSION_CURRENT,
          new MockAnalyzer()).setOpenMode(OpenMode.APPEND));
      addDocumentWithFields(writer);
      writer.close();
      assertFalse(reader.isCurrent());
      // re-create index:
      writer = new IndexWriter(d, newIndexWriterConfig(random, TEST_VERSION_CURRENT,
          new MockAnalyzer()).setOpenMode(OpenMode.CREATE));
      addDocumentWithFields(writer);
      writer.close();
      assertFalse(reader.isCurrent());
      reader.close();
      d.close();
    }

