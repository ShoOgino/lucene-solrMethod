  public void testIsCurrent() throws IOException {
    Random random = newRandom();
    MockRAMDirectory ramDir1=new MockRAMDirectory();
    addDoc(random, ramDir1, "test foo", true);
    MockRAMDirectory ramDir2=new MockRAMDirectory();
    addDoc(random, ramDir2, "test blah", true);
    IndexReader[] readers = new IndexReader[]{IndexReader.open(ramDir1, false), IndexReader.open(ramDir2, false)};
    MultiReader mr = new MultiReader(readers);
    assertTrue(mr.isCurrent());   // just opened, must be current
    addDoc(random, ramDir1, "more text", false);
    assertFalse(mr.isCurrent());   // has been modified, not current anymore
    addDoc(random, ramDir2, "even more text", false);
    assertFalse(mr.isCurrent());   // has been modified even more, not current anymore
    try {
      mr.getVersion();
      fail();
    } catch (UnsupportedOperationException e) {
      // expected exception
    }
    mr.close();
  }

