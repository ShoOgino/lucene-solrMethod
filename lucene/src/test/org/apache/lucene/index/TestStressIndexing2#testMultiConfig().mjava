  public void testMultiConfig() throws Throwable {
    // test lots of smaller different params together

    r = newRandom();

    for (int i=0; i<3*_TestUtil.getRandomMultiplier(); i++) {  // increase iterations for better testing
      sameFieldOrder=r.nextBoolean();
      mergeFactor=r.nextInt(3)+2;
      maxBufferedDocs=r.nextInt(3)+2;
      int maxThreadStates = 1+r.nextInt(10);
      boolean doReaderPooling = r.nextBoolean();
      seed++;

      int nThreads=r.nextInt(5)+1;
      int iter=r.nextInt(5)+1;
      int range=r.nextInt(20)+1;
      Directory dir1 = new MockRAMDirectory();
      Directory dir2 = new MockRAMDirectory();
      Map<String,Document> docs = indexRandom(nThreads, iter, range, dir1, maxThreadStates, doReaderPooling);
      //System.out.println("TEST: index serial");
      indexSerial(docs, dir2);
      //System.out.println("TEST: verify");
      verifyEquals(dir1, dir2, "id");
    }
  }

