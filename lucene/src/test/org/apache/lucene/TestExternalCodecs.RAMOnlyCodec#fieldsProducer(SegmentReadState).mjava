    @Override
    public FieldsProducer fieldsProducer(SegmentReadState readState)
      throws IOException {
    
      synchronized(state) {
        return state.get(readState.segmentInfo.name);
      }
    }

