  public static CodecProvider alwaysCodec(final Codec c) {
    return new CodecProvider() {
      @Override
      public Codec getWriter(SegmentWriteState state) {
        return c;
      }

      @Override
      public Codec lookup(String name) {
        // can't do this until we fix PreFlexRW to not
        //impersonate PreFlex:
        if (name.equals(c.name)) {
          return c;
        } else {
          return CodecProvider.getDefault().lookup(name);
        }
      }
    };
  }

