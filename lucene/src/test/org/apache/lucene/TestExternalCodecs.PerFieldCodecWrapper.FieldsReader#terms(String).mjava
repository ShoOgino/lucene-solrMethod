      @Override
      public Terms terms(String field) throws IOException {
        Codec codec = getCodec(field);

        FieldsProducer fields = codecs.get(codec);
        assert fields != null;
        return fields.terms(field);
      }

