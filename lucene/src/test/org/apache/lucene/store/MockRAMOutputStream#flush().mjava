  @Override
  public void flush() throws IOException {
    dir.maybeThrowDeterministicException();
    super.flush();
  }

