  @Override
  public void close() throws IOException {
    dir.maybeThrowDeterministicException();
    delegate.close();
    // Now compute actual disk usage & track the maxUsedSize
    // in the MockDirectoryWrapper:
    long size = dir.getRecomputedActualSizeInBytes();
    if (size > dir.maxUsedSize) {
      dir.maxUsedSize = size;
    }
  }

