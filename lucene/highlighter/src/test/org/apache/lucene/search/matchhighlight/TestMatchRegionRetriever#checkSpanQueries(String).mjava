  private void checkSpanQueries(String field) throws IOException {
    withReader(
        List.of(
            Map.of(field, values("foo bar baz")),
            Map.of(field, values("bar foo baz")),
            Map.of(field, values("bar baz foo")),
            Map.of(field, values("bar bar bar irrelevant"))),
        reader -> {
          assertThat(
              highlights(
                  reader,
                  SpanNearQuery.newOrderedNearQuery(field)
                      .addClause(new SpanTermQuery(new Term(field, "bar")))
                      .addClause(new SpanTermQuery(new Term(field, "foo")))
                      .build()),
              containsInAnyOrder(fmt("1: (%s: '>bar foo< baz')", field)));

          assertThat(
              highlights(
                  reader,
                  SpanNearQuery.newOrderedNearQuery(field)
                      .addClause(new SpanTermQuery(new Term(field, "bar")))
                      .addGap(1)
                      .addClause(new SpanTermQuery(new Term(field, "foo")))
                      .build()),
              containsInAnyOrder(fmt("2: (%s: '>bar baz foo<')", field)));

          assertThat(
              highlights(
                  reader,
                  SpanNearQuery.newUnorderedNearQuery(field)
                      .addClause(new SpanTermQuery(new Term(field, "foo")))
                      .addClause(new SpanTermQuery(new Term(field, "bar")))
                      .build()),
              containsInAnyOrder(
                  fmt("0: (%s: '>foo bar< baz')", field), fmt("1: (%s: '>bar foo< baz')", field)));

          assertThat(
              highlights(
                  reader,
                  SpanNearQuery.newUnorderedNearQuery(field)
                      .addClause(new SpanTermQuery(new Term(field, "foo")))
                      .addClause(new SpanTermQuery(new Term(field, "bar")))
                      .setSlop(1)
                      .build()),
              containsInAnyOrder(
                  fmt("0: (%s: '>foo bar< baz')", field),
                  fmt("1: (%s: '>bar foo< baz')", field),
                  fmt("2: (%s: '>bar baz foo<')", field)));
        });
  }

