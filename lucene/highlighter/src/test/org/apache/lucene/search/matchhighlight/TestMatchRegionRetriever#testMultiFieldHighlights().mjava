  @Test
  public void testMultiFieldHighlights() throws IOException {
    for (String[] fields :
        new String[][]{
            {FLD_TEXT_POS_OFFS1, FLD_TEXT_POS_OFFS2},
            {FLD_TEXT_POS, FLD_TEXT_POS_OFFS2},
            {FLD_TEXT_POS_OFFS1, FLD_TEXT_POS}
        }) {
      String field1 = fields[0];
      String field2 = fields[1];
      withReader(
          List.of(
              Map.of(
                  field1, values("foo bar", "baz abc"),
                  field2, values("foo baz", "loo bar"))),
          reader -> {
            String ordered =
                Stream.of(fmt("(%s: '>baz< abc')", field1), fmt("(%s: 'loo >bar<')", field2))
                    .sorted()
                    .collect(Collectors.joining(""));

            assertThat(
                highlights(
                    reader,
                    stdQueryParser.apply(field1 + ":baz" + " OR " + field2 + ":bar", field1)),
                containsInAnyOrder(fmt("0: %s", ordered)));
          });
    }
  }

