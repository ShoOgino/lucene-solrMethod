    /** note: The caller must remember to close the TokenStream eventually. */
    static TokenStream wrap(String fieldName, Analyzer indexAnalyzer, String content, char splitChar)
            throws IOException {
        if (indexAnalyzer.getOffsetGap(fieldName) != 1) { // note: 1 is the default. It is RARELY changed.
            throw new IllegalArgumentException(
                    "offset gap of the provided analyzer should be 1 (field " + fieldName + ")");
        }
        // If there is no splitChar in content then we needn't wrap:
        int splitCharIdx = content.indexOf(splitChar);
        if (splitCharIdx == -1) {
            return indexAnalyzer.tokenStream(fieldName, content);
        }

        TokenStream subTokenStream = indexAnalyzer.tokenStream(fieldName, content.substring(0, splitCharIdx));

        return new MultiValueTokenStream(subTokenStream, fieldName, indexAnalyzer, content, splitChar, splitCharIdx);
    }

