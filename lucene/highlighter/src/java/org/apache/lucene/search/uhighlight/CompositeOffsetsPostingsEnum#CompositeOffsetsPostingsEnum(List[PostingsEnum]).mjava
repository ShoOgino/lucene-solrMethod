  /** The provided {@link PostingsEnum}s must all be positioned to the same document, and must have offsets. */
  CompositeOffsetsPostingsEnum(List<PostingsEnum> postingsEnums) throws IOException {
    queue = new PriorityQueue<BoundsCheckingPostingsEnum>(postingsEnums.size()) {
      @Override
      protected boolean lessThan(BoundsCheckingPostingsEnum a, BoundsCheckingPostingsEnum b) {
        try {
          return a.postingsEnum.startOffset() < b.postingsEnum.startOffset();
        } catch (IOException e) {
          throw new RuntimeException(e);
        }
      }
    };

    int freqAdd = 0;
    for (PostingsEnum postingsEnum : postingsEnums) {
      queue.add(new BoundsCheckingPostingsEnum(postingsEnum));
      freqAdd += postingsEnum.freq();
    }
    freq = freqAdd;
    this.docId = queue.top().postingsEnum.docID();
  }

