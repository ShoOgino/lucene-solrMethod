  static Function<BinaryDocValues> numericAsBinaryDocValues(String field, LegacyNumericType numTyp) {
    return (ctx) -> {
      final NumericDocValues numeric = DocValues.getNumeric(ctx, field);
      final BytesRefBuilder bytes = new BytesRefBuilder();
      
      final LongConsumer coder = coder(bytes, numTyp, field);
      
      return new BinaryDocValues() {
        @Override
        public BytesRef get(int docID) {
          final long lVal = numeric.get(docID);
          coder.accept(lVal);
          return bytes.get();
        }
      };
    };
  }

