  static LongConsumer coder(BytesRefBuilder bytes, LegacyNumericType type, String fieldName){
    switch(type){
      case INT: 
        return (l) -> LegacyNumericUtils.intToPrefixCoded((int) l, 0, bytes);
      case LONG: 
        return (l) -> LegacyNumericUtils.longToPrefixCoded(l, 0, bytes);
      default:
        throw new IllegalArgumentException("Unsupported "+type+
            ". Only "+ LegacyNumericType.INT+" and "+ LegacyNumericType.LONG+" are supported."
            + "Field "+fieldName );
    }
  }

